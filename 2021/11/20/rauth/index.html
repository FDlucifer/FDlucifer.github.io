<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"}}</script><script src="/js/config.js"></script>

    <meta name="description" content="step1You should always check the file type first with a tool like Detect it Easy. Also, make sure to run these in a sandboxed environment. In this case it was a Linux executable ‚Äî an ELF file. By givi">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack-The-Box-reversing-challenge[rauth]">
<meta property="og:url" content="https://fdlucifer.github.io/2021/11/20/rauth/index.html">
<meta property="og:site_name" content="lUc1f3r11&#39;s blog">
<meta property="og:description" content="step1You should always check the file type first with a tool like Detect it Easy. Also, make sure to run these in a sandboxed environment. In this case it was a Linux executable ‚Äî an ELF file. By givi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth1.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth2.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth3.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth4.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth5.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth6.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth7.png">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth8.png">
<meta property="article:published_time" content="2021-11-20T11:52:49.000Z">
<meta property="article:modified_time" content="2023-02-07T05:32:25.179Z">
<meta property="article:author" content="lUc1f3r11">
<meta property="article:tag" content="reversing">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth.png">


<link rel="canonical" href="https://fdlucifer.github.io/2021/11/20/rauth/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2021/11/20/rauth/","path":"2021/11/20/rauth/","title":"Hack-The-Box-reversing-challenge[rauth]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hack-The-Box-reversing-challenge[rauth] | lUc1f3r11's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">lUc1f3r11's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by lUc1f3r11</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">42</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">32</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">202</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
  </ul>
</nav>




</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#step1"><span class="nav-number">1.</span> <span class="nav-text">step1</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Initial-debugging"><span class="nav-number">2.</span> <span class="nav-text">Initial debugging</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Challenge-complete"><span class="nav-number">3.</span> <span class="nav-text">Challenge complete?</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Cryptography-101"><span class="nav-number">4.</span> <span class="nav-text">Cryptography 101</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Single-Challenge-Multiple-Problems"><span class="nav-number">5.</span> <span class="nav-text">Single Challenge Multiple Problems</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Finishing-up"><span class="nav-number">6.</span> <span class="nav-text">Finishing up</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Sources"><span class="nav-number">7.</span> <span class="nav-text">Sources</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="lUc1f3r11"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">lUc1f3r11</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">202</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">32</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub ‚Üí https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail ‚Üí mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter ‚Üí https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page ‚Üí https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vY2hhbm5lbC9VQ19saVRlaDRSMUZNYnBWeGxwTWUtdnc=" title="YouTube ‚Üí https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UC_liTeh4R1FMbpVxlpMe-vw"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram ‚Üí https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange ‚Üí https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="custom mastodon fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">ËÆ∞ÂøÜÈáåÁöÑÁ∫ØÁúü</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">Â∞èÁ¶ª</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2021/11/20/rauth/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="lUc1f3r11">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="lUc1f3r11's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hack-The-Box-reversing-challenge[rauth] | lUc1f3r11's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hack-The-Box-reversing-challenge[rauth]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-11-20 19:52:49" itemprop="dateCreated datePublished" datetime="2021-11-20T19:52:49+08:00">2021-11-20</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2023-02-07 13:32:25" itemprop="dateModified" datetime="2023-02-07T13:32:25+08:00">2023-02-07</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/%E9%80%86%E5%90%91/" itemprop="url" rel="index"><span itemprop="name">ÈÄÜÂêë</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h1 id="step1"><a href="#step1" class="headerlink" title="step1"></a>step1</h1><p>You should always check the file type first with a tool like <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2hvcnNpY3EvRGV0ZWN0LUl0LUVhc3k=">Detect it Easy<i class="fa fa-external-link-alt"></i></span>. Also, make sure to run these in a sandboxed environment. In this case it was a Linux executable ‚Äî an ELF file. By giving it the correct permissions, you can run it.</p>
<p>Although, on the surface, it looks like a regular password bypass challenge, this one has a few tricks up its sleeve.</p>
<span id="more"></span>

<h1 id="Initial-debugging"><a href="#Initial-debugging" class="headerlink" title="Initial debugging"></a>Initial debugging</h1><p>My tool of choice for this challenge was <span class="exturl" data-url="aHR0cHM6Ly9oZXgtcmF5cy5jb20vaWRhLWZyZWUv">IDA Free<i class="fa fa-external-link-alt"></i></span>, but you can use something like <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL05hdGlvbmFsU2VjdXJpdHlBZ2VuY3kvZ2hpZHJh">Ghidra<i class="fa fa-external-link-alt"></i></span> or <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JhZGFyZW9yZy9yYWRhcmUy">Radare2<i class="fa fa-external-link-alt"></i></span>. Take note that, in IDA, if you wish to debug an interactive program and need input&#x2F;output, you should open it in a terminal with this command:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> | ./ida64</span><br></pre></td></tr></table></figure>

<p>After importing the file, we can dive into the decompiled code. We need to find the ‚Äúmain‚Äù function, and try and make sense of the program structure from there.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth.png"></li>
</ul>
<p>The first time we run, we can already start annotating (as seen in purple), what each function does.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth1.png"></li>
</ul>
<h1 id="Challenge-complete"><a href="#Challenge-complete" class="headerlink" title="Challenge complete?"></a>Challenge complete?</h1><p>After debugging for a few minutes, we come to the conclusion that there are two jumps ‚Äî jump if zero, to be more precise ‚Äî that keep us from bypassing the verification. We‚Äôll invert those assembly instructions to JNZ ‚Äî jump if not zero.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth2.png"></li>
</ul>
<p>And‚Ä¶ voil√°. Challenge complete‚Ä¶ Or so it would seem.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth3.png"></li>
</ul>
<p>As expected, there‚Äôs a twist. This is a mock development environment. If we want to have any chance at getting the flag, we‚Äôll have to get it from the production environment ‚Äî the server that was mentioned at the start.</p>
<p>This means we need to find out the actual password, not just bypass it. So let‚Äôs go back and retrace our steps.</p>
<h1 id="Cryptography-101"><a href="#Cryptography-101" class="headerlink" title="Cryptography 101"></a>Cryptography 101</h1><p>But how far do we need to go back? We need to find out where and how the password we enter is verified.<br>Shortly after we enter our password, we can find this function:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth4.png"></li>
</ul>
<p>Notice how it says ‚ÄúSalsa20‚Äù. I‚Äôve heard this term before to describe a cryptographic algorithm.</p>
<p>If we check Wikipedia, or some other similar source, we can verify Salsa20 is a variation of the Salsa stream cipher algorithm with 20 rounds.</p>
<p>In Wikipedia‚Äôs Salsa article, you can find the following table:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth5.png"></li>
</ul>
<p>This essentially means that, before the Salsa algorithm can be applied to encrypt a piece of data, it needs to create a matrix with the following information. So, ideally we should be able to find and easily identify each individual piece in memory. Let‚Äôs take a look at our registers:</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth6.png"></li>
</ul>
<p>There it is! The Salsa20 function we paused the debugging at, was actually responsible for generating this matrix. All that was left to do was to find the right register containing the information, in this case it was the RSP register.</p>
<p>So from: expaef39f4f20e76e33bnd 3d4c270a32-byd25f4db338e81b10te k</p>
<p>We can extract the following components:</p>
<ul>
<li><p>Key: ef39f4f20e76e33bd25f4db338e81b10</p>
</li>
<li><p>Nonce: d4c270a3</p>
</li>
</ul>
<p>So now, we have all we need to decrypt the password data, except for the encrypted password data itself. Bummer. Here‚Äôs where the next challenge lies.</p>
<h1 id="Single-Challenge-Multiple-Problems"><a href="#Single-Challenge-Multiple-Problems" class="headerlink" title="Single Challenge Multiple Problems"></a>Single Challenge Multiple Problems</h1><p>As the program has the Salsa matrix fully built, we can deduce that it will soon enough execute its algorithm over the password we entered and compare its encrypted data to the actual encrypted passsword itself. So let‚Äôs explore the decompiled code a little more.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth7.png"></li>
</ul>
<p>Alright, somewhere along the next few lines, we see some pointer arithmetic and, afterwards, two comparisons. One of these, should compare both encrypted keys and validate our authentication.</p>
<p>If we run the next few lines and pay attention to the general registers, nothing will show up. The tip is the ‚Äúxmm‚Äù keyword that keeps popping up.</p>
<p>These XMM registers are actually specific registers for Streaming SIMD Extensions, or SSE, for short. An Intel designed set of additional CPU instructions that rely on specific registers ‚Äî XMM 0 through 15. These are used in order to achieve Instruction Level Parallelism, by executing some operation over a vector of values.</p>
<p>If we take a look a few lines back, we can actually detect a few xmm constants.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/rauth8.png"></li>
</ul>
<p>The ones we need to pay attention to are the first two.</p>
<ul>
<li>55EF11039CC0: 0F331CBA656F5D958D5A829A3B15F0505h</li>
<li>55EF11039CD0: 0F91BAD626FB63EE372EC9DC9312A4324h</li>
</ul>
<p>We can remove the ‚Äúh‚Äù at the end, which only tells us the value is in hexadecimal, meaning each byte is represented by two letters&#x2F;numbers. So let‚Äôs separate the value by bytes as well. While we‚Äôre at it, we‚Äôll also remove the initial 0 that isn‚Äôt doing anything there.</p>
<ul>
<li>55EF11039CC0: F3 31 CB A6 56 F5 D9 58 D5 A8 29 A3 B1 5F 05 05</li>
<li>55EF11039CD0: F9 1B AD 62 6F B6 3E E3 72 EC 9D C9 31 2A 43 24</li>
</ul>
<p>The problem now is that IDA was representing the value in big-endian (most significant bytes at the end), while x86 memory is in little-endian (most significant bytes at the start). This means that we need to invert the bytes, but not the string itself, as the byte pairs are self-contained.</p>
<p>What we‚Äôre left with is this:</p>
<ul>
<li>55EF11039CC0: 05 05 5F B1 A3 29 A8 D5 58 D9 F5 56 A6 CB 31 F3</li>
<li>55EF11039CD0: 24 43 2A 31 C9 9D EC 72 E3 3E B6 6F 62 AD 1B F9</li>
</ul>
<p>Since the data is still encoded and encrypted, we need to create a small program to decode and then decrypt it and verify if we‚Äôve found the encrypted password. I chose to write a small program in Python using <span class="exturl" data-url="aHR0cHM6Ly93d3cuc3B5ZGVyLWlkZS5vcmcv">Spyder<i class="fa fa-external-link-alt"></i></span>, but you can use whatever you feel most comfortable with.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">from Cryptodome.Cipher import Salsa20</span><br><span class="line">import codecs</span><br><span class="line"></span><br><span class="line">def UnHex(s):</span><br><span class="line">    <span class="built_in">return</span> codecs.decode(s.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>), <span class="string">&#x27;hex_codec&#x27;</span>)</span><br><span class="line"></span><br><span class="line">secret = b<span class="string">&quot;ef39f4f20e76e33bd25f4db338e81b10&quot;</span></span><br><span class="line">nonce = b<span class="string">&quot;d4c270a3&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># decrypt</span></span><br><span class="line">ciphertext = UnHex(<span class="string">&quot;05 05 5F B1 A3 29 A8 D5 58 D9 F5 56 A6 CB 31 F3&quot;</span> + <span class="string">&quot;24 43 2A 31 C9 9D EC 72 E3 3E B6 6F 62 AD 1B F9&quot;</span>)</span><br><span class="line"></span><br><span class="line">cipher = Salsa20.new(key=secret, nonce=nonce)</span><br><span class="line"><span class="built_in">print</span>(cipher.decrypt(ciphertext))</span><br></pre></td></tr></table></figure>

<p>From this, we get the following password:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/hackthebox/challenge/reversing/RAuth]</span><br><span class="line">‚îî‚îÄ<span class="comment"># python3 de.py </span></span><br><span class="line">b<span class="string">&#x27;TheCrucialRustEngineering@2021;)&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Finishing-up"><a href="#Finishing-up" class="headerlink" title="Finishing up"></a>Finishing up</h1><p>Now that we have the password, we only need to insert it in the production environment. So we launch the server and connect to it with an interactive TCP connection from the terminal.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/hackthebox/challenge/reversing/RAuth]</span><br><span class="line">‚îî‚îÄ<span class="comment"># ./rauth </span></span><br><span class="line">Welcome to secure login portal!</span><br><span class="line">Enter the password to access the system: </span><br><span class="line">TheCrucialRustEngineering@2021;)</span><br><span class="line">Successfully Authenticated</span><br><span class="line">Flag: <span class="string">&quot;HTB&#123;F4k3_f74g_4_t3s7ing&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">‚îå‚îÄ‚îÄ(rootüíÄkali)-[~/hackthebox/challenge/reversing/RAuth]</span><br><span class="line">‚îî‚îÄ<span class="comment"># nc 167.172.58.213 30700</span></span><br><span class="line">Welcome to secure login portal!</span><br><span class="line">Enter the password to access the system: </span><br><span class="line">TheCrucialRustEngineering@2021;)</span><br><span class="line">Successfully Authenticated</span><br><span class="line">Flag: <span class="string">&quot;HTB&#123;I_Kn0w_h0w_t0_5al54&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p>And voil√°!</p>
<h1 id="Sources"><a href="#Sources" class="headerlink" title="Sources"></a>Sources</h1><p>Endianness ‚Äî <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvRW5kaWFubmVzcw==">https://en.wikipedia.org/wiki/Endianness<i class="fa fa-external-link-alt"></i></span><br>Salsa20 ‚Äî <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU2Fsc2EyMA==">https://en.wikipedia.org/wiki/Salsa20<i class="fa fa-external-link-alt"></i></span><br>SSE ‚Äî <span class="exturl" data-url="aHR0cHM6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvU3RyZWFtaW5nX1NJTURfRXh0ZW5zaW9ucw==">https://en.wikipedia.org/wiki/Streaming_SIMD_Extensions<i class="fa fa-external-link-alt"></i></span></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="lUc1f3r11 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="lUc1f3r11 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>lUc1f3r11
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2021/11/20/rauth/" title="Hack-The-Box-reversing-challenge[rauth]">https://fdlucifer.github.io/2021/11/20/rauth/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="custom mastodon"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/reversing/" rel="tag"><i class="fa fa-tag"></i> reversing</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/11/14/shibboleth/" rel="prev" title="Hack-The-Box-walkthrough[shibboleth]">
                  <i class="fa fa-chevron-left"></i> Hack-The-Box-walkthrough[shibboleth]
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/11/22/backdoor/" rel="next" title="Hack-The-Box-walkthrough[backdoor]">
                  Hack-The-Box-walkthrough[backdoor] <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 ‚Äì 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">lUc1f3r11</span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  



  <script src="/js/third-party/pace.js"></script>

  





</body>
</html>
